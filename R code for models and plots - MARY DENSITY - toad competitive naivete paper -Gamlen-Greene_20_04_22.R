################## R code for by Roseanna Gamlen-Greene 16 07 2021
#roseanna.gamlen.greene@gmail.com

"REMEMBER TO DELETE RMBIGOUTS - OULIERS BEFORE PUBLISHING ON GITHUB"

#for UNPUBLISHED paper by Gamlen-Greene and Richardson (CURRENTLY UNDER REVIEW IN ECOLOGY): "Co-occurrence history matters: island toads are competitively na?ve to introduced frogs despite mainland co-existence"


#R version 4.0.2 (2020-06-22) -- "Taking Off Again"
#Copyright (C) 2020 The R Foundation for Statistical Computing
#Platform: x86_64-w64-mingw32/x64 (64-bit)

setwd("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22")

rm(list=ls())




######################
######### PACKAGES #########
#######################

library(ggplot2)
library(ggthemes)
library(reshape2)
library(gridExtra)
library(plyr)
library(dplyr)
library(visreg) #
library(lme4) #
library(nlme)
library(MuMIn)#
library(lmerTest) #
library(sjPlot)#
library(sjmisc)#
library(effects)#
library(car)#
library(optimx)#
library(arules)#
library(rstanarm)#
library(tidyr)
library(dataRetrieval)#
library(cowplot)#
library(boot)
library(rstanarm)
library(utf8)
library(emmeans)#
library(naniar) #
library(phia) #
library(multcomp) #
library(data.table)
library(tidyverse)
library(RCurl) #
library(afex)#
library(tibble)
library(ggstatsplot) #
library(metafor) #
library(svglite)
library(outliers) #"REMEMBER TO DELETE"
library(performance) # colinearity
library(ggpubr)





rm(list=ls())

#################################
######## IMPORT DATA #################
#########################################

## 720 all outliers - no data removed
Rawdata_experimentAugust2018_720<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Rcode_plots_RGG_experiment_MS_sept8th2020/Rawdata_02_03_20.csv",header=T,row.names=NULL,sep=",")
dim(Rawdata_experimentAugust2018_720) #720


###################################
## add a couple of columns #####
####################################

## turn ave weight to mg
Rawdata_experimentAugust2018_720$Av_juv_biomass_mg<-Rawdata_experimentAugust2018_720$Av_juv_biomass*1000


## days amphibians have been tadpoles (from breeidng day to metamorphosis) (days)
Rawdata_experimentAugust2018_720$Larvalperiodsincebreed<-Rawdata_experimentAugust2018_720$Daysbeforestartedexpmt+Rawdata_experimentAugust2018_720$Days



#### percetnage tadpole additions due to diving beetle predation
# in mortality dataset so not adding agian here
#Rawdata_experimentAugust2018_720$toadTadpoles_added_as_top.up_june7thand8th_percentagetotal<-(Rawdata_experimentAugust2018_720$Tadpoles_added_as_top.up_june7thand8th/Rawdata_experimentAugust2018_720$Total_number_individuals_start)*100

#### percapita tadpole additions due to diving beetle predation
Rawdata_experimentAugust2018_720$toadTadpoles_added_as_top.up_june7thand8th_percapita<-(Rawdata_experimentAugust2018_720$Tadpoles_added_as_top.up_june7thand8th/Rawdata_experimentAugust2018_720$Total_number_individuals_start)



#### tadpole additions due to diving beetle predation (same as Tadpoles_added_as_top.up_june7thand8th - just dif name)
Rawdata_experimentAugust2018_720$toadTadpoles_added_as_top.up_june7thand8th<-Rawdata_experimentAugust2018_720$toadTadpoles_added_as_top.up_june7thand8th_percapita*Rawdata_experimentAugust2018_720$Total_number_individuals_start

#### Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th
Rawdata_experimentAugust2018_720$Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th<-Rawdata_experimentAugust2018_720$toadTadpoles_added_as_top.up_june7thand8th+Rawdata_experimentAugust2018_720$Total_number_individuals_start


# Count_juv_emerged_percapita
Rawdata_experimentAugust2018_720$Count_juv_emerged_percapita<-Rawdata_experimentAugust2018_720$Count_juv_emerged/Rawdata_experimentAugust2018_720$Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th



#order levels of factor
Rawdata_experimentAugust2018_720$Competition_level<- factor(Rawdata_experimentAugust2018_720$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
Rawdata_experimentAugust2018_720<- droplevels(Rawdata_experimentAugust2018_720)


#order levels of factor
Rawdata_experimentAugust2018_720$Treatment_three <- factor(Rawdata_experimentAugust2018_720$Treatment_three, levels = c("Low_control","Frog","High_control"))
Rawdata_experimentAugust2018_720<- droplevels(Rawdata_experimentAugust2018_720)


### order treatments
Rawdata_experimentAugust2018_720$Treatment_nameC<- factor(Rawdata_experimentAugust2018_720$Treatment_nameC, levels = c("HGT","HGF_HGT","MLF_HGT","HGT_Highcontrol","MLT","HGF_MLT","MLF_MLT","MLT_Highcontrol"))
Rawdata_experimentAugust2018_720<- droplevels(Rawdata_experimentAugust2018_720)



######## add mortality #################

#### NB mortality calcs are in point 4. below #####

##############
Mortalitydataset_26_06_2021<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/Mortalitydataset_26_06_2021.csv",header=T,row.names=NULL,sep=",")

Rawdata_experimentAugust2018_720<-left_join(Mortalitydataset_26_06_2021,Rawdata_experimentAugust2018_720,by="Tank")




###### add density minus mortality column #######

Rawdata_experimentAugust2018_720$Density_minus_mortality<-
  Rawdata_experimentAugust2018_720$Total_number_individuals_start - 
  Rawdata_experimentAugust2018_720$Mortality_06_05_20

Rawdata_experimentAugust2018_720$Density_minus_mortality_percapita<-
  Rawdata_experimentAugust2018_720$Density_minus_mortality/
  Rawdata_experimentAugust2018_720$Total_number_individuals_start

# ------------------------

Rawdata_experimentAugust2018_720$Density_tadsadded_minus_mortality<-
  (Rawdata_experimentAugust2018_720$Total_number_individuals_start +
     Rawdata_experimentAugust2018_720$Tadpoles_added_as_top.up_june7thand8th) - 
  
  Rawdata_experimentAugust2018_720$Mortality_tadsadded_26_06_21

## ---------------


Rawdata_experimentAugust2018_720$Density_tadsadded_minus_mortality_percapita<-
  Rawdata_experimentAugust2018_720$Density_tadsadded_minus_mortality / 
  (Rawdata_experimentAugust2018_720$Total_number_individuals_start+
     Rawdata_experimentAugust2018_720$Tadpoles_added_as_top.up_june7thand8th)



##### add treatment column thats frogs ml, frogs hg, no frogs ###

Rawdata_experimentAugust2018_720$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720$Competition_level== "Low_control"] <- "No_frogs"

Rawdata_experimentAugust2018_720$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720$Competition_level== "High_control"] <- "No_frogs"

Rawdata_experimentAugust2018_720$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720$Competition_level== "FrogML"] <- "FrogML"

Rawdata_experimentAugust2018_720$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720$Competition_level== "FrogHG"] <- "FrogHG"



## make sure all random effects are factors
#days as factor


levels(Rawdata_experimentAugust2018_720$Daysfactor)

levels(Rawdata_experimentAugust2018_720$Population)


Rawdata_experimentAugust2018_720$Tank_factor<-as.factor((Rawdata_experimentAugust2018_720$Tank))

levels(Rawdata_experimentAugust2018_720$Tank_factor)


Rawdata_experimentAugust2018_720$Block_factor<-as.factor((Rawdata_experimentAugust2018_720$Block))

Rawdata_experimentAugust2018_720$Region_factor<-as.factor((Rawdata_experimentAugust2018_720$Region))

levels(Rawdata_experimentAugust2018_720$Region_factor)


Rawdata_experimentAugust2018_720$Population_factor<-as.factor((Rawdata_experimentAugust2018_720$Population))

levels(Rawdata_experimentAugust2018_720$Population_factor)




#############################
#### outliers #########
############


####### reanme dataset ####
Rawdata_experimentAugust2018<-Rawdata_experimentAugust2018_720


## take out 2 small outliers
#### dataset I used
Rawdata_experimentAugust2018<-Rawdata_experimentAugust2018[!(Rawdata_experimentAugust2018$Av_juv_biomass <= 0.009 & !is.na(Rawdata_experimentAugust2018$Av_juv_biomass)),]
dim(Rawdata_experimentAugust2018) #

## 718 too small removed
#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/RawdataexperimentAugust_2018_toosmallremoved.csv",header=T,row.names=NULL,sep=",")
#dim(Rawdata_experimentAugust2018) #718






#Create a boxplot that labels the outliers  
ggbetweenstats(Rawdata_experimentAugust2018_720,
               Treatment_nameC, Av_juv_biomass, outlier.tagging = TRUE)




outlier(Rawdata_experimentAugust2018$Av_juv_biomass)

boxplot(Rawdata_experimentAugust2018$Av_juv_biomass)

#Create a boxplot that labels the outliers  
ggbetweenstats(Rawdata_experimentAugust2018,
               Treatment_nameC, Av_juv_biomass, outlier.tagging = TRUE)


Q <- quantile(Rawdata_experimentAugust2018$Av_juv_biomass, probs=c(.25, .75), na.rm = TRUE)

iqr <- IQR(Rawdata_experimentAugust2018$Av_juv_biomass,na.rm = TRUE)
up <-  Q[2]+1.5*iqr # Upper Range  
low<- Q[1]-1.5*iqr # Lower Range

eliminated_Av_juv_biomass<- subset(Rawdata_experimentAugust2018, Rawdata_experimentAugust2018$Av_juv_biomass > (Q[1] - 1.5*iqr) & Rawdata_experimentAugust2018$Av_juv_biomass < (Q[2]+1.5*iqr))

dim(eliminated_Av_juv_biomass) #425  55


ggbetweenstats(eliminated_Av_juv_biomass,Treatment_nameC, Av_juv_biomass, outlier.tagging = TRUE)









###################
###### exploratory plots ####
############################
labels <- c(ML = "Mainland toads", HG = "Haida Gwaii toads")
Rawdata_experimentAugust2018$Region = factor(Rawdata_experimentAugust2018$Region, levels=c('ML','HG'))

#Tadpoles_added_as_top.up_june7thand8th
### per comp x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Tadpoles_added_as_top.up_june7thand8th_compxregion_21_01_22.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Tadpoles_added_as_top.up_june7thand8th_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Tadpoles_added_as_top.up_june7thand8th)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Tadpoles added at two weeks (per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Tadpoles_added_as_top.up_june7thand8th_compxregion_21_01_22.svg",width = 200, height = 150, units = 'mm')
(boxplot_Tadpoles_added_as_top.up_june7thand8th_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Tadpoles_added_as_top.up_june7thand8th)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Tadpoles added at two weeks (per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

#Tadpoles_added_as_top.up_june7thand8th four treatments
### per comp x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Tadpoles_added_as_top.up_june7thand8th_comp4xregion_21_01_22.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Tadpoles_added_as_top.up_june7thand8th_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Tadpoles_added_as_top.up_june7thand8th)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Tadpoles added at two weeks")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Tadpoles_added_as_top.up_june7thand8th_comp4xregion_21_01_22.svg",width = 200, height = 150, units = 'mm')
(boxplot_Tadpoles_added_as_top.up_june7thand8th_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Tadpoles_added_as_top.up_june7thand8th)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Tadpoles added at two weeks")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


#Tadpoles_added_as_top.up_june7thand8th four treatments
### per comp x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_comp4xregion_21_01_22.png",width = 200, height = 150, units = 'mm',res=600)
(boxplot_Tadpoles_added_as_top.up_june7thand8th_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=toadTadpoles_added_as_top.up_june7thand8th_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad tadpoles added at two weeks (per capita)")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_comp4xregion_21_01_22.svg",width = 200, height = 150, units = 'mm')
(boxplot_Tadpoles_added_as_top.up_june7thand8th_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=toadTadpoles_added_as_top.up_june7thand8th_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad tadpoles added at two weeks (per capita)")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



#Mortality_06_05_20_percapita
### per comp x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Mortality_06_05_20_percapita_compxregion_21_01_22.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Mortality_06_05_20_percapita_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Mortality_06_05_20_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Mortality per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Mortality_06_05_20_percapita_compxregion_21_01_22.svg",width = 200, height = 150, units = 'mm')
(boxplot_Mortality_06_05_20_percapita_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Mortality_06_05_20_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Mortality per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



#Mortality_06_05_20_percapita FOUR TRETAMENTS
### per comp x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Mortality_06_05_20_percapita_comp4xregion_21_01_22.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Mortality_06_05_20_percapita_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #        "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Mortality per capita")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Mortality_06_05_20_percapita_com4pxregion_21_01_22.svg",width = 200, height = 150, units = 'mm')
(boxplot_Mortality_06_05_20_percapita_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Mortality per capita")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




#Mortality_06_05_20_percapita FOUR TRETAMENTS
### per comp x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Mortality_tadsadded_26_06_21_percapita_comp4xregion_21_01_22.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Mortality_tadsadded_26_06_21_percapita_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #        "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Mortality_tadsadded_26_06_21_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Mortality per capita")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Mortality_tadsadded_26_06_21_percapita_com4pxregion_21_01_22.svg",width = 200, height = 150, units = 'mm')
(boxplot_Mortality_tadsadded_26_06_21_percapita_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #        "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Mortality_tadsadded_26_06_21_percapita)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Mortality per capita")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




### Tadpoles_added_as_top.up_june7thand8th vs mortality










### Larvalperiodsincebreed
hist(Rawdata_experimentAugust2018_720$Larvalperiodsincebreed)

### plot per population


### per pop Daysbeforestartedexpmt
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Daysbeforestartedexpmt_pops_21_01_22_perpopulation.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Daysbeforestartedexpmt_pops_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #                                     "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Population, y=Daysbeforestartedexpmt)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    #facet_wrap(~Region)+
    labs(x="Population")+
    labs(y="Larval period before experiment started (days)")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Daysbeforestartedexpmt_pops_21_01_22_perpopulation.svg",width = 200, height = 150, units = 'mm')
(boxplot_Daysbeforestartedexpmt_pops_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #                                     "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Population, y=Daysbeforestartedexpmt)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    #facet_wrap(~Region)+
    labs(x="Population")+
    labs(y="Larval period before experiment started (days)")+
    #scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



### per comp x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Larvalperiodsincebreed_compxregion_21_01_22.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Larvalperiodsincebreed_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Larvalperiodsincebreed)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Larval period (days)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Larvalperiodsincebreed_compxregion_21_01_22.svg",width = 200, height = 150, units = 'mm')
(boxplot_Larvalperiodsincebreed_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Larvalperiodsincebreed)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Larval period (days)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




### per pop
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Larvalperiodsincebreed_pops_21_01_22_perpopulation.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Larvalperiodsincebreed_pops_21_01_22 <- Rawdata_experimentAugust2018_720%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Larvalperiodsincebreed)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Larval period (days)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_logscale_model_GR3_718_perpopulation.svg",width = 200, height = 150)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_pops_21_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=log_GR_final_days_mgDay)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()















## remove outliers - 717 
#Rawdata_experimentAugust2018_717<-Rawdata_experimentAugust2018_720

#Rawdata_experimentAugust2018_717$Av_juv_biomass[Rawdata_experimentAugust2018_717$Av_juv_biomass <= 0.009] <- "NA"


#Rawdata_experimentAugust2018_717$Av_juv_biomass[Rawdata_experimentAugust2018_717$Av_juv_biomass >= 0.350] <- "NA"


#Rawdata_experimentAugust2018<-Rawdata_experimentAugust2018_717



## 717
#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/RawdataexperimentAugust_2018_toosmallremovedonebig.csv",header=T,row.names=NULL,sep=",")
#dim(Rawdata_experimentAugust2018) #717  59


# 715 import data --- all original previous models  ---- residuals not ok --- if I add block its good
#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/RawdataexperimentAugust_2018.csv",header=T,row.names=NULL,sep=",")



### 712 datapoints - removed 8 outliers   --- residuals ok
#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/Raw_data_mesocosm_experiment_August_2018.csv",header=T,row.names=NULL,sep=",")

### 710
#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/Raw_data_mesocosm_experiment__August_2018.csv",header=T,row.names=NULL,sep=",")



## 714 also removes 0.5 in growth rate --- makes models non-significant
#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/Rawdataexperiment_August_2018.csv",header=T,row.names=NULL,sep=",")



#rm(list=ls())






##############################################
# average starting weights + percent metamorphosed ##########
##################################################



dim(Rawdata_experimentAugust2018) #714  59

#average staring weight toad tadpoles (g)
Rawdata_experimentAugust2018 %>%
  group_by(Region) %>%
  summarise(mean_run = mean(X25.5.18_experiment_start_tapole_av_individual_weight))


"A tibble: 2 x 2
  Region mean_run
  <chr>     <dbl>
1 HG       0.0327
2 ML       0.0175"

#percent metamorphosed by end

subset_dataRGRdd_renamedsomecolumns_2_10_20<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/subset_dataRGRdd_renamedsomecolumns_2_10_20.csv",header=T,row.names=NULL,sep=",")




sum(subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled)

"4134"

dim(subset_dataRGRdd_renamedsomecolumns_2_10_20) #72 238

#7200 indiv start

#4134/7200 = 0.574 = 57%


## NB this is how it was calc
subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled<- (subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged+                                                                                  subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_tadpoles+
                                                                                  subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_metamorphs+                                                                       subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_number_of_metamorphs)


### number unique starting weights - 70 unique starting weights weights
df_uniq <- unique(Rawdata_experimentAugust2018$X25.5.18_experiment_start_tapole_av_individual_weight)
length(df_uniq)



# average meta across tanks was 0.5748264
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled/subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start)

# distribution % metamorphosed across tanks
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled/subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start*100)


#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/hist_precent_metamorphosed_pertank_atend_72.png", width = 200, height = 150, units = 'mm', res = 600)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled/subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start*100)
#dev.off()

#svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/hist_precent_metamorphosed_pertank_atend_72.svg", width = 200, height = 150)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled/subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start*100)
#dev.off()

subset_dataRGRdd_renamedsomecolumns_2_10_20$Percent_metemorphosedbyend<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled/subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start*100



## including toads added as top up
subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th<-subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percapita*subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start


subset_dataRGRdd_renamedsomecolumns_2_10_20$Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th<-subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th+subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start



subset_dataRGRdd_renamedsomecolumns_2_10_20$Percent_metemorphosedbyend_tadsadded<-(subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled/(subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start+subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th))*100

mean(subset_dataRGRdd_renamedsomecolumns_2_10_20$Percent_metemorphosedbyend_tadsadded)
# 50.16079


#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/hist_precent_metamorphosed_tadsadded_pertank_atend_72.png", width = 200, height = 150, units = 'mm', res = 600)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Percent_metemorphosedbyend_tadsadded)
#dev.off()



#################################
### Count_toads_left_b4weigh ########
#################################

names(subset_dataRGRdd_renamedsomecolumns_2_10_20)

# density of toads per day weighed

summary(subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_including_weighed_metas)

" Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    3.75    6.00   17.35   19.50  105.00 "


summary(subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled)

" Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   38.50   55.00   57.42   69.50  139.00 "


[196]"Days19.7justexperiment"                                                    
[197] "Days27.7justexperiment"                                                    
[198] "Days31.7justexperiment"                                                    
[199] "Days3.8justexperiment"                                                     
[200] "Days7.8justexperiment"                                                     
[201] "Days10.8justexperiment"                                                    
[202] "Days20.8justexperiment"                                                    
[203] "Days23.8justexperiment"                                                    
[204] "Days13.8justexperiment" 
[206] "Days16.8justexperiment"   


[29] "X19.7.18_._number_adults"                                                  
[30] "X27.7.18_._NUMBER_ADULTS._WERE_NOT_WEIGHED"                                
[31] "X31.7.18_._number_adults"                                                  
[32] "X3.8.18_._number_adults"                                                   
[33] "X7.8.18_._number_adults"                                                   
[34] "X10.8.18_._number_adults"                                                  
[35] "X13.8.18_._number_adults"                                                  
[36] "X16.8.18_._number_adults"                                                  
[37] "X20.8.18_._number_adults"                                                  
[38] "X23.8.18_._number_adults" 


subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_._number_adults


subset_dataRGRdd_renamedsomecolumns_2_10_20$testsumcountadultsacrosstank<-rowSums(subset_dataRGRdd_renamedsomecolumns_2_10_20[,c(29:38)])

str(subset_dataRGRdd_renamedsomecolumns_2_10_20[c(29:38)])


subset_dataRGRdd_renamedsomecolumns_2_10_20$DIED_all

subset_dataRGRdd_renamedsomecolumns_2_10_20$Extra_number_at_end

subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_2_10_20
Mortalitydataset_26_06_2021$Mortality_06_05_20






subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_tadsadded_26_06_21<-
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start+
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Tadpoles_added_as_top.up_june7thand8th-
  
  (subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged+
     subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_tadpoles+
     subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_metamorphs+
     subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_number_of_metamorphs)




subset_dataRGRdd_renamedsomecolumns_2_10_20

subset_dataRGRdd_renamedsomecolumns_2_10_20[c(196:204,206)]


subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_90<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Survived_counts_weighedandkilled

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_87<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_90+subset_dataRGRdd_renamedsomecolumns_2_10_20$X20.8.18_._number_adults

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_83<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_87+subset_dataRGRdd_renamedsomecolumns_2_10_20$X16.8.18_._number_adults

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_80<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_83+subset_dataRGRdd_renamedsomecolumns_2_10_20$X13.8.18_._number_adults

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_77<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_80+subset_dataRGRdd_renamedsomecolumns_2_10_20$X10.8.18_._number_adults

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_74<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_77+subset_dataRGRdd_renamedsomecolumns_2_10_20$X7.8.18_._number_adults

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_70<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_74+subset_dataRGRdd_renamedsomecolumns_2_10_20$X3.8.18_._number_adults

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_67<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_70+subset_dataRGRdd_renamedsomecolumns_2_10_20$X31.7.18_._number_adults

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_63<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_67+subset_dataRGRdd_renamedsomecolumns_2_10_20$X27.7.18_._NUMBER_ADULTS._WERE_NOT_WEIGHED

subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_55<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Days_count_63+subset_dataRGRdd_renamedsomecolumns_2_10_20$X19.7.18_._number_adults


#write.csv(subset_dataRGRdd_renamedsomecolumns_2_10_20,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/subset_dataRGRdd_renamedsomecolumns_18_01_22.csv")

#write.csv(subset_dataRGRdd_renamedsomecolumns_2_10_20,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/subset_dataRGRdd_renamedsomecolumns_01_02_22.csv")


## counts
subset_dataRGRdd_renamedsomecolumns_2_10_20[c(240:251)]

## dataset with tank and counts
toadsleft_tank<-subset_dataRGRdd_renamedsomecolumns_2_10_20[c(5,240:251)]


head(toadsleft_tank)

toadsleft_tank_long <- gather(toadsleft_tank, Days, Count_toads_left_b4weigh, Days_count_90:Days_count_55, factor_key=TRUE)
toadsleft_tank_long

dim(toadsleft_tank_long) #720   3

# rename days column
levels(toadsleft_tank_long$Days) <- sub("Days_count_", "", levels(toadsleft_tank_long$Days))

head(toadsleft_tank_long)
str(head(toadsleft_tank_long))

#toadsleft_tank_long$Days<-as.numeric(as.character(toadsleft_tank_long$Days))
dim(toadsleft_tank_long) #720   3
## join with Raw data

toadsleft_tank_long$Tank_Days<-str_c(toadsleft_tank_long$Tank,'_',toadsleft_tank_long$Days)

head(toadsleft_tank_long)

## subset to just tank days and counts
toadsleft_tank_long<-toadsleft_tank_long[c("Count_toads_left_b4weigh","Tank_Days")]
head(toadsleft_tank_long)

############################################
######## JOIN ####################
Rawdata_experimentAugust2018<-left_join(Rawdata_experimentAugust2018,toadsleft_tank_long,by="Tank_Days")

head(Rawdata_experimentAugust2018)
dim(Rawdata_experimentAugust2018) #715  57


#scale Count_toads_left_b4weigh
Xtemp9 <-Rawdata_experimentAugust2018$Count_toads_left_b4weigh

Xscaled9 <- (Xtemp9 - mean(Xtemp9))/sd(Xtemp9)
Rawdata_experimentAugust2018$scaled_Count_toads_left_b4weigh  <- Xscaled9







#############################
### rename some variables
###############################
Rawdata_experimentAugust2018$Block<-as.factor(Rawdata_experimentAugust2018$Block)
Rawdata_experimentAugust2018$Population<-as.factor(Rawdata_experimentAugust2018$Population)
Rawdata_experimentAugust2018$Tank<-as.factor(Rawdata_experimentAugust2018$Tank)




##########
########### add new treatments ############
##########################################



Rawdata_experimentAugust2018$Toad_Cooccurrence_History<-Rawdata_experimentAugust2018$Region
Rawdata_experimentAugust2018$Toad_Cooccurrence_History<-as.character(Rawdata_experimentAugust2018$Toad_Cooccurrence_History)
Rawdata_experimentAugust2018$Toad_Cooccurrence_History[Rawdata_experimentAugust2018$Toad_Cooccurrence_History == "HG"] <- "Short" 
Rawdata_experimentAugust2018$Toad_Cooccurrence_History[Rawdata_experimentAugust2018$Toad_Cooccurrence_History== "ML"] <- "Long" 
Rawdata_experimentAugust2018$Toad_Cooccurrence_History<-as.factor(Rawdata_experimentAugust2018$Toad_Cooccurrence_History)




Rawdata_experimentAugust2018$Competitior_Identity<-Rawdata_experimentAugust2018$Competition_level
Rawdata_experimentAugust2018$Competitior_Identity<-as.character(Rawdata_experimentAugust2018$Competitior_Identity)
Rawdata_experimentAugust2018$Competitior_Identity[Rawdata_experimentAugust2018$Competitior_Identity == "High_control"] <- "Toad_control" 
Rawdata_experimentAugust2018$Competitior_Identity[Rawdata_experimentAugust2018$Competitior_Identity== "FrogHG"] <- "NRLF_HG" 
Rawdata_experimentAugust2018$Competitior_Identity[Rawdata_experimentAugust2018$Competitior_Identity== "FrogML"] <- "NRLF_ML" 
Rawdata_experimentAugust2018$Competitior_Identity<-as.factor(Rawdata_experimentAugust2018$Competitior_Identity)

Rawdata_experimentAugust2018$Competition_Treatment<-Rawdata_experimentAugust2018$Competitior_Identity
Rawdata_experimentAugust2018$Competitor_Identity<-Rawdata_experimentAugust2018$Competitior_Identity


Rawdata_experimentAugust2018$Density<-Rawdata_experimentAugust2018$Total_number_individuals_start
Rawdata_experimentAugust2018$Density[Rawdata_experimentAugust2018$Density == "80"] <- "Low"
Rawdata_experimentAugust2018$Density[Rawdata_experimentAugust2018$Density == "160"] <- "High" 


Rawdata_experimentAugust2018$NRLF_ML<-Rawdata_experimentAugust2018$Competition_level
Rawdata_experimentAugust2018$NRLF_ML<-as.character(Rawdata_experimentAugust2018$NRLF_ML)
Rawdata_experimentAugust2018$NRLF_ML[Rawdata_experimentAugust2018$NRLF_ML == "Low_control"] <- "N" 
Rawdata_experimentAugust2018$NRLF_ML[Rawdata_experimentAugust2018$NRLF_ML == "High_control"] <- "N" 
Rawdata_experimentAugust2018$NRLF_ML[Rawdata_experimentAugust2018$NRLF_ML == "FrogHG"] <- "N" 
Rawdata_experimentAugust2018$NRLF_ML[Rawdata_experimentAugust2018$NRLF_ML == "FrogML"] <- "Y" 
Rawdata_experimentAugust2018$NRLF_ML<-as.factor(Rawdata_experimentAugust2018$NRLF_ML)

Rawdata_experimentAugust2018$NRLF_HG<-Rawdata_experimentAugust2018$Competition_level
Rawdata_experimentAugust2018$NRLF_HG<-as.character(Rawdata_experimentAugust2018$NRLF_HG)
Rawdata_experimentAugust2018$NRLF_HG[Rawdata_experimentAugust2018$NRLF_HG == "Low_control"] <- "N" 
Rawdata_experimentAugust2018$NRLF_HG[Rawdata_experimentAugust2018$NRLF_HG == "High_control"] <- "N" 
Rawdata_experimentAugust2018$NRLF_HG[Rawdata_experimentAugust2018$NRLF_HG == "FrogML"] <- "N" 
Rawdata_experimentAugust2018$NRLF_HG[Rawdata_experimentAugust2018$NRLF_HG == "FrogHG"] <- "Y" 
Rawdata_experimentAugust2018$NRLF_HG<-as.factor(Rawdata_experimentAugust2018$NRLF_HG)




Rawdata_experimentAugust2018$Toad_region<-Rawdata_experimentAugust2018$Region
Rawdata_experimentAugust2018$Toad_density<-Rawdata_experimentAugust2018$Density


Rawdata_experimentAugust2018$NRLF_treatment<-Rawdata_experimentAugust2018$Competition_level
Rawdata_experimentAugust2018$NRLF_treatment<-as.character(Rawdata_experimentAugust2018$NRLF_treatment)

Rawdata_experimentAugust2018$NRLF_treatment[Rawdata_experimentAugust2018$NRLF_treatment == "Low_control"] <- "No_NRLFs" 
Rawdata_experimentAugust2018$NRLF_treatment[Rawdata_experimentAugust2018$NRLF_treatment == "High_control"] <- "No_NRLFs" 
Rawdata_experimentAugust2018$NRLF_treatment[Rawdata_experimentAugust2018$NRLF_treatment == "FrogML"] <- "NRLF_ML" 
Rawdata_experimentAugust2018$NRLF_treatment[Rawdata_experimentAugust2018$NRLF_treatment == "FrogHG"] <- "NRLF_HG" 
Rawdata_experimentAugust2018$NRLF_treatment<-as.factor(Rawdata_experimentAugust2018$NRLF_treatment)








#####################################
######## CORRECT SCALING  i.e from 0 to 1 ############
########################

Rawdata_experimentAugust2018$Mean_Average_Water_Temperature_Scaled<-(Rawdata_experimentAugust2018$Mean_averageTemp-min(Rawdata_experimentAugust2018$Mean_averageTemp))/(max(Rawdata_experimentAugust2018$Mean_averageTemp)-min(Rawdata_experimentAugust2018$Mean_averageTemp))


Rawdata_experimentAugust2018$Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled<-(Rawdata_experimentAugust2018$toadTadpoles_added_as_top.up_june7thand8th_percapita-min(Rawdata_experimentAugust2018$toadTadpoles_added_as_top.up_june7thand8th_percapita))/(max(Rawdata_experimentAugust2018$toadTadpoles_added_as_top.up_june7thand8th_percapita)-min(Rawdata_experimentAugust2018$toadTadpoles_added_as_top.up_june7thand8th_percapita))


Rawdata_experimentAugust2018$Average_Individual_Toad_Tadpole_Starting_Weight_Scaled<-(Rawdata_experimentAugust2018$X25.5.18_experiment_start_tapole_av_individual_weight-min(Rawdata_experimentAugust2018$X25.5.18_experiment_start_tapole_av_individual_weight))/(max(Rawdata_experimentAugust2018$X25.5.18_experiment_start_tapole_av_individual_weight)-min(Rawdata_experimentAugust2018$X25.5.18_experiment_start_tapole_av_individual_weight))


Rawdata_experimentAugust2018$Toad_Mortality_per_Capita_Scaled<-(Rawdata_experimentAugust2018$Mortality_06_05_20_percapita-min(Rawdata_experimentAugust2018$Mortality_06_05_20_percapita))/(max(Rawdata_experimentAugust2018$Mortality_06_05_20_percapita)-min(Rawdata_experimentAugust2018$Mortality_06_05_20_percapita))


Rawdata_experimentAugust2018$Days_Since_Experiment_Began_Scaled<-(Rawdata_experimentAugust2018$Days-min(Rawdata_experimentAugust2018$Days))/(max(Rawdata_experimentAugust2018$Days)-min(Rawdata_experimentAugust2018$Days))




#########################
############### old SCALING ##########
######################

#starting weight
Xtemp <- Rawdata_experimentAugust2018$X25.5.18_experiment_start_tapole_av_individual_weight 
Xtemp

Xscaled <- (Xtemp - mean(Xtemp))/sd(Xtemp)
Rawdata_experimentAugust2018$scaled_X25.5.18_experiment_start_tapole_av_individual_weight  <- Xscaled

### tadpole top up
Xtemp2 <-Rawdata_experimentAugust2018$toadTadpoles_added_as_top.up_june7thand8th_percapita 

Xscaled2 <- (Xtemp2 - mean(Xtemp2))/sd(Xtemp2)
Rawdata_experimentAugust2018$scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita  <- Xscaled2

### mortality
Xtemp3 <-Rawdata_experimentAugust2018$Mortality_tadsadded_26_06_21_percapita 

Xscaled3 <- (Xtemp3 - mean(Xtemp3))/sd(Xtemp3)
Rawdata_experimentAugust2018$scaled_Mortality_tadsadded_26_06_21_percapita  <- Xscaled3



### scaled Density_tadsadded_minus_mortality_percapita
Xtemp4 <-Rawdata_experimentAugust2018$Density_tadsadded_minus_mortality_percapita 

Xscaled4 <- (Xtemp4 - mean(Xtemp4))/sd(Xtemp4)
Rawdata_experimentAugust2018$scaled_Density_tadsadded_minus_mortality_percapita  <- Xscaled4


### scaled Count_toads_left_b4weigh
Xtemp5 <-Rawdata_experimentAugust2018$Count_toads_left_b4weigh 

Xscaled5 <- (Xtemp5 - mean(Xtemp5))/sd(Xtemp5)
Rawdata_experimentAugust2018$scaled_Count_toads_left_b4weigh  <- Xscaled5



##  Mortality_06_05_20_percapita



Xtemp6 <-Rawdata_experimentAugust2018$Mortality_06_05_20_percapita 

Xscaled6 <- (Xtemp6 - mean(Xtemp6))/sd(Xtemp6)
Rawdata_experimentAugust2018$scaled_Mortality_06_05_20_percapita  <- Xscaled6



### Total_chla_conc_26.7.18_ug.l

Xtemp7 <-Rawdata_experimentAugust2018$Total_chla_conc_26.7.18_ug.l

Xscaled7 <- (Xtemp7 - mean(Xtemp7))/sd(Xtemp7)
Rawdata_experimentAugust2018$scaled_Total_chla_conc_26.7.18_ug.l  <- Xscaled7

######### Mean_averageTemp
Xtemp8 <-Rawdata_experimentAugust2018$Mean_averageTemp

Xscaled8 <- (Xtemp8 - mean(Xtemp8))/sd(Xtemp8)
Rawdata_experimentAugust2018$scaled_Mean_averageTemp  <- Xscaled8



######### Days
Xtemp10 <-Rawdata_experimentAugust2018$Days

Xscaled10 <- (Xtemp10 - mean(Xtemp10))/sd(Xtemp10)
Rawdata_experimentAugust2018$scaled_Days  <- Xscaled10







########################################################
#########################################################
############### 1. TOAD GROWTH RATE ##########
##################################################
######################################################

#### VERY IMPORTANT FOR CUSTOM CONTRASTS #####
#order levels of factor
Rawdata_experimentAugust2018$Region<- factor(Rawdata_experimentAugust2018$Region, levels = c("HG","ML"))
Rawdata_experimentAugust2018<- droplevels(Rawdata_experimentAugust2018)


############ calculate toad growth rate
Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD<-((Rawdata_experimentAugust2018$Av_juv_biomass-Rawdata_experimentAugust2018$X25.5.18_experiment_start_tapole_av_individual_weight)/Rawdata_experimentAugust2018$SumDD)*1000


############ calculate toad growth rate - Richter Boix 2011
Rawdata_experimentAugust2018$GR_final_days_mgDay<-(Rawdata_experimentAugust2018$Av_juv_biomass/Rawdata_experimentAugust2018$Days)*1000



# log (natural log!!!) ## not what i used
Rawdata_experimentAugust2018$log_GR_final_days_mgDay<-log(Rawdata_experimentAugust2018$GR_final_days_mgDay)
hist(Rawdata_experimentAugust2018$log_GR_final_days_mgDay)


# log10
Rawdata_experimentAugust2018$log10_GR_final_days_mgDay<-log10(Rawdata_experimentAugust2018$GR_final_days_mgDay)

### growth rate as richtoer biox
Rawdata_experimentAugust2018$GR_final_larvalperiod_mgDay<-(Rawdata_experimentAugust2018$Av_juv_biomass/Rawdata_experimentAugust2018$Larvalperiodsincebreed)*1000


# log10
Rawdata_experimentAugust2018$log10_GR_final_larvalperiod_mgDay<-log10(Rawdata_experimentAugust2018$GR_final_larvalperiod_mgDay)






### add column that is the number of animals left in tank at time of weighing (i.e. last number weighed )

plot(Rawdata_experimentAugust2018$Days,Rawdata_experimentAugust2018$Count_juv_emerged)

##############################################################
########## transformations ############
######  test normality #########
qqPlot(Rawdata_experimentAugust2018$GR_final_days_mgDay)
hist(Rawdata_experimentAugust2018$GR_final_days_mgDay)


shapiro.test(Rawdata_experimentAugust2018$GR_final_days_mgDay)

"
	Shapiro-Wilk normality test

data:  Rawdata_experimentAugust2018$GR_final_days_mgDay
W = 0.84901, p-value < 2.2e-16"

# log
# Rawdata_experimentAugust2018$log_GR_final_days_mgDay<-log(Rawdata_experimentAugust2018$GR_final_days_mgDay)
hist(Rawdata_experimentAugust2018$log_GR_final_days_mgDay)

qqPlot(Rawdata_experimentAugust2018$log_GR_final_days_mgDay)
hist(Rawdata_experimentAugust2018$log_GR_final_days_mgDay)


shapiro.test(Rawdata_experimentAugust2018$log_GR_final_days_mgDay)

"Shapiro-Wilk normality test

data:  Rawdata_experimentAugust2018$log_GR_final_days_mgDay
W = 0.98425, p-value = 9.326e-05"


qqPlot(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)
hist(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)


shapiro.test(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)
"Shapiro-Wilk normality test

data:  Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD
W = 0.95183, p-value = 7.86e-11"


## not normal

#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/hist_GR_finalmin_intial_degreedays_mgDD.png", width = 8, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)
dev.off()

## transform data

# sqrt
Rawdata_experimentAugust2018$sqrt_GR_finalmin_intial_degreedays_mgDD<-sqrt(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)
hist(Rawdata_experimentAugust2018$sqrt_GR_finalmin_intial_degreedays_mgDD)

#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/hist_sqrt_GR_finalmin_intial_degreedays_mgDD.png", width = 8, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$sqrt_GR_finalmin_intial_degreedays_mgDD)
dev.off()

shapiro.test(Rawdata_experimentAugust2018$sqrt_GR_finalmin_intial_degreedays_mgDD)


# log
Rawdata_experimentAugust2018$log_GR_finalmin_intial_degreedays_mgDD<-log(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)
hist(Rawdata_experimentAugust2018$log_GR_finalmin_intial_degreedays_mgDD)




#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/hist_log_GR_finalmin_intial_degreedays_mgDD.png", width = 8, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$log_GR_finalmin_intial_degreedays_mgDD)
dev.off()

shapiro.test(Rawdata_experimentAugust2018$log_GR_finalmin_intial_degreedays_mgDD)


#inverse sqrt
Rawdata_experimentAugust2018$inverse_GR_finalmin_intial_degreedays_mgDD<-1/sqrt(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)
hist(Rawdata_experimentAugust2018$inverse_GR_finalmin_intial_degreedays_mgDD)

#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/hist_inverse_GR_finalmin_intial_degreedays_mgDD.png", width = 8, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$inverse_GR_finalmin_intial_degreedays_mgDD)
dev.off()

#arcsin -metafor

Rawdata_experimentAugust2018$arcsin_GR_finalmin_intial_degreedays_mgDD<-transf.arcsin(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)

hist(Rawdata_experimentAugust2018$arcsin_GR_finalmin_intial_degreedays_mgDD)

shapiro.test(Rawdata_experimentAugust2018$arcsin_GR_finalmin_intial_degreedays_mgDD)

"
	Shapiro-Wilk normality test

data:  Rawdata_experimentAugust2018$arcsin_GR_finalmin_intial_degreedays_mgDD
W = 0.98678, p-value = 0.0004699"

#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/hist_arcsin_GR_finalmin_intial_degreedays_mgDD.png", width = 8, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$arcsin_GR_finalmin_intial_degreedays_mgDD)
dev.off()

#inverse 
Rawdata_experimentAugust2018$inverse_GR_finalmin_intial_degreedays_mgDD<-1/(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)
hist(Rawdata_experimentAugust2018$inverse_GR_finalmin_intial_degreedays_mgDD)






Rawdata_experimentAugust2018_noNA<-Rawdata_experimentAugust2018[!(Rawdata_experimentAugust2018$Av_juv_biomass_mg=="NA"),]

dim(Rawdata_experimentAugust2018_noNA)

GR_final_days_mgDay_718 <- Rawdata_experimentAugust2018_noNA %>%
  group_by(Region,Competition_level)

GR_final_days_mgDay_718<-GR_final_days_mgDay_718 %>%
  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), GR_final_days_mgDay)

GR_final_days_mgDay_718<-as.data.frame(GR_final_days_mgDay_718)
GR_final_days_mgDay_718

#GR_final_days_mgDay_718[!GR_final_days_mgDay_718$se==NA]

write.csv(GR_final_days_mgDay_718,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Mean_sd_se_GR_final_days_mgDay_718.csv")

######### percent

GR_final_days_mgDay_718_minus<-GR_final_days_mgDay_718


HGfrog_HGlowtoad=1.360544
HGhightoad=1.258651
HGfrog_MLlowtoad=1.719244
MLhightoad=1.259327

###### HG frog and intra vs inter
#GR_final_days_mgDay_718_minus$Contrast<-("HGfrog_HGlowtoad__HGhightoad")
#GR_final_days_mgDay_718_minus$mean_GR<-1.360544-1.258651

#GR_final_days_mgDay_718_minus$mean_GR_PERCENT<-((HGfrog_HGlowtoad-HGhightoad)/HGfrog_HGlowtoad)*100

#GR_final_days_mgDay_718_minus$Contrast<-("HGfrog_MLlowtoad__MLhightoad")
#GR_final_days_mgDay_718_minus$mean_GR<-1.719244-1.259327

#GR_final_days_mgDay_718_minus$Contrast<-("HGfrog_HGlowtoad__HGhightoad_MINUS_HGfrog_MLlowtoad__MLhightoad")

#GR_final_days_mgDay_718_minus$mean_GR<-((HGfrog_HGlowtoad-HGhightoad)-(HGfrog_MLlowtoad-MLhightoad))

#bad
#GR_final_days_mgDay_718_minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)-(HGfrog_MLlowtoad-MLhightoad))/(HGfrog_HGlowtoad-HGhightoad))*100

#GR_final_days_mgDay_718_minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)-((HGfrog_MLlowtoad-MLhightoad)/MLhightoad))*100

#toads grew (0.20  0.09 mg/day (mean  SE) (13.2%)) slower and emerged 26.8  6.0 mg (28.2%) lighter 

### intra vs inter
GR_final_days_mgDay_718_minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)*100)



(((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)*100)                                          
(((HGfrog_MLlowtoad-MLhightoad)/MLhightoad)*100)


### inter - HG vs ML toad
(HGfrog_HGlowtoad-HGfrog_MLlowtoad)
(((HGfrog_HGlowtoad-HGfrog_MLlowtoad)/HGfrog_MLlowtoad)*100) 






###########################################################
########### Jen suggestion, remove low treatments ########
##########################################################

Rawdata_experimentAugust2018_nolow<-Rawdata_experimentAugust2018
Rawdata_experimentAugust2018_nolow<-Rawdata_experimentAugust2018_nolow[!(Rawdata_experimentAugust2018_nolow$Competition_level=="Low_control"),]
dim(Rawdata_experimentAugust2018_nolow) #539  104



Rawdata_experimentAugust2018_nolow$Treatment_three<-as.factor(Rawdata_experimentAugust2018_nolow$Treatment_three)



### get means and standard errors
Rawdata_experimentAugust2018_nolow_noNA<-Rawdata_experimentAugust2018_nolow[!(Rawdata_experimentAugust2018_nolow$Av_juv_biomass_mg=="NA"),]

dim(Rawdata_experimentAugust2018_nolow_noNA)

GR_final_days_mgDay_539 <- Rawdata_experimentAugust2018_noNA %>%
  group_by(Region,Competition_level)

GR_final_days_mgDay_539<-GR_final_days_mgDay_539 %>%
  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), GR_final_days_mgDay)

GR_final_days_mgDay_539<-as.data.frame(GR_final_days_mgDay_539)
GR_final_days_mgDay_539

write.csv(GR_final_days_mgDay_539,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Mean_sd_se_GR_final_days_mgDay_539.csv")






#######################################
############# LMMR - TOAD GROWTH RATE ############
#########################################





#############
#### JEN suggestion ######
###########################



#### model_M_GR2 ####
model_M_GR2<-lmer(log10_GR_final_days_mgDay~
                    Toad_region*NRLF_treatment+ 
                    Toad_density+
            scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    Days+
                    Block_factor+
                    Mean_averageTemp+
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_M_GR2)
car::Anova(model_M_GR2)
AIC(model_M_GR2) #    -897.0104
summary(model_M_GR2)



capture.output(check_collinearity(model_M_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/collinearity_performance_growthrate_model_M_GR2_718.txt")




#718
capture.output(anova(model_M_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_M_GR2_718.txt")
write.csv(anova(model_M_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_M_GR2_718.csv")
write.csv(car::Anova(model_M_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_M_GR2_718.csv")
capture.output(Anova(model_M_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_M_GR2_718.txt")
capture.output(summary(model_M_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_M_GR2_718.txt")



tab_model(model_M_GR2,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_M_GR2_718.doc")

tab_model(model_M_GR2,show.df = TRUE,p.val = "kr",file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_M_GR2_718_df_pkr.doc")


### test residuals - mostly ok
qqnorm(resid(model_M_GR2))
hist(resid(model_M_GR2))
plot(model_M_GR2)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_M_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_M_GR2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_M_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_M_GR2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_M_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_M_GR2))
dev.off()


## interaction means
(model_M_GR2.means <- interactionMeans(model_M_GR2))
plot(model_M_GR2.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_M_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_M_GR2.means <- interactionMeans(model_M_GR2))
plot(model_M_GR2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_M_GR2_718.svg", width = 12, height = 6.5)
(model_M_GR2.means <- interactionMeans(model_M_GR2))
plot(model_M_GR2.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_M_GR2)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_M_GR2_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_M_GR2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_M_GR2_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_M_GR2)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_M_GR2)


L.S_model_M_GR2_frog <- pairs(lsmeans(model_M_GR2, ~ Toad_region | NRLF_treatment))
test(L.S_model_M_GR2_frog, adjust = "tukey")

capture.output(test(L.S_model_M_GR2_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR2_frog_718.txt")
write.csv(test(L.S_model_M_GR2_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR2_frog_718.csv")


L.S_model_M_GR2_region <- pairs(lsmeans(model_M_GR2, ~ NRLF_treatment | Toad_region))
test(L.S_model_M_GR2_region, adjust = "tukey")


capture.output(test(L.S_model_M_GR2_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR2_region_718.txt")
write.csv(test(L.S_model_M_GR2_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR2_region_718.csv")


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/pairs_model_M_GR2_718.png", width = 8, height = 6.5, units = 'in', res = 300)
pairs(log10_GR_final_days_mgDay~
        Toad_region*NRLF_treatment+ 
        Toad_density+
        scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
        scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
        Mortality_06_05_20_percapita+
        Days+
        Block_factor+
        Mean_averageTemp, data=Rawdata_experimentAugust2018)
dev.off()

















#####################
########### MARY SUGGESTION ##############
##########################################



### FOR NEW WAY, ORDER THE OTHER WAY
Rawdata_experimentAugust2018$Toad_region<- factor(Rawdata_experimentAugust2018$Toad_region, levels = c("ML","HG"))
Rawdata_experimentAugust2018<- droplevels(Rawdata_experimentAugust2018)




#### model_M_GR1 ####
model_M_GR1<-lmer(log10_GR_final_days_mgDay~
                  Toad_region*Toad_density*NRLF_HG+ 
                    Toad_region*Toad_density*NRLF_ML+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_M_GR1)
car::Anova(model_M_GR1)
AIC(model_M_GR1) #    -897.0104
summary(model_M_GR1)



capture.output(check_collinearity(model_M_GR1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/collinearity_performance_growthrate_model_M_GR1_718.txt")




#718
capture.output(anova(model_M_GR1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_M_GR1_718.txt")
write.csv(anova(model_M_GR1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_M_GR1_718.csv")
write.csv(car::Anova(model_M_GR1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_M_GR1_718.csv")
capture.output(Anova(model_M_GR1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_M_GR1_718.txt")
capture.output(summary(model_M_GR1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_M_GR1_718.txt")



tab_model(model_M_GR1,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_M_GR1_718.doc")

tab_model(model_M_GR1,show.df = TRUE,p.val = "kr",file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_M_GR1_718_df_pkr.doc")


### test residuals - mostly ok
qqnorm(resid(model_M_GR1))
hist(resid(model_M_GR1))
plot(model_M_GR1)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_M_GR1_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_M_GR1)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_M_GR1_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_M_GR1))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_M_GR1_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_M_GR1))
dev.off()


## interaction means
(model_M_GR1.means <- interactionMeans(model_M_GR1))
plot(model_M_GR1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_M_GR1_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_M_GR1.means <- interactionMeans(model_M_GR1))
plot(model_M_GR1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_M_GR1_718.svg", width = 12, height = 6.5)
(model_M_GR1.means <- interactionMeans(model_M_GR1))
plot(model_M_GR1.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_M_GR1)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_M_GR1_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_M_GR1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_M_GR1_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_M_GR1)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_M_GR1)


L.S_model_M_GR1_frog <- pairs(lsmeans(model_M_GR1, ~ Region | Competition_level))
test(L.S_model_M_GR1_frog, adjust = "tukey")

capture.output(test(L.S_model_M_GR1_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR1_frog_718.txt")
write.csv(test(L.S_model_M_GR1_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR1_frog_718.csv")


L.S_model_M_GR1_region <- pairs(lsmeans(model_M_GR1, ~ Competition_level | Region ))
test(L.S_model_M_GR1_region, adjust = "tukey")


capture.output(test(L.S_model_M_GR1_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR1_region_718.txt")
write.csv(test(L.S_model_M_GR1_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_M_GR1_region_718.csv")


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/pairs_model_M_GR1_718.png", width = 8, height = 6.5, units = 'in', res = 300)
pairs(log10_GR_final_days_mgDay~
        Region*Competition_level+ 
        scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
        scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
        Mortality_06_05_20_percapita+
        Days+
        Block_factor+
        Mean_averageTemp, data=Rawdata_experimentAugust2018)
dev.off()




























#### VERY IMPORTANT FOR CUSTOM CONTRASTS #####
#order levels of factor
Rawdata_experimentAugust2018$Region<- factor(Rawdata_experimentAugust2018$Region, levels = c("HG","ML"))
Rawdata_experimentAugust2018<- droplevels(Rawdata_experimentAugust2018)


#########################
####### best 26.01.22
#########################



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/hist_log10_GR_final_days_mgDay_model_GR3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$log10_GR_final_days_mgDay)
dev.off()



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/hist_GR_final_days_mgDay_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$GR_final_days_mgDay)
dev.off()






####### old best #####
#### model_GR3 ####
model_GR3<-lmer(log10_GR_final_days_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR3)
car::Anova(model_GR3)
AIC(model_GR3) #    -897.0104
summary(model_GR3)



capture.output(check_collinearity(model_GR3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/collinearity_performance_growthrate_model_GR3_718.txt")




#718
capture.output(anova(model_GR3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR3_718.txt")
write.csv(anova(model_GR3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR3_718.csv")
write.csv(car::Anova(model_GR3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR3_718.csv")
capture.output(Anova(model_GR3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR3_718.txt")
capture.output(summary(model_GR3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR3_718.txt")



tab_model(model_GR3,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR3_718.doc")

tab_model(model_GR3,show.df = TRUE,p.val = "kr",file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR3_718_df_pkr.doc")


### test residuals - mostly ok
qqnorm(resid(model_GR3))
hist(resid(model_GR3))
plot(model_GR3)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR3)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR3))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR3))
dev.off()


## interaction means
(model_GR3.means <- interactionMeans(model_GR3))
plot(model_GR3.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR3.means <- interactionMeans(model_GR3))
plot(model_GR3.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR3_718.svg", width = 12, height = 6.5)
(model_GR3.means <- interactionMeans(model_GR3))
plot(model_GR3.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR3)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR3_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR3)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR3_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR3)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR3)


L.S_model_GR3_frog <- pairs(lsmeans(model_GR3, ~ Region | Competition_level))
test(L.S_model_GR3_frog, adjust = "tukey")

capture.output(test(L.S_model_GR3_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_frog_718.txt")
write.csv(test(L.S_model_GR3_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_frog_718.csv")


L.S_model_GR3_region <- pairs(lsmeans(model_GR3, ~ Competition_level | Region ))
test(L.S_model_GR3_region, adjust = "tukey")


capture.output(test(L.S_model_GR3_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_region_718.txt")
write.csv(test(L.S_model_GR3_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_region_718.csv")


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/pairs_model_GR3_718.png", width = 8, height = 6.5, units = 'in', res = 300)
pairs(log10_GR_final_days_mgDay~
        Region*Competition_level+ 
        scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
        scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
        Mortality_06_05_20_percapita+
        Days+
        Block_factor+
        Mean_averageTemp, data=Rawdata_experimentAugust2018)
dev.off()



### cooks D - leverage

install.packages("influence.ME")
library(influence.ME)
#cooksd <- influence.ME::cooksd(model_GR3)
#cooksd


### calucalting influential potin at the tank levle - i.e. removing whole tank
alt.est.a <- influence(model_GR3, "Tank_factor")

plot(cooks.distance(alt.est.a))


model.b <- exclude.influence(model_GR3, "Tank_factor", "18")
alt.est.b <- influence(model.b, "Tank_factor")


plot(cooksd)

## to get the observation thats impacting the model
model_GR3@frame[18,]

infl.th <- 4/(length(unique(model_GR3@frame$Tank_factor))-
                8) 


#### remove that tank
Rawdata_experimentAugust2018_noA13<-Rawdata_experimentAugust2018
Rawdata_experimentAugust2018_noA13<-Rawdata_experimentAugust2018_noA13[!Rawdata_experimentAugust2018_noA13$Tank_factor=="A13",]




## run this model without the influential tank


####### old best #####
#### model_GR3 ####
model_GR3_noA13<-lmer(log10_GR_final_days_mgDay~
                        Region*Competition_level+ 
                        scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                        scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                        Mortality_06_05_20_percapita+
                        Days+
                        Block_factor+
                        Mean_averageTemp+
                        #(1|Daysfactor/Tank_factor)+
                        (1+Days|Tank_factor)+
                        (1|Population_factor), 
                      #(1|Block_factor), #random effects
                      data=Rawdata_experimentAugust2018_noA13,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR3_noA13)
car::Anova(model_GR3_noA13)
AIC(model_GR3_noA13) #    -897.0104
summary(model_GR3_noA13)



capture.output(check_collinearity(model_GR3_noA13),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/collinearity_performance_growthrate_model_GR3_noA13_718.txt")




#718
capture.output(anova(model_GR3_noA13),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR3_noA13_718.txt")
write.csv(anova(model_GR3_noA13),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR3_noA13_718.csv")
write.csv(car::Anova(model_GR3_noA13),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR3_noA13_718.csv")
capture.output(Anova(model_GR3_noA13),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR3_noA13_718.txt")
capture.output(summary(model_GR3_noA13),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR3_noA13_718.txt")



tab_model(model_GR3_noA13,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR3_noA13_718.doc")



### test residuals - mostly ok
qqnorm(resid(model_GR3_noA13))
hist(resid(model_GR3_noA13))
plot(model_GR3_noA13)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR3_noA13_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR3_noA13)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR3_noA13_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR3_noA13))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR3_noA13_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR3_noA13))
dev.off()


## interaction means
(model_GR3_noA13.means <- interactionMeans(model_GR3_noA13))
plot(model_GR3_noA13.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR3_noA13_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR3_noA13.means <- interactionMeans(model_GR3_noA13))
plot(model_GR3_noA13.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR3_noA13_718.svg", width = 12, height = 6.5)
(model_GR3_noA13.means <- interactionMeans(model_GR3_noA13))
plot(model_GR3_noA13.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR3_noA13)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR3_noA13_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR3_noA13)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR3_noA13_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR3_noA13)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR3_noA13)


L.S_model_GR3_noA13_frog <- pairs(lsmeans(model_GR3_noA13, ~ Region | Competition_level))
test(L.S_model_GR3_noA13_frog, adjust = "tukey")

capture.output(test(L.S_model_GR3_noA13_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_noA13_frog_718.txt")
write.csv(test(L.S_model_GR3_noA13_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_noA13_frog_718.csv")


L.S_model_GR3_noA13_region <- pairs(lsmeans(model_GR3_noA13, ~ Competition_level | Region ))
test(L.S_model_GR3_noA13_region, adjust = "tukey")


capture.output(test(L.S_model_GR3_noA13_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_noA13_region_718.txt")
write.csv(test(L.S_model_GR3_noA13_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR3_noA13_region_718.csv")


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/pairs_model_GR3_noA13_718.png", width = 8, height = 6.5, units = 'in', res = 300)
pairs(log10_GR_final_days_mgDay~
        Region*Competition_level+ 
        scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
        scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
        Mortality_06_05_20_percapita+
        Days+
        Block_factor+
        Mean_averageTemp, data=Rawdata_experimentAugust2018)
dev.off()




### same as GR3 but has no slope for tank
#### model_GR9 ####
model_GR9<-lmer(log10_GR_final_days_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR9)
car::Anova(model_GR9)
AIC(model_GR9) #    -854.9306
summary(model_GR9)





capture.output(check_collinearity(model_GR9),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/collinearity_performance_growthrate_model_GR9_718.txt")




#718
capture.output(anova(model_GR9),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR9_718.txt")
write.csv(anova(model_GR9),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR9_718.csv")
write.csv(car::Anova(model_GR9),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR9_718.csv")
capture.output(Anova(model_GR9),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR9_718.txt")
capture.output(summary(model_GR9),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR9_718.txt")



tab_model(model_GR9,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR9_718.doc")

tab_model(model_GR9,show.df = TRUE,p.val = "kr",file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR9_718_df_pkr.doc")



install.packages("gtsummary")
remotes::install_github("ddsjoberg/gtsummary")
library("gtsummary")

tbl_summary(summary(model_GR9))

install.packages("qwraps2")
library(qwraps2)


tbl_regression(model_GR9)

summary_table(model_GR9, summary(model_GR9))

tab_model(model_GR9, model_AW29,model_MD6, model_MT4,show.df = TRUE,p.val = "kr" )
tab_model(model_GR9,show.df = TRUE,p.val = "kr" )


### test residuals - mostly ok
qqnorm(resid(model_GR9))
hist(resid(model_GR9))
plot(model_GR9)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR9_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR9)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR9_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR9))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR9_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR9))
dev.off()


## interaction means
(model_GR9.means <- interactionMeans(model_GR9))
plot(model_GR9.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR9_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR9.means <- interactionMeans(model_GR9))
plot(model_GR9.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR9_718.svg", width = 12, height = 6.5)
(model_GR9.means <- interactionMeans(model_GR9))
plot(model_GR9.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR9)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR9_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR9)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR9_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR9)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR9)


L.S_model_GR9_frog <- pairs(lsmeans(model_GR9, ~ Region | Competition_level))
test(L.S_model_GR9_frog, adjust = "tukey")

capture.output(test(L.S_model_GR9_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR9_frog_718.txt")
write.csv(test(L.S_model_GR9_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR9_frog_718.csv")


L.S_model_GR9_region <- pairs(lsmeans(model_GR9, ~ Competition_level | Region ))
test(L.S_model_GR9_region, adjust = "tukey")


capture.output(test(L.S_model_GR9_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR9_region_718.txt")
write.csv(test(L.S_model_GR9_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR9_region_718.csv")


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/pairs_model_GR9_718.png", width = 8, height = 6.5, units = 'in', res = 300)
pairs(log10_GR_final_days_mgDay~
        Region*Competition_level+ 
        scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
        scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
        Mortality_06_05_20_percapita+
        Days+
        Block_factor+
        Mean_averageTemp, data=Rawdata_experimentAugust2018)
dev.off()






model_GR6.1<-lmer(log10_GR_final_days_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR6.1)
car::Anova(model_GR6.1)

AIC(model_GR6.1) #  -695.8682
summary(model_GR6.1)











#### no low treatment ####


#order levels of factor
Rawdata_experimentAugust2018_nolow$Competition_level<- factor(Rawdata_experimentAugust2018_nolow$Competition_level, levels = c("High_control","FrogML","FrogHG"))
Rawdata_experimentAugust2018_nolow<- droplevels(Rawdata_experimentAugust2018_nolow)


#### model_GR6 ####
model_GR6<-lmer(log10_GR_final_days_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR6)
car::Anova(model_GR6)

AIC(model_GR6) #  -695.8682
summary(model_GR6)



#539
capture.output(anova(model_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR6_539.txt")
write.csv(anova(model_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR6_539.csv")
write.csv(Anova(model_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR6_539.csv")
capture.output(Anova(model_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR6_539.txt")
capture.output(summary(model_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR6_539.txt")


tab_model(model_GR6,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR6_539.doc")



### test residuals - mostly ok
qqnorm(resid(model_GR6))
hist(resid(model_GR6))
plot(model_GR6)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR6))
dev.off()


## interaction means
(model_GR6.means <- interactionMeans(model_GR6))
plot(model_GR6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR6.means <- interactionMeans(model_GR6))
plot(model_GR6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR6_539.svg", width = 12, height = 6.5)
(model_GR6.means <- interactionMeans(model_GR6))
plot(model_GR6.means)
dev.off()


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR6_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR6_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR6)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
#visreg(model_GR6)





L.S_model_GR6_frog <- pairs(lsmeans(model_GR6, ~ Region | Competition_level))
test(L.S_model_GR6_frog, adjust = "tukey")

capture.output(test(L.S_model_GR6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_frog_539.txt")
write.csv(test(L.S_model_GR6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_frog_539.csv")


L.S_model_GR6_region <- pairs(lsmeans(model_GR6, ~ Competition_level | Region ))
test(L.S_model_GR6_region, adjust = "tukey")


capture.output(test(L.S_model_GR6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_region_539.txt")
write.csv(test(L.S_model_GR6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_region_539.csv")

######## block as random
#### model_GR6 ####
model_GR6_r<-lmer(log10_GR_final_days_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  #Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor)+
                (1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR6_r)
car::Anova(model_GR6_r)

AIC(model_GR6_r) #  -695.8682
summary(model_GR6_r)



#539
capture.output(anova(model_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR6_r_539.txt")
write.csv(anova(model_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR6_r_539.csv")
write.csv(Anova(model_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR6_r_539.csv")
capture.output(Anova(model_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR6_r_539.txt")
capture.output(summary(model_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR6_r_539.txt")


tab_model(model_GR6_r,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR6_r_539.doc")



### test residuals - mostly ok
qqnorm(resid(model_GR6_r))
hist(resid(model_GR6_r))
plot(model_GR6_r)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR6_r)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR6_r))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR6_r))
dev.off()


## interaction means
(model_GR6_r.means <- interactionMeans(model_GR6_r))
plot(model_GR6_r.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR6_r.means <- interactionMeans(model_GR6_r))
plot(model_GR6_r.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR6_r_539.svg", width = 12, height = 6.5)
(model_GR6_r.means <- interactionMeans(model_GR6_r))
plot(model_GR6_r.means)
dev.off()


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR6_r_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR6_r)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR6_r_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR6_r)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
#visreg(model_GR6_r)





L.S_model_GR6_r_frog <- pairs(lsmeans(model_GR6_r, ~ Region | Competition_level))
test(L.S_model_GR6_r_frog, adjust = "tukey")

capture.output(test(L.S_model_GR6_r_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_r_frog_539.txt")
write.csv(test(L.S_model_GR6_r_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_r_frog_539.csv")


L.S_model_GR6_r_region <- pairs(lsmeans(model_GR6_r, ~ Competition_level | Region ))
test(L.S_model_GR6_r_region, adjust = "tukey")


capture.output(test(L.S_model_GR6_r_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_r_region_539.txt")
write.csv(test(L.S_model_GR6_r_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR6_r_region_539.csv")





#### no low treatment ####


#order levels of factor
#Rawdata_experimentAugust2018_nolow$Competition_level<- factor(Rawdata_experimentAugust2018_nolow$Competition_level, levels = c("High_control","FrogHG","FrogML"))
#Rawdata_experimentAugust2018_nolow<- droplevels(Rawdata_experimentAugust2018_nolow)

#Rawdata_experimentAugust2018_nolow$Region<- factor(Rawdata_experimentAugust2018_nolow$Competition_level, levels = c("High_control","FrogML","FrogHG"))
#Rawdata_experimentAugust2018_nolow<- droplevels(Rawdata_experimentAugust2018_nolow)


### order factors this way.... key!!!!!!!
Rawdata_experimentAugust2018_nolow$Competitior_Identity<- factor(Rawdata_experimentAugust2018_nolow$Competitior_Identity, levels = c("Toad_control","NRLF_HG","NRLF_ML"))
Rawdata_experimentAugust2018_nolow<- droplevels(Rawdata_experimentAugust2018_nolow)


Rawdata_experimentAugust2018_nolow$Toad_Cooccurrence_History<- factor(Rawdata_experimentAugust2018_nolow$Toad_Cooccurrence_History, levels = c("Long","Short"))
Rawdata_experimentAugust2018_nolow<- droplevels(Rawdata_experimentAugust2018_nolow)


summary(Rawdata_experimentAugust2018_nolow)


Rawdata_experimentAugust2018_nolow$Block<-as.factor(Rawdata_experimentAugust2018_nolow$Block)
Rawdata_experimentAugust2018_nolow$Population<-as.factor(Rawdata_experimentAugust2018_nolow$Population)
Rawdata_experimentAugust2018_nolow$Tank<-as.factor(Rawdata_experimentAugust2018_nolow$Tank)

### BEST 16_02_22
#### model_MJ_GR6 ####
model_MJ_GR6<-lmer(log10_GR_final_days_mgDay~
                     Toad_Cooccurrence_History*Competitior_Identity+ 
                     Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled+ 
                     Average_Individual_Toad_Tadpole_Starting_Weight_Scaled+
                     Toad_Mortality_per_Capita_Scaled+
                     Days_Since_Experiment_Began_Scaled+
                  Block+
                    Mean_Average_Water_Temperature_Scaled+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days_Since_Experiment_Began_Scaled|Tank)+
                  (1|Population), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_MJ_GR6)
car::Anova(model_MJ_GR6)

AIC(model_MJ_GR6) #  -695.8682
summary(model_MJ_GR6)



#539
capture.output(anova(model_MJ_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_MJ_GR6_539.txt")
write.csv(anova(model_MJ_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_MJ_GR6_539.csv")
write.csv(Anova(model_MJ_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_MJ_GR6_539.csv")
capture.output(Anova(model_MJ_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_MJ_GR6_539.txt")
capture.output(summary(model_MJ_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_MJ_GR6_539.txt")

capture.output(summary(model_MJ_GR6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_MJ_GR6_539.csv")


tab_model(model_MJ_GR6,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_MJ_GR6_539.doc")



### test residuals - mostly ok
qqnorm(resid(model_MJ_GR6))
hist(resid(model_MJ_GR6))
plot(model_MJ_GR6)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_MJ_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MJ_GR6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_MJ_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MJ_GR6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_MJ_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MJ_GR6))
dev.off()


## interaction means
(model_MJ_GR6.means <- interactionMeans(model_MJ_GR6))
plot(model_MJ_GR6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_MJ_GR6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MJ_GR6.means <- interactionMeans(model_MJ_GR6))
plot(model_MJ_GR6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_MJ_GR6_539.svg", width = 12, height = 6.5)
(model_MJ_GR6.means <- interactionMeans(model_MJ_GR6))
plot(model_MJ_GR6.means)
dev.off()


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_MJ_GR6_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_GR6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_MJ_GR6_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_GR6)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
#visreg(model_MJ_GR6)





L.S_model_MJ_GR6_frog <- pairs(lsmeans(model_MJ_GR6, ~ Toad_Cooccurrence_History | Competitior_Identity))
test(L.S_model_MJ_GR6_frog, adjust = "tukey")

capture.output(test(L.S_model_MJ_GR6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_frog_539.txt")
write.csv(test(L.S_model_MJ_GR6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_frog_539.csv")


L.S_model_MJ_GR6_region <- pairs(lsmeans(model_MJ_GR6, ~ Competitior_Identity | Toad_Cooccurrence_History ))
test(L.S_model_MJ_GR6_region, adjust = "tukey")


capture.output(test(L.S_model_MJ_GR6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_region_539.txt")
write.csv(test(L.S_model_MJ_GR6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_region_539.csv")




# block as random
#### model_MJ_GR6_r_r ####
model_MJ_GR6_r<-lmer(log10_GR_final_days_mgDay~
                     Toad_Cooccurrence_History*Competitior_Identity+ 
                     Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled+ 
                     Average_Individual_Toad_Tadpole_Starting_Weight_Scaled+
                     Toad_Mortality_per_Capita_Scaled+
                     Days_Since_Experiment_Began_Scaled+
                     #Block+
                     Mean_Average_Water_Temperature_Scaled+
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days_Since_Experiment_Began_Scaled|Tank)+
                     (1|Population)+ 
                   (1|Block), #random effects
                   data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_MJ_GR6_r)
car::Anova(model_MJ_GR6_r)

AIC(model_MJ_GR6_r) #  -695.8682
summary(model_MJ_GR6_r)



#539
capture.output(anova(model_MJ_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_MJ_GR6_r_539.txt")
write.csv(anova(model_MJ_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_MJ_GR6_r_539.csv")
write.csv(Anova(model_MJ_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_MJ_GR6_r_539.csv")
capture.output(Anova(model_MJ_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_MJ_GR6_r_539.txt")
capture.output(summary(model_MJ_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_MJ_GR6_r_539.txt")

capture.output(summary(model_MJ_GR6_r),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_MJ_GR6_r_539.csv")


tab_model(model_MJ_GR6_r,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_MJ_GR6_r_539.doc")



### test residuals - mostly ok
qqnorm(resid(model_MJ_GR6_r))
hist(resid(model_MJ_GR6_r))
plot(model_MJ_GR6_r)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_MJ_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MJ_GR6_r)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_MJ_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MJ_GR6_r))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_MJ_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MJ_GR6_r))
dev.off()


## interaction means
(model_MJ_GR6_r.means <- interactionMeans(model_MJ_GR6_r))
plot(model_MJ_GR6_r.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_MJ_GR6_r_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MJ_GR6_r.means <- interactionMeans(model_MJ_GR6_r))
plot(model_MJ_GR6_r.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_MJ_GR6_r_539.svg", width = 12, height = 6.5)
(model_MJ_GR6_r.means <- interactionMeans(model_MJ_GR6_r))
plot(model_MJ_GR6_r.means)
dev.off()


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_MJ_GR6_r_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_GR6_r)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_MJ_GR6_r_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_GR6_r)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
#visreg(model_MJ_GR6_r)





L.S_model_MJ_GR6_r_frog <- pairs(lsmeans(model_MJ_GR6_r, ~ Toad_Cooccurrence_History | Competitior_Identity))
test(L.S_model_MJ_GR6_r_frog, adjust = "tukey")

capture.output(test(L.S_model_MJ_GR6_r_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_r_frog_539.txt")
write.csv(test(L.S_model_MJ_GR6_r_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_r_frog_539.csv")


L.S_model_MJ_GR6_r_region <- pairs(lsmeans(model_MJ_GR6_r, ~ Competitior_Identity | Toad_Cooccurrence_History ))
test(L.S_model_MJ_GR6_r_region, adjust = "tukey")


capture.output(test(L.S_model_MJ_GR6_r_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_r_region_539.txt")
write.csv(test(L.S_model_MJ_GR6_r_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_MJ_GR6_r_region_539.csv")
















#### no low treatment ####
#### model_GR7 ####
model_GR7<-lmer(log10_GR_final_larvalperiod_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR7)
car::Anova(model_GR7)

AIC(model_GR7) #  -696.8633
summary(model_GR7)



#539
capture.output(anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR7_539.txt")
write.csv(anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR7_539.csv")
write.csv(Anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR7_539.csv")
capture.output(Anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR7_539.txt")
capture.output(summary(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR7_539.txt")


tab_model(model_GR7,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR7_539.doc")



### test residuals - mostly ok
qqnorm(resid(model_GR7))
hist(resid(model_GR7))
plot(model_GR7)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR7_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR7)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR7_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR7))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR7_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR7))
dev.off()


## interaction means
(model_GR7.means <- interactionMeans(model_GR7))
plot(model_GR7.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR7_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR7.means <- interactionMeans(model_GR7))
plot(model_GR7.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR7_539.svg", width = 12, height = 6.5)
(model_GR7.means <- interactionMeans(model_GR7))
plot(model_GR7.means)
dev.off()


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR7_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR7)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR7_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR7)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
#visreg(model_GR7)





L.S_model_GR7_frog <- pairs(lsmeans(model_GR7, ~ Region | Competition_level))
test(L.S_model_GR7_frog, adjust = "tukey")

capture.output(test(L.S_model_GR7_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_frog_539.txt")
write.csv(test(L.S_model_GR7_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_frog_539.csv")


L.S_model_GR7_region <- pairs(lsmeans(model_GR7, ~ Competition_level | Region ))
test(L.S_model_GR7_region, adjust = "tukey")


capture.output(test(L.S_model_GR7_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_region_539.txt")
write.csv(test(L.S_model_GR7_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_region_539.csv")




#### no low treatment ####
######## as three treatments ############
## interaction not significant ###
#### model_GR5 ####
model_GR5<-lmer(log10_GR_final_days_mgDay~
                  Region*Treatment_three+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR5)
car::Anova(model_GR5)

AIC(model_GR5) #  -695.3238
summary(model_GR5)



#539
capture.output(anova(model_GR5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR5_539.txt")
write.csv(anova(model_GR5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR5_539.csv")
write.csv(Anova(model_GR5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_growthrate_model_GR5_539.csv")
capture.output(Anova(model_GR5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_growthrate_model_GR5_539.txt")
capture.output(summary(model_GR5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR5_539.txt")



### test residuals - mostly ok
qqnorm(resid(model_GR5))
hist(resid(model_GR5))
plot(model_GR5)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR5_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR5)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR5_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR5))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR5_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR5))
dev.off()


## interaction means
(model_GR5.means <- interactionMeans(model_GR5))
plot(model_GR5.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR5_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR5.means <- interactionMeans(model_GR5))
plot(model_GR5.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR5_539.svg", width = 12, height = 6.5)
(model_GR5.means <- interactionMeans(model_GR5))
plot(model_GR5.means)
dev.off()


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR5_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR5)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR5_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR5)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
#visreg(model_GR5)











######## as three treatments ############
## interaction not significant ###
#### model_GR4 ####
model_GR4<-lmer(log10_GR_final_days_mgDay~
                  Region*Treatment_three+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR4)
Anova(model_GR4)

AIC(model_GR4) #    -893.4699
summary(model_GR4)



#718
capture.output(anova(model_GR4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR4_718.txt")
write.csv(anova(model_GR4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR4_718.csv")
write.csv(Anova(model_GR4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR4_718.csv")
capture.output(Anova(model_GR4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR4_718.txt")
capture.output(summary(model_GR4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR4_718.txt")



### test residuals - mostly ok
qqnorm(resid(model_GR4))
hist(resid(model_GR4))
plot(model_GR4)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR4)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR4))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR4))
dev.off()


## interaction means
(model_GR4.means <- interactionMeans(model_GR4))
plot(model_GR4.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR4.means <- interactionMeans(model_GR4))
plot(model_GR4.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR4_718.svg", width = 12, height = 6.5)
(model_GR4.means <- interactionMeans(model_GR4))
plot(model_GR4.means)
dev.off()

## visreg
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR4_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR4)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR4_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR4)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR4)












#### model_GR7 ####
model_GR7<-lmer(log10_GR_final_larvalperiod_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_06_05_20_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR7)
car::Anova(model_GR7)
AIC(model_GR7) #   -899.2562
summary(model_GR7)



#718
capture.output(anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR7_718.txt")
write.csv(anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR7_718.csv")
write.csv(car::Anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR7_718.csv")
capture.output(Anova(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Anova_chisq_growthrate_model_GR7_718.txt")
capture.output(summary(model_GR7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR7_718.txt")


tab_model(model_GR7,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_tab_growthrate_model_GR7_718.doc")



### test residuals - mostly ok
qqnorm(resid(model_GR7))
hist(resid(model_GR7))
plot(model_GR7)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR7_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR7)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR7_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR7))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR7_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR7))
dev.off()


## interaction means
(model_GR7.means <- interactionMeans(model_GR7))
plot(model_GR7.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR7_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR7.means <- interactionMeans(model_GR7))
plot(model_GR7.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR7_718.svg", width = 12, height = 6.5)
(model_GR7.means <- interactionMeans(model_GR7))
plot(model_GR7.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR7)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR7_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR7)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR7_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR7)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR7)


L.S_model_GR7_frog <- pairs(lsmeans(model_GR7, ~ Region | Competition_level))
test(L.S_model_GR7_frog, adjust = "tukey")

capture.output(test(L.S_model_GR7_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_frog_718.txt")
write.csv(test(L.S_model_GR7_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_frog_718.csv")


L.S_model_GR7_region <- pairs(lsmeans(model_GR7, ~ Competition_level | Region ))
test(L.S_model_GR7_region, adjust = "tukey")


capture.output(test(L.S_model_GR7_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_region_718.txt")
write.csv(test(L.S_model_GR7_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/L.S_model_GR7_region_718.csv")


















####### model_GR1.4 ###########
model_GR1.4<-lmer(log_GR_final_days_mgDay~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    Days+
                    Block_factor+
                    Mean_averageTemp+
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR1.4)
AIC(model_GR1.4) #    -149.7174
summary(model_GR1.4)



#718
capture.output(anova(model_GR1.4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR1.4_718.txt")
write.csv(anova(model_GR1.4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR1.4_718.csv")
capture.output(summary(model_GR1.4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR1.4_718.txt")



### test residuals - mostly ok
qqnorm(resid(model_GR1.4))
hist(resid(model_GR1.4))
plot(model_GR1.4)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR1.4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR1.4)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR1.4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR1.4))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR1.4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR1.4))
dev.off()


## interaction means
(model_GR1.4.means <- interactionMeans(model_GR1.4))
plot(model_GR1.4.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR1.4_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR1.4.means <- interactionMeans(model_GR1.4))
plot(model_GR1.4.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR1.4_718.svg", width = 12, height = 6.5)
(model_GR1.4.means <- interactionMeans(model_GR1.4))
plot(model_GR1.4.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR1.4)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR1.4_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR1.4)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR1.4_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR1.4)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR1.4)

#has labels, but does ploits one at a time
visreg(model_GR1.4, gg = T) 





###### Mortality_tadsadded_26_06_21_percapita
model_GR2<-lmer(log_GR_final_days_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR2)
AIC(model_GR2) #     -145.6906
summary(model_GR2)



#718
capture.output(anova(model_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR2_718.txt")
write.csv(anova(model_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR2_718.csv")
capture.output(summary(model_GR2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR2_718.txt")



### test residuals - mostly ok
qqnorm(resid(model_GR2))
hist(resid(model_GR2))
plot(model_GR2)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualsplot_model_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_GR2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Residualshist_model_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_GR2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/QQnorm_model_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_GR2))
dev.off()


## interaction means
(model_GR2.means <- interactionMeans(model_GR2))
plot(model_GR2.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR2.means <- interactionMeans(model_GR2))
plot(model_GR2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR2_718.svg", width = 12, height = 6.5)
(model_GR2.means <- interactionMeans(model_GR2))
plot(model_GR2.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR2)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR2_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR2_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR2)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR2)

#has labels, but does ploits one at a time
#visreg(model_GR2, gg = T) 








### dif mortality
model_GR1.1<-lmer(log_GR_final_days_mgDay~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    Block_factor+
                    Mean_averageTemp+
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018_718,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR1.1)
AIC(model_GR1.1) #   -192.7454 #-145.6906 (718)
summary(model_GR1.1)


#715
capture.output(anova(model_GR1.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR1.1_715.txt")
capture.output(summary(model_GR1.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR1.1_715.txt")

#718
capture.output(anova(model_GR1.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_growthrate_model_GR1.1_718.txt")
capture.output(summary(model_GR1.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/summary_growthrate_model_GR1.1_718.txt")

### test residuals - mostly ok
qqnorm(resid(model_GR1.1))
hist(resid(model_GR1.1))
plot(model_GR1.1)


## interaction means
(model_GR1.1.means <- interactionMeans(model_GR1.1))
plot(model_GR1.1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR1.1_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_GR1.1.means <- interactionMeans(model_GR1.1))
plot(model_GR1.1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/interactionMeans_model_GR1.1_718.svg", width = 12, height = 6.5)
(model_GR1.1.means <- interactionMeans(model_GR1.1))
plot(model_GR1.1.means)
dev.off()



### visreg - shows all plots
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR1.1)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR1.1_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR1.1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/visreg_model_GR1.1_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_GR1.1)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
visreg(model_GR1.1)

#has labels, but does ploits one at a time
visreg(model_GR1.1, gg = T) 




# no log
model_GR1<-lmer(GR_final_days_mgDay~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Block_factor+
                  Mean_averageTemp+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR1)
AIC(model_GR1) #   238.6083
summary(model_GR1)

### test residuals - mostly ok
qqnorm(resid(model_GR1))
hist(resid(model_GR1))
plot(model_GR1)

### scaled_Mortality_06_05_20_percapita (no tads added) scaled_Mean_averageTemp
model_GR1.2<-lmer(log_GR_final_days_mgDay~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_06_05_20_percapita+
                    Days+
                    Block_factor+
                    scaled_Mean_averageTemp+
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR1.2)
AIC(model_GR1.2) #   -196.4414
summary(model_GR1.2)

### test residuals - mostly ok
qqnorm(resid(model_GR1.2))
hist(resid(model_GR1.2))
plot(model_GR1.2)


#Count_toads_left_b4weigh and no Days fixed
model_GR1.3<-lmer(log_GR_final_days_mgDay~
                    Region*Competition_level+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Count_toads_left_b4weigh+
                    # Days+
                    Block_factor+
                    scaled_Mean_averageTemp+
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR1.3)
AIC(model_GR1.3) #   -177.2915
summary(model_GR1.3)

### test residuals - mostly ok
qqnorm(resid(model_GR1.1))
hist(resid(model_GR1.1))
plot(model_GR1.1)

(model_GR1.3.means <- interactionMeans(model_GR1.3))

plot(model_GR1.3.means)





#18.01.22

## warning rescale so had to take out rotaly and tadpole top up
model_F19<-lmer(GR_finalmin_intial_degreedays_mgDD~
                  Region*Competition_level+ 
                  #scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #scaled_Mortality_tadsadded_26_06_21_percapita+
                  #Days+
                  #Block_factor+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor)+ 
                  (1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F19)
AIC(model_F19) #  -1884.949
summary(model_F19)



model_F20<-lmer(GR_finalmin_intial_degreedays_mgDD~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  #Days+
                  #Block_factor+
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F20)
AIC(model_F20) #   -1897.136
summary(model_F20)


model_F21<-lmer(GR_finalmin_intial_degreedays_mgDD~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  #Days+
                  Block_factor+
                  
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F21)
AIC(model_F21) #   -1826.991
summary(model_F21)

### best 18.01.22
model_F21.1<-lmer(GR_finalmin_intial_degreedays_mgDD~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    Block_factor+
                    
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F21.1)
AIC(model_F21.1) #   -1902.36
summary(model_F21.1)




model_F21.1.1<-lmer(log(GR_finalmin_intial_degreedays_mgDD)~
                      Region*Competition_level+ 
                      scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                      scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                      scaled_Mortality_tadsadded_26_06_21_percapita+
                      Days+
                      Block_factor+
                      
                      #(1|Daysfactor/Tank_factor)+
                      (1+Days|Tank_factor)+
                      (1|Population_factor), 
                    #(1|Block_factor), #random effects
                    data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F21.1.1)
AIC(model_F21.1.1) #   -1902.36
summary(model_F21.1.1)

# error
model_F22.1<-lmer(GR_finalmin_intial_degreedays_mgDD~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    scaled_Total_chla_conc_26.7.18_ug.l+
                    Block_factor+
                    
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F22.1)
AIC(model_F22.1) #  -1903.838
summary(model_F22.1)



model_F22<-lmer(GR_finalmin_intial_degreedays_mgDD~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  #Days+
                  scaled_Total_chla_conc_26.7.18_ug.l+
                  Block_factor+
                  
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor), 
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F22)
AIC(model_F22) #  -1904.891
summary(model_F22)

### check if total algae conc and temp are correlated
plot(Rawdata_experimentAugust2018$Mean_averageTemp,Rawdata_experimentAugust2018$Total_chla_conc_26.7.18_ug.l)

# they are --- means can't have algae and temp in weight model.. which one?




### warning
model_F13.1.2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                      Region*Competition_level+ 
                      scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                      scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                      scaled_Mortality_06_05_20_percapita+
                      Days+
                      #Block_factor+
                      (1|Tank_factor)+
                      (1|Population_factor)+ 
                      (1|Tank_factor:Block_factor), #random effects
                    data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F13.1.2)
AIC(model_F13.1.2) #   -1733.323
summary(model_F13.1.2)

## no warning whne using 718, but warnign when using 715
model_F13.1.2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                      Region*Competition_level+ 
                      scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                      scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                      scaled_Mortality_tadsadded_26_06_21_percapita+
                      Days+
                      Block_factor+
                      #(1|Tank_factor)+
                      (1|Population_factor)+ 
                      (1|Tank_factor/Block_factor), #random effects
                    data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F13.1.2)
AIC(model_F13.1.2) #   -1801.191
summary(model_F13.1.2)


Rawdata_experimentAugust2018$Days_num<-as.numeric(Rawdata_experimentAugust2018$Days)

str(Rawdata_experimentAugust2018$Days_num)




model_F13.1.4<-lmer(GR_finalmin_intial_degreedays_mgDD~
                      Region*Competition_level+ 
                      scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                      scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                      scaled_Mortality_tadsadded_26_06_21_percapita+
                      Days_num+
                      Block_factor+
                      #(1|Tank_factor)+
                      (1|Population_factor)+ 
                      (1|Tank_factor/Block_factor), #random effects
                    data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F13.1.4)
AIC(model_F13.1.4) #   -1801.191
summary(model_F13.1.4)

###### 17_01_22



# removed block as random effect b/c only has 3 levels ---> changed to fixed effect
#https://dynamicecology.wordpress.com/2015/11/04/is-it-a-fixed-or-random-effect/



### four treatments
model_F<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    Block_factor+
    (1|Population_factor)+ 
    (1|Tank_factor)+
    (1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F)
summary(model_F)
AIC(model_F) #


### four treatments - no start weight tadpoles
model_F1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    Block_factor+
    (1|Population_factor)+ 
    (1|Tank_factor)+
    (1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1)
summary(model_F1)
AIC(model_F1) #

### four treatments - no block factor as block not significant
### lowest AIC score out of model F - F1.3
model_F1.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    #Block_factor+
    (1|Population_factor)+ 
    (1|Tank_factor)+
    (1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.1)
summary(model_F1.1)
AIC(model_F1.1) #

## added Days (continous) as fixed effect
model_F1.4<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    #Block_factor+
    Days+
    (1|Population_factor)+ 
    (1|Tank_factor)+
    (1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.4)
summary(model_F1.4)
AIC(model_F1.4) #


## added Days (continous) as fixed effect and removed days random
model_F1.4.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    #Block_factor+
    Days+
    (1|Population_factor)+ 
    (1|Tank_factor),
  #(1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.4.1)
summary(model_F1.4.1)
AIC(model_F1.4.1) #-1716.157


### four treatments - no block factor + replace tad top up and mortality with density
model_F1.2<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #X25.5.18_experiment_start_tapole_av_individual_weight+
    #Mortality_tadsadded_26_06_21_percapita+
    #Block_factor+
    Density_tadsadded_minus_mortality_percapita+
    (1|Population_factor)+ 
    (1|Tank_factor)+
    (1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.2)
summary(model_F1.2)
AIC(model_F1.2) #


### four treatments - no block factor + replace tad top up and mortality with density
model_F1.3<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    X25.5.18_experiment_start_tapole_av_individual_weight+
    #Mortality_tadsadded_26_06_21_percapita+
    #Block_factor+
    Density_tadsadded_minus_mortality_percapita+
    (1|Population_factor)+ 
    (1|Tank_factor)+
    (1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.3)
summary(model_F1.3)
AIC(model_F1.3) #



### four treatments - no block factor + replace tad top up and mortality with density + added days as factor, fixed effect
model_F1.5<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    X25.5.18_experiment_start_tapole_av_individual_weight+
    #Mortality_tadsadded_26_06_21_percapita+
    #Block_factor+
    Density_tadsadded_minus_mortality_percapita+
    Daysfactor+
    (1|Population_factor)+ 
    (1|Tank_factor),
  #(1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.5)
summary(model_F1.5)
AIC(model_F1.5) #-1680.242


### four treatments - no block factor + replace tad top up and mortality with density + added days as continuous, fixed effect
model_F1.6<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region_factor*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Mortality_tadsadded_26_06_21_percapita+
    #Block_factor+
    Density_tadsadded_minus_mortality_percapita+
    Days+
    (1|Population_factor)+ 
    (1|Tank_factor),
  #(1|Daysfactor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.6)
summary(model_F1.6)
AIC(model_F1.6) #-1713.79

(model_F1.6.means <- interactionMeans(model_F1.6))

plot(model_F1.6.means)


#https://towardsdatascience.com/when-mixed-effects-hierarchical-models-fail-pooling-and-uncertainty-77e667823ae8
#https://stats.stackexchange.com/questions/58745/using-lmer-for-repeated-measures-linear-mixed-effect-model

###  repeated measures, must have days as fixed effect, and also as random effect w
model_F1.7<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    Days+
    Block_factor+
    (1|Population_factor)+ 
    (1+Days|Tank_factor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.7)
AIC(model_F1.7) #-1741.078


model_F1.7.2<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    Days+
    Block_factor+
    (1|Population_factor)+ 
    (1|Tank_factor)+
    (1|Days), #random effects - tank nested within days
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.7.2)
AIC(model_F1.7.2) #-1649.106


(model_F1.7.2.means <- interactionMeans(model_F1.7.2))

plot(model_F1.7.2.means)



model_F1.7.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita+
    Days+
    #Block_factor+
    (1|Population_factor)+ 
    (1+Days|Tank_factor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.7.1)
AIC(model_F1.7.1) #-1756.204

model_F1.8<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Mortality_tadsadded_26_06_21_percapita+
    Days+
    (1|Population_factor)+ 
    (1+Days|Tank_factor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.8)
AIC(model_F1.8) #-1756.204



model_F1.9<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    scaled_Mortality_tadsadded_26_06_21_percapita+
    Days+
    Block_factor+
    (1|Region/Population_factor)+ 
    (1|Tank_factor)+
    (1|Days), #random effects - tank nested within days
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.9)
AIC(model_F1.9) #-1691.269

model_F1.9.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    scaled_Mortality_tadsadded_26_06_21_percapita+
    #Days+
    (1|Block_factor)+
    (1|Region/Population_factor)+ 
    # (1|Tank_factor)+
    (1|Days), #random effects - tank nested within days
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.9.1)
AIC(model_F1.9.1) #-1663.037


model_F1.10<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    scaled_Mortality_tadsadded_26_06_21_percapita+
    Days+
    Block_factor+
    (1|Region/Population_factor)+ 
    (1+Days|Tank_factor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.10)
AIC(model_F1.10) # -1743.023

model_F1.10.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    scaled_Mortality_tadsadded_26_06_21_percapita+
    (1|Block_factor)+
    (1|Region/Population_factor)+ 
    (1+Days|Tank_factor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.10.1)
AIC(model_F1.10.1) # -1774.046


model_F1.10.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    # scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #scaled_Mortality_tadsadded_26_06_21_percapita+
    scaled_Density_tadsadded_minus_mortality_percapita+
    (1|Block_factor)+
    (1|Region/Population_factor)+ 
    (1+Days|Tank_factor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.10.1)
AIC(model_F1.10.1) # -1774.046

model_F1.10.2<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    # scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #scaled_Mortality_tadsadded_26_06_21_percapita+
    scaled_Density_tadsadded_minus_mortality_percapita+
    (1|Block_factor)+
    (1|Region/Population_factor)+ 
    (1|Days),
  #(1|Tank_factor), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F1.10.2)
AIC(model_F1.10.2) # -1774.046


model_F2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+
                 scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                 (1|Population)+ 
                 Competition_level:(1|Population)+
                 (1|Tank),
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F2)


model_F2.1<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Days+
                   (1|Population)+ 
                   Competition_level:(1|Population)+
                   (1|Tank),
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F2.1)


model_F2.2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Days+
                   (1|Population)+ 
                   Competition_level:(1|Population)+
                   (1+Days|Tank), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F2.2)



####CHOSEN
#same as RGRmodelfeb14th2_1 but removed (1|pop)*comp interaction because doesn't run with emmeans
model_F3<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ #scaled
                 X25.5.18_experiment_start_tapole_av_individual_weight+ #fixed effects
                 (1|Population)+
                 (1|Tank), #random effects
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F3)

#same as RGRmodelfeb25th except added (1+Days|Tank) - like Frank said
#days as integer - days as a factor doesn't work
model_F4<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ #scaled
                 X25.5.18_experiment_start_tapole_av_individual_weight+ #fixed effects
                 (1|Population)+
                 (1+Days|Tank), #random effects
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F4)

## franks model except I have mortality as well and REML = TRUE
model_F5<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                 scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                 scaled_Mortality_tadsadded_26_06_21_percapita+
                 Days+
                 (1|Block_factor)+
                 (1|Population_factor)+ 
                 #(1 | Region:Population)+
                 (1+Days|Tank_factor), #random effects
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F5)




model_F5.1<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   (1|Block_factor)+
                   (1|Population_factor)+ 
                   (1+Days|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F5.1)


#### BEST MODEL 17.01.22
## franks model except USED density AT TIME OF WEIGHING
model_F5.2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Density_tadsadded_minus_mortality_percapita+
                   Days+
                   (1|Block_factor)+
                   (1|Population_factor)+ 
                   # (1 | Region:Population)+
                   (1+Days|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F5.2)
AIC(model_F5.2) #-1898.081



model_F5.3<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Density_tadsadded_minus_mortality_percapita+
                   Days+
                   (1|Block_factor)+
                   (1|Population_factor)+ 
                   (1 | Region:Population)+
                   (1+Days|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F5.3)
AIC(model_F5.3) #-1896.081

### plot density
## facetwrap
plot(Rawdata_experimentAugust2018$Days_cont,Rawdata_experimentAugust2018$Density_tadsadded_minus_mortality)

sp <- ggplot(Rawdata_experimentAugust2018, aes(x=Days_cont, y=Density_tadsadded_minus_mortality_percapita)) + geom_point(shape=1)
sp<- sp + stat_summary(aes(group=Competition_level), fun=mean, geom="line", colour="red")
sp + facet_grid(Competition_level ~ .)

str(Rawdata_experimentAugust2018$Days)

Rawdata_experimentAugust2018$Days_cont<-as.numeric(Rawdata_experimentAugust2018$Days)

### BEST 17_01_22
#### Alba model
model_F6<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                 scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                 Mortality_tadsadded_26_06_21_percapita+
                 Days+
                 (1|Block_factor/Tank_factor)+
                 (1|Population_factor)+ 
                 (1+Days|Tank_factor), #random effects
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6)
AIC(model_F6) #-1895.078

"Type III Analysis of Variance Table with Satterthwaite's method
                                                                Sum Sq   Mean Sq NumDF  DenDF F value    Pr(>F)    
Region                                                       0.0080716 0.0080716     1  8.965 19.6986 0.0016431 ** 
Competition_level                                            0.0244203 0.0081401     3 45.199 19.8657 2.329e-08 ***
scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita  0.0004783 0.0004783     1 51.872  1.1673 0.2849479    
scaled_X25.5.18_experiment_start_tapole_av_individual_weight 0.0001786 0.0001786     1  8.798  0.4359 0.5260273    
Mortality_tadsadded_26_06_21_percapita                       0.0071196 0.0071196     1 56.587 17.3751 0.0001063 ***
Days                                                         0.0003773 0.0003773     1 42.919  0.9208 0.3426406    
Region:Competition_level                                     0.0048716 0.0016239     3 45.023  3.9630 0.0136877 *  
---
Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1"

### test residuals - mostly ok
qqnorm(resid(model_F6))
hist(resid(model_F6))
plot(model_F6)

#### added block as fixed as well
model_F6.3<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Block_factor+
                   (1|Block_factor/Tank_factor)+
                   (1|Population_factor)+ 
                   (1+Days|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6.3)
AIC(model_F6.3) 


#### added block as fixed as well  (1+Block_factor|Tank_factor)+
model_F6.3.1<-lmer(GR_finalmin_intial_degreedays_mgDD~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Block_factor+
                     (1+Block_factor|Tank_factor)+
                     (1|Population_factor)+ 
                     (1+Days|Tank_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6.3.1)
AIC(model_F6.3.1) 


#### Alba model (1+Block_factor|Tank_factor) vs   (1|Block_factor/Tank_factor)
model_F6.2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   (1+Block_factor|Tank_factor)+
                   (1|Population_factor)+ 
                   (1+Days|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6.2)
AIC(model_F6.2) 

### test residuals - mostly ok
qqnorm(resid(model_F6.2))
hist(resid(model_F6.2))
plot(model_F6.2)


#### Alba model 
model_F6.2.1<-lmer(GR_finalmin_intial_degreedays_mgDD~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Block_factor+
                     (1|Population_factor)+ 
                     (1+Days|Tank_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6.2.1)
AIC(model_F6.2.1) 

### test residuals - mostly ok
qqnorm(resid(model_F6.2.1))
hist(resid(model_F6.2.1))
plot(model_F6.2.1)


#### Alba model Total_chla_conc_26.7.18_ug.l+
model_F6.2.2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     #Mortality_tadsadded_26_06_21_percapita+
                     Total_chla_conc_26.7.18_ug.l+
                     Days+
                     Block_factor+
                     (1+Block_factor|Tank_factor)+
                     (1|Population_factor)+ 
                     (1+Days|Tank_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6.2.2)
AIC(model_F6.2.2) 





### days only random. REML=true
model_F6.1<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   #Days+
                   (1|Block_factor/Tank_factor)+
                   (1|Population_factor)+ 
                   (1+Days|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6.1)
AIC(model_F6.1) #-1806.072 <--- worse, so should include Days as fixed


### warning message Warning message:
#Model failed to converge with 1 negative eigenvalue: -1.0e-01 
# model_F6 but  (1|Region/Population_factor)+  and scaled mortality
model_F6.2<-lmer(GR_finalmin_intial_degreedays_mgDD~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   (1|Block_factor/Tank_factor)+
                   (1|Region/Population_factor)+ 
                   (1+Days|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F6.2)
AIC(model_F6.2) #-1893.078


#### Alba model -except density instead of mortality and tadpole top ups
model_F7<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                 Density_tadsadded_minus_mortality_percapita+
                 Days+
                 (1|Block_factor/Tank_factor)+
                 (1|Population_factor)+ 
                 (1+Days|Tank_factor), #random effects
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F7)
AIC(model_F7) #-1896.081




#### Alba model - except Count_toads_left_b4weigh
model_F8<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 scaled_Count_toads_left_b4weigh+                
                 scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                 Days+
                 (1|Block_factor/Tank_factor)+
                 (1|Population_factor)+ 
                 (1+Days|Tank_factor), #random effects
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F8)
AIC(model_F8) #-1885.65

"Type III Analysis of Variance Table with Satterthwaite's method
                                                                Sum Sq   Mean Sq NumDF  DenDF F value    Pr(>F)    
Region                                                       0.0057701 0.0057701     1  8.712 13.8228 0.0050669 ** 
Competition_level                                            0.0101876 0.0033959     3 46.677  8.1351 0.0001838 ***
scaled_Count_toads_left_b4weigh                              0.0028736 0.0028736     1 79.888  6.8838 0.0104158 *  
scaled_X25.5.18_experiment_start_tapole_av_individual_weight 0.0002913 0.0002913     1  9.081  0.6979 0.4249129    
Days                                                         0.0016666 0.0016666     1 50.272  3.9925 0.0511281 .  
Region:Competition_level                                     0.0039088 0.0013029     3 41.306  3.1213 0.0360883 *  
---
Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1"

### test residuals - mostly ok
qqnorm(resid(model_F8))
hist(resid(model_F8))
plot(model_F8)




model_F9<-lmer(GR_finalmin_intial_degreedays_mgDD~
                 Region*Competition_level+ 
                 Count_toads_left_b4weigh*Days+                
                 scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                 Days+
                 (1|Block_factor/Tank_factor)+
                 (1|Population_factor)+ 
                 (1+Days|Tank_factor), #random effects
               data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_F9)




#################################################
### 16 07 2021

### four treatments
model_1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita*Competition_level+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_1)
summary(model_1)
AIC(model_1) #


model_1.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita*Competition_level+
    (1|Population)+ 
    (Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_1.1)
summary(model_1)
AIC(model_1) #



model_1.2<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mortality_tadsadded_26_06_21_percapita*Competition_level+
    Days+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_1.2)
summary(model_1.2)
AIC(model_1.2) #




## three treatments
model_2<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Treatment_three+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    scaled_Mortality_tadsadded_26_06_21_percapita*Treatment_three+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_2)
summary(model_2)
AIC(model_2) #


####### 26/06/21
######### three treatments + days + mortality
model1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Treatment_three+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_tadsadded_26_06_21_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model1)
summary(model1)
AIC(model1) #

######### three treatments + days + mortality*treatment three

model2<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Treatment_three+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_tadsadded_26_06_21_percapita*Treatment_three+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model2)
summary(model2)
AIC(model2) #

######### Q should I do mortality per capita or not? Should I do density per capita or not? 






############## three treatments + days + density
model3<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Treatment_three+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Density_tadsadded_minus_mortality_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model3)
summary(model3)
AIC(model3) #

############## three treatments + days + density*threatmentthree
model4<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Treatment_three+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Density_tadsadded_minus_mortality_percapita*Treatment_three+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model4)
summary(model4)
AIC(model4) #


### four comp treatments + days + mortliaty + tads top up
model5<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model5)
summary(model5)
AIC(model5) #

#residuals + normality
qqPlot(resid(model5))
plot(model5)
qqPlot(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)




### four comp treatments +  mortliaty + tads top up

model5.1<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model5.1)
summary(model5.1)
AIC(model5.1) #


### four comp treatments + days + mortliaty + tads top up -- no block
model5b<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model5b)
summary(model5b)
AIC(model5b) #





### four comp treatments + mortliaty + tads
model6<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model6)
summary(model6)
AIC(model6) #

### four comp treatments + days + mortliaty*comp + tads top up
model7<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_06_05_20_percapita*Competition_level+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model7)
summary(model7)
AIC(model7) #



### four comp treatments + days + mortliatytads
model8<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_tadsadded_26_06_21_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model8)
summary(model8)
AIC(model8) #


### four comp treatments + mortliatytads
model9<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Days+
    Mortality_tadsadded_26_06_21_percapita+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model9)
summary(model9)
AIC(model9) #

### four comp treatments + mortliatytads*comp
model10<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Days+
    Mortality_tadsadded_26_06_21_percapita*Competition_level+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model10)
summary(model10)
AIC(model10) #




### four comp treatments + days + density +tads

model11<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Density_minus_mortality_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model11)
summary(model11)
AIC(model11) #


### four comp treatments + days + density +tads ---no block

model11b<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Density_minus_mortality_percapita+
    (1|Population)+ 
    (1+Days|Tank), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model11b)
summary(model11b)
AIC(model11b) #



### four comp treatments + density per tads

model12<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Days+
    Density_tadsadded_minus_mortality_percapita+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model12)
summary(model12)
AIC(model12) #




### four comp treatments  +density per tads + days
model13<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Density_tadsadded_minus_mortality_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model13)
summary(model13)
AIC(model13) #

(model13.means <- interactionMeans(model13))

plot(model13.means)

### four comp treatments + days +density per tads
model14<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Density_tadsadded_minus_mortality_percapita*Competition_level+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model14)
summary(model14)
AIC(model14) #



### four comp treatments + density per tads*comp

model15<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    #Days+
    Density_tadsadded_minus_mortality_percapita*Competition_level+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model15)
summary(model15)
AIC(model15) #




### four comp treatments + density +tads

model16<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    # Days+
    Density_minus_mortality_percapita+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model16)
summary(model16)
AIC(model16) #




##############################   before 26/06/21 ####################
### added block! 

######### add mortality
model_arcsin_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality<-lmer(
  arcsin_GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_arcsin_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)
summary(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)
AIC(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality) #
#visreg(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)

"Type III Analysis of Variance Table with Satterthwaite's method
                                                               Sum Sq   Mean Sq NumDF  DenDF F value    Pr(>F)    
Region                                                       0.013179 0.0131794     1  6.124 11.4663   0.01429 *  
Competition_level                                            0.052760 0.0175866     3 41.572 15.3006 7.452e-07 ***
toadTadpoles_added_as_top.up_june7thand8th_percapita         0.002097 0.0020972     1 48.157  1.8246   0.18308    
scaled_X25.5.18_experiment_start_tapole_av_individual_weight 0.000748 0.0007477     1  7.996  0.6505   0.44326    
Days                                                         0.000855 0.0008549     1 42.316  0.7438   0.39331    
Mortality_06_05_20_percapita                                 0.024972 0.0249718     1 55.751 21.7259 2.002e-05 ***
Region:Competition_level                                     0.013544 0.0045146     3 40.996  3.9277   0.01490 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"

#confidence intervals
confint(model_arcsin_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality, method="Wald")


######### add mortality - no transformation
model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)
summary(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)
AIC(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality) #-1799.164
#visreg(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)

"Type III Analysis of Variance Table with Satterthwaite's method
                                                                Sum Sq   Mean Sq NumDF  DenDF F value    Pr(>F)    
Region                                                       0.0052965 0.0052965     1  6.052 12.8542   0.01140 *  
Competition_level                                            0.0196883 0.0065628     3 35.400 15.9273 1.015e-06 ***
toadTadpoles_added_as_top.up_june7thand8th_percapita         0.0004837 0.0004837     1 40.151  1.1739   0.28506    
scaled_X25.5.18_experiment_start_tapole_av_individual_weight 0.0001084 0.0001084     1  7.533  0.2631   0.62270    
Days                                                         0.0002399 0.0002399     1 38.786  0.5822   0.45006    
Mortality_06_05_20_percapita                                 0.0095681 0.0095681     1 45.608 23.2210 1.636e-05 ***
Region:Competition_level                                     0.0051825 0.0017275     3 34.992  4.1925   0.01232 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"


#use REML=TRUE for the custom contrasts and for reporting F stats

#write.csv(anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/anova_model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_011220.csv")


#capture.output(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_011220.txt")

#residuals
GR_resid<-resid(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)


plot(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD, GR_resid, 
     ylab="Residuals", xlab="GR_finalmin_intial_degreedays_mgDD")
abline(0, 0)                  # the horizon

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/residuals_model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality.png", width = 6.5, height = 6.5, units = 'in', res = 300)
plot(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD, GR_resid, 
     ylab="Residuals", xlab="GR_finalmin_intial_degreedays_mgDD")
abline(0, 0)                  # the horizon
dev.off()



###  residuals model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality
## mostly normally distributed
## NB response doesn't have to be normally distributed, only residuals 
#https://stats.stackexchange.com/questions/217774/normal-distribution-necessary-for-linear-mixed-effects-r

plot(fitted(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality), resid(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality), col = "dodgerblue",
     pch = 20, cex = 1.5, xlab = "Fitted", ylab = "Residuals")

qqnorm(resid(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality))
hist(resid(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality))




###  residuals model_arcsin_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality
plot(fitted(model_arcsin_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality), resid(model_arcsin_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality), col = "dodgerblue",
     pch = 20, cex = 1.5, xlab = "Fitted", ylab = "Residuals")






########### tads peercent - same
######### add mortality
model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_percent<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_percap)
summary(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)

#capture.output(anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality),file="anova_model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_291120.txt")


#capture.output(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality,file="model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_291120.txt")

########## no mortality
#model_GR_toads_FinalmInitial_degreeDays.Frank.3<-lmer(
# GR_finalmin_intial_degreedays_mgDD~
#  Region*Competition_level+ 
# toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
#scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
#Days+
#(1|Population)+ 
#(1+Days|Tank), #random effects
#data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

#anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3)
#AIC(model_GR_toads_FinalmInitial_degreeDays.Frank.3) #-1784.212
#summary(model_GR_toads_FinalmInitial_degreeDays.Frank.3)

#model_GR_toads_FinalmInitial_degreeDays.Frank.3
#capture.output(anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3),file="anova_model_GR_toads_FinalmInitial_degreeDays.Frank.3_REMLFALSE.txt")
#capture.output(model_GR_toads_FinalmInitial_degreeDays.Frank.3,file="model_GR_toads_FinalmInitial_degreeDays.Frank.3_REMLisFALSE.txt")

#use REML=TRUE for the custom contrasts and for reporting F stats
#capture.output(anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3),file="anova_model_GR_toads_FinalmInitial_degreeDays.Frank.3_REMLisTRUE.txt")
#capture.output(model_GR_toads_FinalmInitial_degreeDays.Frank.3,file="model_GR_toads_FinalmInitial_degreeDays.Frank.3_REMLisTRUE.txt")





########### JEN NO DAYS ##########
######### add mortality - no transformation
## 714 also removes 0.5 in growth rate
#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Rawdataexperiment_August_2018.csv",header=T,row.names=NULL,sep=",")



model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_NODAYS<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita*Competition_level+ 
    Mortality_06_05_20_percapita*Competition_level+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_NODAYS)
summary(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)
AIC(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)

"Type III Analysis of Variance Table with Satterthwaite's method
                                                  Sum Sq
Region                                         0.0146729
Competition_level                              0.0109033
Mortality_06_05_20_percapita                   0.0141397
Region:Competition_level                       0.0010291
Competition_level:Mortality_06_05_20_percapita 0.0041057
                                                 Mean Sq
Region                                         0.0146729
Competition_level                              0.0036344
Mortality_06_05_20_percapita                   0.0141397
Region:Competition_level                       0.0003430
Competition_level:Mortality_06_05_20_percapita 0.0013686
                                               NumDF
Region                                             1
Competition_level                                  3
Mortality_06_05_20_percapita                       1
Region:Competition_level                           3
Competition_level:Mortality_06_05_20_percapita     3
                                                DenDF
Region                                          6.068
Competition_level                              52.729
Mortality_06_05_20_percapita                   56.832
Region:Competition_level                       47.051
Competition_level:Mortality_06_05_20_percapita 59.069
                                               F value
Region                                         23.2754
Competition_level                               5.7653
Mortality_06_05_20_percapita                   22.4297
Region:Competition_level                        0.5441
Competition_level:Mortality_06_05_20_percapita  2.1709
                                                  Pr(>F)
Region                                          0.002837
Competition_level                               0.001737
Mortality_06_05_20_percapita                   1.495e-05
Region:Competition_level                        0.654511
Competition_level:Mortality_06_05_20_percapita  0.100956
                                                  
Region                                         ** 
Competition_level                              ** 
Mortality_06_05_20_percapita                   ***
Region:Competition_level                          
Competition_level:Mortality_06_05_20_percapita    
---
Signif. codes:  
  0 '***' 0.001 '**' 0.01 '*' 0.05 '.'
  0.1 ' ' 1"


#residuals
qqPlot(resid(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_NODAYS))

plot(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_NODAYS)


qqPlot(Rawdata_experimentAugust2018$GR_finalmin_intial_degreedays_mgDD)



model_GR_toads_FinalmInitial_degreeDays_Jen_NODAYS<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita*Competition_level+ 
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_FinalmInitial_degreeDays_Jen_NODAYS)
summary(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)
AIC(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)



model_GR_toads_FinalmInitial_degreeDays_Jen_NODAYS2<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita*Competition_level+ 
    Mortality_tadsadded_26_06_21_percapita+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_FinalmInitial_degreeDays_Jen_NODAYS2)
summary(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)
AIC(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)




### JEN LOG mode
model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_log<-lmer(
  log_GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    #toadTadpoles_added_as_top.up_june7thand8th_percapita*Competition_level+ 
    Mortality_06_05_20_percapita*Competition_level+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality)

qqPlot(resid(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_log))


##### JEN density model ##############
Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/Rawdataexperiment_August_2018.csv",header=T,row.names=NULL,sep=",")

model_GR_toads_density_mortality_NODAYS<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Treatment_3_FROGMlHG_NOfrogs+ 
    Density_minus_mortality*Treatment_3_FROGMlHG_NOfrogs+
    (1|Population)+ 
    (1|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_density_mortality_NODAYS)
summary(model_GR_toads_density_mortality_NODAYS)
AIC(model_GR_toads_density_mortality_NODAYS)

"Type III Analysis of Variance Table with Satterthwaite's method
                                                        Sum Sq
Region                                               0.0175418
Treatment_3_FROGMlHG_NOfrogs                         0.0034259
Density_minus_mortality                              0.0101766
Region:Treatment_3_FROGMlHG_NOfrogs                  0.0008766
Treatment_3_FROGMlHG_NOfrogs:Density_minus_mortality 0.0005753
                                                       Mean Sq
Region                                               0.0175418
Treatment_3_FROGMlHG_NOfrogs                         0.0017129
Density_minus_mortality                              0.0101766
Region:Treatment_3_FROGMlHG_NOfrogs                  0.0004383
Treatment_3_FROGMlHG_NOfrogs:Density_minus_mortality 0.0002877
                                                     NumDF
Region                                                   1
Treatment_3_FROGMlHG_NOfrogs                             2
Density_minus_mortality                                  1
Region:Treatment_3_FROGMlHG_NOfrogs                      2
Treatment_3_FROGMlHG_NOfrogs:Density_minus_mortality     2
                                                      DenDF
Region                                                4.777
Treatment_3_FROGMlHG_NOfrogs                         59.174
Density_minus_mortality                              57.484
Region:Treatment_3_FROGMlHG_NOfrogs                  48.509
Treatment_3_FROGMlHG_NOfrogs:Density_minus_mortality 57.164
                                                     F value
Region                                               27.8690
Treatment_3_FROGMlHG_NOfrogs                          2.7214
Density_minus_mortality                              16.1677
Region:Treatment_3_FROGMlHG_NOfrogs                   0.6964
Treatment_3_FROGMlHG_NOfrogs:Density_minus_mortality  0.4570
                                                       Pr(>F)
Region                                               0.003715
Treatment_3_FROGMlHG_NOfrogs                         0.074023
Density_minus_mortality                              0.000171
Region:Treatment_3_FROGMlHG_NOfrogs                  0.503314
Treatment_3_FROGMlHG_NOfrogs:Density_minus_mortality 0.635459
                                                        
Region                                               ** 
Treatment_3_FROGMlHG_NOfrogs                         .  
Density_minus_mortality                              ***
Region:Treatment_3_FROGMlHG_NOfrogs                     
Treatment_3_FROGMlHG_NOfrogs:Density_minus_mortality    
---
Signif. codes:  
  0 '***' 0.001 '**' 0.01 '*' 0.05 '.'
  0.1 ' ' 1"




######### add mortality june 6th 2021
model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_june6th2021<-lmer(
  GR_finalmin_intial_degreedays_mgDD~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Days+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR_toads_FinalmInitial_degreeDays.Frank.3_mortality_june6th2021) 

#######################################################################
############################################################################
################## CUSTOM CONTRASTS TOAD GROWTH RATE ####################
############################################################################
############################################################################

# http://www2.uaem.mx/r-mirror/web/packages/phia/vignettes/phia.pdf
## https://stats.stackexchange.com/questions/376441/interpreting-contrasts-for-non-significant-interaction-in-a-linear-mixed-model


testInteractions(model_GR9,1, pairwise="Region", across="Competition_level")



(model_GR_toads_model_GR9.means <- interactionMeans(model_GR9))

# adjusted mean plot
plot(model_GR_toads_model_GR9.means)

#model_GR1
(model_GR9.means <- interactionMeans(model_GR9))

# adjusted mean plot
plot(model_GR9.means)




########


emm3_model_growthrate=emmeans(model_GR9,specs=~ Competition_level*Region)


#718
capture.output(emm3_model_growthrate,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_model_GR9_CI_718_19_01_22.txt")
write.csv(emm3_model_growthrate,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_model_GR9_CI_718_19_01_22.csv")




#make into dataframe
emm3_model_growthratedf<-as.data.frame(emm3_model_growthrate)

#make new column
emm3_model_growthratedf<-cbind(Model = "model_GR_toads_model_GR9", emm3_model_growthratedf)

##### VERY IMPORTANT #######
#### NB ORDER MATTERS!!!!!!!!
#### must order the Rawdata file that ran the lmmr has HG first, then ML!!!!

#create custom contrasts
Low_controlHG<-rep(c(1,0), times = c(1,7))
FrogMLHG<-rep(c(0,1,0), times = c(1,1,6))
FrogHGHG<-rep(c(0,1,0), times = c(2,1,5))
High_controlHG<-rep(c(0,1,0), times = c(3,1,4))
Low_controlML<-rep(c(0,1,0), times = c(4,1,3))
FrogMLML<-rep(c(0,1,0), times = c(5,1,2))
FrogHGML<-rep(c(0,1,0), times = c(6,1,1))
High_controlML<-rep(c(0,1), times = c(7,1))

#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_emm3_model_growthrate_frogregion_mvt_19_01_22<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


capture.output(contrast_emm3_model_growthrate_frogregion_mvt_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRatecontrast_emm3_model_growthrate_frogregion_mvt_19_01_22_model_GR9_718.txt")




### include both frog region
(contrast_emm3_model_growthrate_6tests_includefrogregion_bonf_values_19_01_22<-contrast(emm3_model_growthrate,adjust="bonferroni",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML
  
)))


#718
capture.output(contrast_emm3_model_growthrate_6tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_6tests_includefrogregion_bonf_values_19_01_22_model_GR9_718.txt")
write.csv(contrast_emm3_model_growthrate_6tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_6tests_includefrogregion_bonf_values_19_01_22_model_GR9_718.csv")



### include both frog region
(contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML
  
)))


#718
capture.output(contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_model_GR9_718.txt")
write.csv(contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_model_GR9_718.csv")





### include both frog region
(contrast_emm3_model_growthrate_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML,
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


#718
#capture.output(contrast_emm3_model_growthrate_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22_model_GR9_718.txt")
write.csv(contrast_emm3_model_growthrate_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22_model_GR9_718.csv")




### test OF MINUS #######
(contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_TESTminus<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogHGHG - High_controlHG) - (FrogHGML - High_controlML),
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogMLHG  - High_controlHG) - (FrogMLML - High_controlML)
)))

write.csv(contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_TESTminus,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_TESTminus_model_GR9_718.csv")




(contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_TESTINTER<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
)))


write.csv(contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_TESTINTER,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_6tests_includefrogregion_mvt_values_19_01_22_TESTINTER_model_GR9_718.csv")





### OLD ONE IN ms 
(contrast_emm3_model_growthrate_mvt_values_19_01_22<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))



#718
capture.output(contrast_emm3_model_growthrate_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_19_01_22_model_GR9_adjustmvt_718.txt")
write.csv(contrast_emm3_model_growthrate_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_19_01_22_model_GR9_adjustmvt_718.csv")


#bonferroni
(contrast_emm3_model_growthrate_bonf_values_19_01_22<-contrast(emm3_model_growthrate,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))



#718
capture.output(contrast_emm3_model_growthrate_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_values_19_01_22_model_GR9_718.txt")
write.csv(contrast_emm3_model_growthrate_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_values_19_01_22_model_GR9_718.csv")


### has low vs low and high v high and low v high
(contrast_emm3_model_growthrate_mvt_values_lowvlow_19_01_22<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  
  "Low_controlML - High_controlML" =Low_controlML - High_controlML,
  "Low_controlHG - High_controlHG" =Low_controlHG - High_controlHG
  
)))




capture.output(contrast_emm3_model_growthrate_mvt_values_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_lowvlow_19_01_22_model_GR3_adjustmvt_718.txt")

write.csv(contrast_emm3_model_growthrate_mvt_values_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_lowvlow_19_01_22_model_GR3_adjustmvt_718.csv")


#bonf
(contrast_emm3_model_growthrate_bonf_values_lowvlow_19_01_22<-contrast(emm3_model_growthrate,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  
  "Low_controlML - High_controlML" =Low_controlML - High_controlML,
  "Low_controlHG - High_controlHG" =Low_controlHG - High_controlHG
  
)))


#718
capture.output(contrast_emm3_model_growthrate_bonf_values_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_values_lowvlow_19_01_22_model_GR3_adjustbonf_718.txt")

write.csv(contrast_emm3_model_growthrate_bonf_values_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_values_lowvlow_19_01_22_model_GR3_adjustbonf_718.csv")




### 7 tests
(contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_19_01_22<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
  
)))



capture.output(contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_19_01_22_model_GR3_adjustmvt_718.txt")

write.csv(contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_19_01_22_model_GR3_adjustmvt_718.csv")


### 7 tests
(contrast_emm3_model_growthrate_bonf_values_lowvlow_7tests_19_01_22<-contrast(emm3_model_growthrate,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
  
)))



capture.output(contrast_emm3_model_growthrate_bonf_values_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_values_lowvlow_7tests_19_01_22_model_GR3_adjustbonf_718.txt")

write.csv(contrast_emm3_model_growthrate_bonf_values_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_values_lowvlow_7tests_19_01_22_model_GR3_adjustbonf_718.csv")



##############################
##########  PERCENT ############
#############################

#emmean values
#region HG, comp level low control - single out estimate for each level of region/competition to insect into contrast table later to calculate percent
HGLow_controlHG_model_RGRDD<-emm3_model_growthratedf[1,4]
HGFrogMLHG_model_RGRDD<-emm3_model_growthratedf[2,4]
HGFrogHGHG_model_RGRDD<-emm3_model_growthratedf[3,4]
HGHigh_controlHG_model_RGRDD<-emm3_model_growthratedf[4,4]
MLLow_controlML_model_RGRDD<-emm3_model_growthratedf[5,4] 
MLFrogMLML_model_RGRDD<-emm3_model_growthratedf[6,4]
MLFrogHGML_model_RGRDD<-emm3_model_growthratedf[7,4]
MLHigh_controlML_model_RGRDD<-emm3_model_growthratedf[8,4]
HGFrog_overallHG_model_RGRDD<-(emm3_model_growthratedf[2,4]+emm3_model_growthratedf[3,4])/2
MLFrog_overallML_model_RGRDD<-(emm3_model_growthratedf[6,4]+emm3_model_growthratedf[7,4])/2


## subset percents
(contrast_emm3_model_growthrate_mvt_PERCENT_19_01_22<-contrast(emm3_model_growthrate,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_model_RGRDD)*100,
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_model_RGRDD))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_model_RGRDD))*100,
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_model_RGRDD)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_model_RGRDD)*100
  
  
  
)))


#capture
capture.output(contrast_emm3_model_growthrate_mvt_PERCENT_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_PERCENT_19_01_22_model_GR3_adjustmvt_718.txt")

write.csv(contrast_emm3_model_growthrate_mvt_PERCENT_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_PERCENT_19_01_22_model_GR3_adjustmvt_718.csv")



### bonferroni correction
(contrast_emm3_model_growthrate_bonf_PERCENT_19_01_22<-contrast(emm3_model_growthrate,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_model_RGRDD)*100,
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_model_RGRDD))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_model_RGRDD))*100,
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_model_RGRDD)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_model_RGRDD)*100
  
  
)))



#capture
capture.output(contrast_emm3_model_growthrate_bonf_PERCENT_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_PERCENT_19_01_22_model_GR3_718.txt")

write.csv(contrast_emm3_model_growthrate_bonf_PERCENT_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_bonf_PERCENT_19_01_22_model_GR3_718.csv")







#############
#### CONFIDENCE INTERVALS ####
##############


### 7 tests
(contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_CI_19_01_22<-contrast(emm3_model_growthrate,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "mvt")%>%
   confint())


capture.output(contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_CI_19_01_22_GR1.4_718.txt")
write.csv(contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_mvt_values_lowvlow_7tests_CI_19_01_22_GR1.4_718.csv")




############## 5 tests
(contrast_emm3_model_mvt_growthrate_CI_5tests_19_01_22<-contrast(emm3_model_growthrate,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "mvt")%>%
    confint())


write.csv(contrast_emm3_model_mvt_growthrate_CI_5tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_5tests_CI_model_GR3_adjustmvt_718.csv")


(contrast_emm3_model_bonf_growthrate_CI_5tests_19_01_22<-contrast(emm3_model_growthrate,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "bonferroni")%>%
    confint())



write.csv(contrast_emm3_model_bonf_growthrate_CI_5tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_5tests_CI_model_GR3_adjustbonf_718.csv")






######## no low but both frog regions ###
emm3_model_growthrate_nolow=emmeans(model_GR6,specs=~ Competition_level*Region)


#718
capture.output(emm3_model_growthrate_nolow,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_nolow_model_GR6_CI_718_19_01_22.txt")
write.csv(emm3_model_growthrate_nolow,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_nolow_model_GR6_CI_718_19_01_22.csv")




#make into dataframe
emm3_model_growthrate_nolowdf<-as.data.frame(emm3_model_growthrate_nolow)

#make new column
emm3_model_growthrate_nolowdf<-cbind(Model = "model_GR_toads_model_GR6", emm3_model_growthrate_nolowdf)



#create custom contrasts
FrogMLHG<-rep(c(1,0), times = c(1,5))
FrogHGHG<-rep(c(0,1,0), times = c(1,1,4))
High_controlHG<-rep(c(0,1,0), times = c(2,1,3))
FrogMLML<-rep(c(0,1,0), times = c(3,1,2))
FrogHGML<-rep(c(0,1,0), times = c(4,1,1))
High_controlML<-rep(c(0,1), times = c(5,1))


#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_emm3_model_growthrate_nolow_frogregion_mvt_19_01_22<-contrast(emm3_model_growthrate_nolow,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


capture.output(contrast_emm3_model_growthrate_nolow_frogregion_mvt_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRatecontrast_emm3_model_growthrate_nolow_frogregion_mvt_19_01_22_model_GR6_718.txt")


###for 
(contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22<-contrast(emm3_model_growthrate_nolow,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))



#718
capture.output(contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22_model_GR6_adjustmvt_718.txt")
write.csv(contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22_model_GR6_adjustmvt_718.csv")


#bonferroni
(contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22<-contrast(emm3_model_growthrate_nolow,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))



#718
capture.output(contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22_model_GR6_718.txt")
write.csv(contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22_model_GR6_718.csv")




###for 
(contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22_withfrogregion<-contrast(emm3_model_growthrate_nolow,adjust="mvt",method=list(
  "FrogMLHG - FrogMLML" =FrogMLHG - FrogMLML,
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG " = FrogMLHG - High_controlHG,
  
  "FrogMLML - High_controlML " = FrogMLML - High_controlML,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML
)))



#718
capture.output(contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22_withfrogregion_model_GR6_adjustmvt_718.txt")
write.csv(contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_mvt_values_19_01_22_withfrogregion_model_GR6_adjustmvt_718.csv")

###for 
(contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22_withfrogregion<-contrast(emm3_model_growthrate_nolow,adjust="bonferroni",method=list(
  "FrogMLHG - FrogMLML" =FrogMLHG - FrogMLML,
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG " = FrogMLHG - High_controlHG,
  
  "FrogMLML - High_controlML " = FrogMLML - High_controlML,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML
)))



#718
capture.output(contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22_withfrogregion_model_GR6_adjustbonf_718.txt")
write.csv(contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_bonf_values_19_01_22_withfrogregion_model_GR6_adjustbonf_718.csv")





########### three treats #####


emm3_model_growthrate_3treat=emmeans(model_GR4,specs=~ Treatment_three*Region)


#718
#capture.output(emm3_model_growthrate_3treat,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_model_GR4_CI_718_19_01_22.txt")
write.csv(emm3_model_growthrate_3treat,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_model_GR4_CI_718_19_01_22.csv")




#make into dataframe
emm3_model_growthrate_3treatdf<-as.data.frame(emm3_model_growthrate_3treat)

#make new column
emm3_model_growthrate_3treatdf<-cbind(Model = "model_GR_toads_model_GR4", emm3_model_growthrate_3treatdf)



#create custom contrasts
FrogHG<-rep(c(1,0), times = c(1,5))
High_controlHG<-rep(c(0,1,0), times = c(1,1,4))
Low_controlHG<-rep(c(0,1,0), times = c(2,1,3))
FrogML<-rep(c(0,1,0), times = c(3,1,2))
High_controlML<-rep(c(0,1,0), times = c(4,1,1))
Low_controlML<-rep(c(0,1), times = c(5,1))


###for 
(contrast_emm3_model_growthrate_3treat_mvt_values_19_01_22<-contrast(emm3_model_growthrate_3treat,adjust="mvt",method=list(
  "FrogHG - FrogML" =FrogHG - FrogML,
  "FrogHG - High_controlHG" = FrogHG - High_controlHG,
  "FrogML - High_controlML" = FrogML - High_controlML,
  "Low_controlHG - FrogHG " = Low_controlHG - FrogHG,
  "Low_controlML - FrogML" = Low_controlML - FrogML
)))



#718
#capture.output(contrast_emm3_model_growthrate_3treat_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_3treat_mvt_values_19_01_22_model_GR4_adjustmvt_718.txt")
write.csv(contrast_emm3_model_growthrate_3treat_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_3treat_mvt_values_19_01_22_model_GR4_adjustmvt_718.csv")


(contrast_emm3_model_growthrate_3treat_bonf_values_19_01_22<-contrast(emm3_model_growthrate_3treat,adjust="bonferroni",method=list(
  "FrogHG - FrogML" =FrogHG - FrogML,
  "FrogHG - High_controlHG" = FrogHG - High_controlHG,
  "FrogML - High_controlML" = FrogML - High_controlML,
  "Low_controlHG - FrogHG " = Low_controlHG - FrogHG,
  "Low_controlML - FrogML" = Low_controlML - FrogML
)))



#718
#capture.output(contrast_emm3_model_growthrate_3treat_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_3treat_bonf_values_19_01_22_model_GR4_adjustbonf_718.txt")
write.csv(contrast_emm3_model_growthrate_3treat_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_3treat_bonf_values_19_01_22_model_GR4_adjustbonf_718.csv")




########### three treats - no low treatment #####


emm3_model_growthrate_nolow_3treateat=emmeans(model_GR5,specs=~ Treatment_three*Region)


#718
#capture.output(emm3_model_growthrate_nolow_3treateat,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_model_GR5_CI_718_19_01_22.txt")
write.csv(emm3_model_growthrate_nolow_3treateat,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_model_growthrate_model_GR5_CI_718_19_01_22.csv")




#make into dataframe
emm3_model_growthrate_nolow_3treateatdf<-as.data.frame(emm3_model_growthrate_nolow_3treateat)

#make new column
emm3_model_growthrate_nolow_3treateatdf<-cbind(Model = "model_GR_toads_model_GR5", emm3_model_growthrate_nolow_3treateatdf)



#create custom contrasts
FrogHG<-rep(c(1,0), times = c(1,3))
High_controlHG<-rep(c(0,1,0), times = c(1,1,2))
FrogML<-rep(c(0,1,0), times = c(2,1,1))
High_controlML<-rep(c(0,1), times = c(3,0))


###for 
(contrast_emm3_model_growthrate_nolow_3treateat_mvt_values_19_01_22<-contrast(emm3_model_growthrate_nolow_3treateat,adjust="mvt",method=list(
  "FrogHG - FrogML" =FrogHG - FrogML,
  "FrogHG - High_controlHG" = FrogHG - High_controlHG,
  "FrogML - High_controlML" = FrogML - High_controlML
)))



#718
#capture.output(contrast_emm3_model_growthrate_nolow_3treateat_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_3treateat_mvt_values_19_01_22_model_GR5_adjustmvt_718.txt")
write.csv(contrast_emm3_model_growthrate_nolow_3treateat_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_3treateat_mvt_values_19_01_22_model_GR5_adjustmvt_718.csv")




###for 
(contrast_emm3_model_growthrate_nolow_3treateat_bonf_values_19_01_22<-contrast(emm3_model_growthrate_nolow_3treateat,adjust="bonferroni",method=list(
  "FrogHG - FrogML" =FrogHG - FrogML,
  "FrogHG - High_controlHG" = FrogHG - High_controlHG,
  "FrogML - High_controlML" = FrogML - High_controlML
)))



#718
#capture.output(contrast_emm3_model_growthrate_nolow_3treateat_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_3treateat_bonf_values_19_01_22_model_GR5_adjustbonf_718.txt")
write.csv(contrast_emm3_model_growthrate_nolow_3treateat_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/contrast_emm3_model_growthrate_nolow_3treateat_bonf_values_19_01_22_model_GR5_adjustbonf_718.csv")



################################
#################### PLOTS ######
################################





colabels <- c(Long = "Long co-occurrence history", Short = "Short co-occurrence history")
Rawdata_experimentAugust2018_nolow$Toad_Cooccurrence_History = factor(Rawdata_experimentAugust2018_nolow$Toad_Cooccurrence_History, levels=c('Short','Long'))


#### beautiful
#### 4 comp no facet
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_3comp_nolow_logscale_nofacet_539_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_GR_final_days_mgDay_3comp_nolow_logscale_nofacet<- Rawdata_experimentAugust2018_nolow%>%
    ggplot(aes(x=Competitior_Identity, y=GR_final_days_mgDay,fill=Toad_Cooccurrence_History)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad co-occurrence history\nwith the NRLF",breaks=c("Short", "Long"),
                      labels=c("Short", "Long"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c( "Toad_control","NRLF_ML","NRLF_HG"),
                     labels=c("High density\nToad control","NRLFs\nMainland","NRLFs\nHaida Gwaii" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_3comp_nolow_logscale_nofacet_539_600res.svg", width = 200, height = 150, units = 'mm')
(boxplot_GR_final_days_mgDay_3comp_nolow_logscale_nofacet<- Rawdata_experimentAugust2018_nolow%>%
    ggplot(aes(x=Competitior_Identity, y=GR_final_days_mgDay,fill=Toad_Cooccurrence_History)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad co-occurrence history\nwith the NRLF",breaks=c("Short", "Long"),
                      labels=c("Short", "Long"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c( "Toad_control","NRLF_ML","NRLF_HG"),
                     labels=c("Toad high\ncontrol","NRLFs\nMainland","NRLFs\nHaida Gwaii" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()













##### set label names
#ylim1 = boxplot.stats(Rawdata_experimentAugust2018$GR_final_days_mgDay)$stats[c(1, 5)]

labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")
Rawdata_experimentAugust2018$Region = factor(Rawdata_experimentAugust2018$Region, levels=c('HG','ML'))


#### beautiful
#### 4 comp no facet
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_4campxregion_model_GR3_logscale_nofacet_718_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet<- Rawdata_experimentAugust2018%>%
    ggplot(aes(x=Competition_level, y=GR_final_days_mgDay,fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_4campxregion_model_GR3_logscale_nofacet_718_600res.svg", width = 200, height = 150, units = 'mm')
(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet<- Rawdata_experimentAugust2018%>%
    ggplot(aes(x=Competition_level, y=GR_final_days_mgDay,fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



#### 4 comp treatments
# log scale
## dif reso
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_4campxregion_model_GR3_logscale_718_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_GR_final_days_mgDay_4comp_logscale<- Rawdata_experimentAugust2018%>%
    
    ggplot(aes(x=Competition_level, y=GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_4compxregion_model_GR3_logscale_718_600res.svg", width = 200, height = 150,units="mm")
(boxplot_GR_final_days_mgDay_4comp_logscale<- Rawdata_experimentAugust2018%>%
    
    ggplot(aes(x=Competition_level, y=GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()











###############
### GR_final_days_mgDay ###
############################
(boxplot_GR_final_days_mgDay<- Rawdata_experimentAugust2018%>%
   mutate(Treatment_three = fct_relevel(Treatment_three, 
                                        "Low_control", "Frog","High_control")) %>%
   ggplot(aes(x=Treatment_three, y=GR_final_days_mgDay)) +
   geom_boxplot(lwd=0.6) +
   scale_fill_manual("grey")+
   #coord_cartesian(ylim = ylim1*1.12)+
   facet_wrap(~Region,labeller = labeller(Region = labels))+
   labs(x="Competition Treatment")+
   labs(y="Toad growth rate (mg/day)")+
   scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                    labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
   scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                         labels=c("Haida Gwaii", "Mainland"))+
   theme_bw()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))

# log scale
## dif reso
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_model_GR3_logscale_718_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_GR_final_days_mgDay_logscale<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_model_GR3_logscale_718_600res.svg", width = 200, height = 150)
(boxplot_GR_final_days_mgDay_logscale<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




#### 4 comp treatments
## dif reso
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_4campxregion_model_GR3_718_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_GR_final_days_mgDay_4comp<- Rawdata_experimentAugust2018%>%
    
    ggplot(aes(x=Competition_level, y=GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_4compxregion_model_GR3_718_600res.svg", width = 200, height = 150,units="mm")
(boxplot_GR_final_days_mgDay_4comp<- Rawdata_experimentAugust2018%>%
    
    ggplot(aes(x=Competition_level, y=GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                      labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()












#log_GR_final_days_mgDay

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_logged_model_GR3_718.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_log_GR_final_days_mgDay<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=log10_GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="log(Toad growth rate (mg/day))")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()



svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_logged_model_GR3_718.svg", width = 200, height = 150)
(boxplot_log_GR_final_days_mgDay<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=log10_GR_final_days_mgDay)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="log(Toad growth rate (mg/day))")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()



### per pop
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_logscale_model_GR3_718_perpopulation.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_pops_21_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=log_GR_final_days_mgDay)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_final_days_mgDay_logscale_model_GR3_718_perpopulation.svg",width = 200, height = 150)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_pops_21_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=log_GR_final_days_mgDay)) +    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/day)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()







##otherway around (mainland first)
#png(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GrowthRate/boxplot_GR_finalmin_intial_degreedays_mgDD_reversedorder2.png",  width=600, height=450)
(boxplot_GR_finalmin_intial_degreedays_mgDD_reversedorder<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=GR_finalmin_intial_degreedays_mgDD)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    coord_cartesian(ylim = ylim1*1.12)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad growth rate (mg/degree day)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("ML", "HG"),
                          labels=c("Mainland","Haida Gwaii"))+
    theme_bw()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
#dev.off()

##############################################################################
##############################################################################
########## 2. Toad weight at metamorphosis ###################################
##############################################################################
##############################################################################

#### VERY IMPORTANT FOR CUSTOM CONTRASTS #####
#order levels of factor
Rawdata_experimentAugust2018$Region<- factor(Rawdata_experimentAugust2018$Region, levels = c("HG","ML"))
Rawdata_experimentAugust2018<- droplevels(Rawdata_experimentAugust2018)



#log - looks good
Rawdata_experimentAugust2018$log_Av_juv_biomass<-log(Rawdata_experimentAugust2018$Av_juv_biomass)


Rawdata_experimentAugust2018$log_Av_juv_biomass_mg<-log(Rawdata_experimentAugust2018$Av_juv_biomass_mg)


Rawdata_experimentAugust2018$log10_Av_juv_biomass<-log10(Rawdata_experimentAugust2018$Av_juv_biomass)


Rawdata_experimentAugust2018$log10_Av_juv_biomass_mg<-log10(Rawdata_experimentAugust2018$Av_juv_biomass_mg)

#arcsin
Rawdata_experimentAugust2018$arcsin_Av_juv_biomass<-transf.arcsin(Rawdata_experimentAugust2018$Av_juv_biomass)

hist(Rawdata_experimentAugust2018$arcsin_Av_juv_biomass)
#go to anova

#order levels of factor
#Rawdata_experimentAugust2018$Competition_level<- factor(Rawdata_experimentAugust2018$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
#Rawdata_experimentAugust2018<- droplevels(Rawdata_experimentAugust2018)




######  test normality #########
qqPlot(Rawdata_experimentAugust2018$Av_juv_biomass)
hist(Rawdata_experimentAugust2018$Av_juv_biomass)
shapiro.test(Rawdata_experimentAugust2018$Av_juv_biomass)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/hist_log10_Av_juv_biomass_mg_model_AW23_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$log10_Av_juv_biomass_mg)
dev.off()



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/hist_Av_juv_biomass_mg_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018$Av_juv_biomass_mg)
dev.off()





###########################################################
########### Jen suggestion, remove low treatments ########
##########################################################
dim(Rawdata_experimentAugust2018) #718  87

Rawdata_experimentAugust2018_nolow<-Rawdata_experimentAugust2018
Rawdata_experimentAugust2018_nolow<-Rawdata_experimentAugust2018_nolow[!(Rawdata_experimentAugust2018_nolow$Competition_level=="Low_control"),]
dim(Rawdata_experimentAugust2018_nolow) #539  87



Rawdata_experimentAugust2018_nolow$Treatment_three<-as.factor(Rawdata_experimentAugust2018_nolow$Treatment_three)


#Rawdata_experimentAugust2018_nolow$log10_Av_juv_biomass<-log10(Rawdata_experimentAugust2018_nolow$Av_juv_biomass)


#Rawdata_experimentAugust2018_nolow$log10_Av_juv_biomass_mg<-log10(Rawdata_experimentAugust2018_nolow$Av_juv_biomass_mg)






### get means and standard errors
Rawdata_experimentAugust2018_nolow_noNA<-Rawdata_experimentAugust2018_nolow[!(Rawdata_experimentAugust2018_nolow$Av_juv_biomass_mg=="NA"),]

dim(Rawdata_experimentAugust2018_nolow_noNA)

avweight_539 <- Rawdata_experimentAugust2018_nolow_noNA %>%
  group_by(Region,Competition_level)

avweight_539<-avweight_539 %>%
  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), Av_juv_biomass_mg)

avweight_539<-as.data.frame(avweight_539)
avweight_539

write.csv(avweight_539,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Mean_sd_se_avjuvweight_539.csv")


Rawdata_experimentAugust2018_noNA<-Rawdata_experimentAugust2018[!(Rawdata_experimentAugust2018$Av_juv_biomass_mg=="NA"),]

dim(Rawdata_experimentAugust2018_noNA)

Av_juv_biomass_mg_718 <- Rawdata_experimentAugust2018_noNA %>%
  group_by(Region,Competition_level)

Av_juv_biomass_mg_718<-Av_juv_biomass_mg_718 %>%
  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), Av_juv_biomass_mg)

Av_juv_biomass_mg_718<-as.data.frame(Av_juv_biomass_mg_718)
Av_juv_biomass_mg_718

write.csv(Av_juv_biomass_mg_718,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Mean_sd_se_Av_juv_biomass_mg_718.csv")


######### percent

Av_juv_biomass_mg_718_minus<-Av_juv_biomass_mg_718


HGfrog_HGlowtoad=101.89327
HGhightoad=95.62712
HGfrog_MLlowtoad=127.97704
MLhightoad=94.93834

####### intra vs inter
#Av_juv_biomass_mg_718_minus$mean_GR_PERCENT<-((HGfrog_HGlowtoad-HGhightoad)/HGfrog_HGlowtoad)*100

#Av_juv_biomass_mg_718_minus$Contrast<-("HGfrog_MLlowtoad__MLhightoad")

#Av_juv_biomass_mg_718_minus$Contrast<-("HGfrog_HGlowtoad__HGhightoad_MINUS_HGfrog_MLlowtoad__MLhightoad")

#Av_juv_biomass_mg_718_minus$mean_GR<-((HGfrog_HGlowtoad-HGhightoad)-(HGfrog_MLlowtoad-MLhightoad))

#bad
#Av_juv_biomass_mg_718_minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)-(HGfrog_MLlowtoad-MLhightoad))/(HGfrog_HGlowtoad-HGhightoad))*100

#Av_juv_biomass_mg_718_minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)-((HGfrog_MLlowtoad-MLhightoad)/MLhightoad))*100


(HGfrog_HGlowtoad-HGhightoad)

((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)*100

(HGfrog_MLlowtoad-MLhightoad)
((HGfrog_MLlowtoad-MLhightoad)/MLhightoad)*100

### inter - HG vs ML toad
(HGfrog_HGlowtoad-HGfrog_MLlowtoad)
(((HGfrog_HGlowtoad-HGfrog_MLlowtoad)/HGfrog_MLlowtoad)*100) 


##############################################################
############# LMMR - TOAD WEIGHT AT METAMORPHOSIS ##########################################################
##########################################






### order factors this way.... key!!!!!!!
Rawdata_experimentAugust2018_nolow$Competitior_Identity<- factor(Rawdata_experimentAugust2018_nolow$Competitior_Identity, levels = c("Toad_control","NRLF_HG","NRLF_ML"))
Rawdata_experimentAugust2018_nolow<- droplevels(Rawdata_experimentAugust2018_nolow)


Rawdata_experimentAugust2018_nolow$Toad_Cooccurrence_History<- factor(Rawdata_experimentAugust2018_nolow$Toad_Cooccurrence_History, levels = c("Long","Short"))
Rawdata_experimentAugust2018_nolow<- droplevels(Rawdata_experimentAugust2018_nolow)


summary(Rawdata_experimentAugust2018_nolow)


Rawdata_experimentAugust2018_nolow$Block<-as.factor(Rawdata_experimentAugust2018_nolow$Block)
Rawdata_experimentAugust2018_nolow$Population<-as.factor(Rawdata_experimentAugust2018_nolow$Population)
Rawdata_experimentAugust2018_nolow$Tank<-as.factor(Rawdata_experimentAugust2018_nolow$Tank)


## best 16_02_22
### NO LOW
model_MJ_AW6<-lmer(log10_Av_juv_biomass_mg~
                     Toad_Cooccurrence_History*Competitior_Identity+ 
                     Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled+ 
                     Average_Individual_Toad_Tadpole_Starting_Weight_Scaled+
                     Toad_Mortality_per_Capita_Scaled+
                     Days_Since_Experiment_Began_Scaled+
                     Block+
                     Mean_Average_Water_Temperature_Scaled+
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days_Since_Experiment_Began_Scaled|Tank)+
                     (1|Population), 
                   #(1|Block_factor), #random effects
                   data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_MJ_AW6)
car::Anova(model_MJ_AW6)

AIC(model_MJ_AW6) #  -701.7067
summary(model_MJ_AW6)



#539
capture.output(anova(model_MJ_AW6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_WeightatMetamorphosis_model_MJ_AW6_539.txt")
write.csv(anova(model_MJ_AW6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_WeightatMetamorphosis_model_MJ_AW6_539.csv")
write.csv(Anova(model_MJ_AW6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_WeightatMetamorphosis_model_MJ_AW6_539.csv")
capture.output(Anova(model_MJ_AW6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_WeightatMetamorphosis_model_MJ_AW6_539.txt")
capture.output(summary(model_MJ_AW6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_WeightatMetamorphosis_model_MJ_AW6_539.txt")

capture.output(summary(model_MJ_AW6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_WeightatMetamorphosis_model_MJ_AW6_539.csv")


tab_model(model_MJ_AW6,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/model_tab_WeightatMetamorphosis_model_MJ_AW6_539.doc")



### test residuals - mostly ok
qqnorm(resid(model_MJ_AW6))
hist(resid(model_MJ_AW6))
plot(model_MJ_AW6)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualsplot_model_MJ_AW6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MJ_AW6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualshist_model_MJ_AW6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MJ_AW6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/QQnorm_model_MJ_AW6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MJ_AW6))
dev.off()


## interaction means
(model_MJ_AW6.means <- interactionMeans(model_MJ_AW6))
plot(model_MJ_AW6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_MJ_AW6_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MJ_AW6.means <- interactionMeans(model_MJ_AW6))
plot(model_MJ_AW6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_MJ_AW6_539.svg", width = 12, height = 6.5)
(model_MJ_AW6.means <- interactionMeans(model_MJ_AW6))
plot(model_MJ_AW6.means)
dev.off()


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_MJ_AW6_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_AW6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_MJ_AW6_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_AW6)
dev.off()

## vis reg plots one at a time
par(mfrow=c(1,1))
par(mar = c(10, 5,2, 2))
#visreg(model_MJ_AW6)





L.S_model_MJ_AW6_frog <- pairs(lsmeans(model_MJ_AW6, ~ Toad_Cooccurrence_History | Competitior_Identity))
test(L.S_model_MJ_AW6_frog, adjust = "tukey")

capture.output(test(L.S_model_MJ_AW6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_MJ_AW6_frog_539.txt")
write.csv(test(L.S_model_MJ_AW6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_MJ_AW6_frog_539.csv")


L.S_model_MJ_AW6_region <- pairs(lsmeans(model_MJ_AW6, ~ Competitior_Identity | Toad_Cooccurrence_History ))
test(L.S_model_MJ_AW6_region, adjust = "tukey")


capture.output(test(L.S_model_MJ_AW6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_MJ_AW6_region_539.txt")
write.csv(test(L.S_model_MJ_AW6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_MJ_AW6_region_539.csv")




















#### VERY IMPORTANT FOR CUSTOM CONTRASTS #####
#order levels of factor
Rawdata_experimentAugust2018$Region<- factor(Rawdata_experimentAugust2018$Region, levels = c("HG","ML"))
Rawdata_experimentAugust2018<- droplevels(Rawdata_experimentAugust2018)



#### best model 26.01.22
### Rawdata_experimentAugust2018_718

#### best model 26.01.22
### Rawdata_experimentAugust2018_718
model_AW29<-lmer(log10_Av_juv_biomass_mg~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_06_05_20_percapita+
                   Days*Competition_level+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW29)
AIC(model_AW29) #  -871.4935
summary(model_AW29)
Anova(model_AW29)

capture.output(check_collinearity(model_AW29),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/collinearity_avjuvweight_model_AW29_718.txt")

#718
capture.output(anova(model_AW29),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW29_718.txt")
capture.output(Anova(model_AW29),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_avjuvweight_model_AW29_718.txt")
write.csv(anova(model_AW29),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW29_718.csv")
write.csv(Anova(model_AW29),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_avjuvweight_model_AW29_718.csv")
capture.output(summary(model_AW29),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_avjuvweight_model_AW29_718.txt")


tab_model(model_AW29, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/tab_model_avjuvweight_model_AW29_718.doc")



### test residuals - mostly ok
qqnorm(resid(model_AW29))
hist(resid(model_AW29))
plot(model_AW29)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualsplot_model_AW29_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW29)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualshist_model_AW29_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW29))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/QQnorm_model_AW29_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW29))
dev.off()



(model_AW29.means <- interactionMeans(model_AW29))
plot(model_AW29.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW29_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW29.means <- interactionMeans(model_AW29))
plot(model_AW29.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW29_718.svg", width = 12, height = 6.5)
(model_AW29.means <- interactionMeans(model_AW29))
plot(model_AW29.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW29)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW29_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW29)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW29_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW29)
dev.off()




L.S_model_AW29_frog <- pairs(lsmeans(model_AW29, ~ Region | Competition_level))
test(L.S_model_AW29_frog, adjust = "tukey")

capture.output(test(L.S_model_AW29_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW29_frog_718.txt")
write.csv(test(L.S_model_AW29_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW29_frog_718.csv")


L.S_model_AW29_region <- pairs(lsmeans(model_AW29, ~ Competition_level | Region ))
test(L.S_model_AW29_region, adjust = "tukey")


capture.output(test(L.S_model_AW29_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW29_region_718.txt")
write.csv(test(L.S_model_AW29_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW29_region_718.csv")



















#### model_AW24 ####
model_AW24<-lmer(log10_Av_juv_biomass_mg~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_06_05_20_percapita+
                   Days*Competition_level+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW24)
AIC(model_AW24) #  -907.6729
summary(model_AW24)


capture.output(check_collinearity(model_AW24),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/collinearity_avjuvweight_model_AW24_718.txt")

#718
capture.output(anova(model_AW24),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW24_718.txt")
capture.output(Anova(model_AW24),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_avjuvweight_model_AW24_718.txt")
write.csv(anova(model_AW24),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW24_718.csv")
write.csv(Anova(model_AW24),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_avjuvweight_model_AW24_718.csv")
capture.output(summary(model_AW24),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_avjuvweight_model_AW24_718.txt")


tab_model(model_AW24, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/tab_model_avjuvweight_model_AW24_718.doc")

tab_model(model_AW24,show.df = TRUE,p.val = "kr", file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/tab_model_avjuvweight_model_AW24_718_df_pkr.doc")



### test residuals - mostly ok
qqnorm(resid(model_AW24))
hist(resid(model_AW24))
plot(model_AW24)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualsplot_model_AW24_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW24)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualshist_model_AW24_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW24))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/QQnorm_model_AW24_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW24))
dev.off()



(model_AW24.means <- interactionMeans(model_AW24))
plot(model_AW24.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW24_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW24.means <- interactionMeans(model_AW24))
plot(model_AW24.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW24_718.svg", width = 12, height = 6.5)
(model_AW24.means <- interactionMeans(model_AW24))
plot(model_AW24.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW24)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW24_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW24)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW24_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW24)
dev.off()




L.S_model_AW24_frog <- pairs(lsmeans(model_AW24, ~ Region | Competition_level))
test(L.S_model_AW24_frog, adjust = "tukey")

capture.output(test(L.S_model_AW24_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW24_frog_718.txt")
write.csv(test(L.S_model_AW24_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW24_frog_718.csv")


L.S_model_AW24_region <- pairs(lsmeans(model_AW24, ~ Competition_level | Region ))
test(L.S_model_AW24_region, adjust = "tukey")


capture.output(test(L.S_model_AW24_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW24_region_718.txt")
write.csv(test(L.S_model_AW24_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW24_region_718.csv")






#### remove low control... and treat frog regions as two
#take out days*comp interaction
#### model_AW28 ####
model_AW28<-lmer(log10_Av_juv_biomass_mg~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_06_05_20_percapita+
                   #Days*Competition_level+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   Days+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW28)
car::Anova(model_AW28, type=3)
car::Anova(model_AW28, type=2)

AIC(model_AW28) #  -701.7067
summary(model_AW28)

tab_model(model_AW28)## Useful for model output

#539
capture.output(anova(model_AW28),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW28_539.txt")
capture.output(Anova(model_AW28),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_avjuvweight_model_AW28_539.txt")
write.csv(anova(model_AW28),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW28_539.csv")
write.csv(Anova(model_AW28),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_chisq_avjuvweight_model_AW28_539.csv")
capture.output(summary(model_AW28),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_avjuvweight_model_AW28_539.txt")


tab_model(model_AW28, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/tab_model_avjuvweight_model_AW28_539.doc")


### test residuals - mostly ok
qqnorm(resid(model_AW28))
hist(resid(model_AW28))
plot(model_AW28)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualsplot_model_AW28_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW28)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualshist_model_AW28_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW28))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/QQnorm_model_AW28_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW28))
dev.off()



(model_AW28.means <- interactionMeans(model_AW28))
plot(model_AW28.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW28_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW28.means <- interactionMeans(model_AW28))
plot(model_AW28.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW28_539.svg", width = 12, height = 6.5)
(model_AW28.means <- interactionMeans(model_AW28))
plot(model_AW28.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
#visreg(model_AW28)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW28_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW28)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW28_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW28)
dev.off()




L.S_model_AW28_frog <- pairs(lsmeans(model_AW28, ~ Region | Competition_level))
test(L.S_model_AW28_frog, adjust = "tukey")

capture.output(test(L.S_model_AW28_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW28_frog_539.txt")
write.csv(test(L.S_model_AW28_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW28_frog_539.csv")


L.S_model_AW28_region <- pairs(lsmeans(model_AW28, ~ Competition_level | Region ))
test(L.S_model_AW28_region, adjust = "tukey")


capture.output(test(L.S_model_AW28_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW28_region_539.txt")
write.csv(test(L.S_model_AW28_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/L.S_model_AW28_region_539.csv")







#### remove low control... and treat frog regions as one
#### model_AW27 ####
model_AW27<-lmer(log10_Av_juv_biomass_mg~
                   Region*Treatment_three+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_06_05_20_percapita+
                   Days*Treatment_three+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW27)
car::Anova(model_AW27, type=3)
car::Anova(model_AW27, type=2)

AIC(model_AW27) #  -702.9198
summary(model_AW27)


#539
#capture.output(anova(model_AW27),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW27_539.txt")
write.csv(anova(model_AW27),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW27_539.csv")
write.csv(Anova(model_AW27),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Anova_avjuvweight_model_AW27_539.csv")
capture.output(summary(model_AW27),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_avjuvweight_model_AW27_539.txt")





### test residuals - mostly ok
qqnorm(resid(model_AW27))
hist(resid(model_AW27))
plot(model_AW27)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualsplot_model_AW27_539.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW27)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualshist_model_AW27_539.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW27))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/QQnorm_model_AW27_539.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW27))
dev.off()



(model_AW27.means <- interactionMeans(model_AW27))
plot(model_AW27.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW27_539.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW27.means <- interactionMeans(model_AW27))
plot(model_AW27.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW27_539.svg", width = 12, height = 6.5)
(model_AW27.means <- interactionMeans(model_AW27))
plot(model_AW27.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW27)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW27_539.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW27)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW27_539.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW27)
dev.off()











## add count juv emerged per capita
### Rawdata_experimentAugust2018_718
#### model_AW26 ####
model_AW26<-lmer(log10_Av_juv_biomass_mg~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Count_juv_emerged_percapita+
                   Mortality_06_05_20_percapita+
                   Days*Competition_level+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW26)
AIC(model_AW26) #  -907.8657
summary(model_AW26)




#Mortality_06_05_20_percapita*Competition_level*Region+
# didn't use because interaction didn't biolgically make sense hard to explain
### Rawdata_experimentAugust2018_718
model_AW25<-lmer(log10_Av_juv_biomass_mg~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_06_05_20_percapita*Competition_level*Region+
                   Days*Competition_level+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW25)
AIC(model_AW25) # -924.3434
summary(model_AW25)


#718
capture.output(anova(model_AW25),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW25_718.txt")
write.csv(anova(model_AW25),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW25_718.csv")
capture.output(summary(model_AW25),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_avjuvweight_model_AW25_718.txt")





### test residuals - mostly ok
qqnorm(resid(model_AW25))
hist(resid(model_AW25))
plot(model_AW25)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualsplot_model_AW25_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW25)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualshist_model_AW25_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW25))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/QQnorm_model_AW25_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW25))
dev.off()



(model_AW25.means <- interactionMeans(model_AW25))
plot(model_AW25.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW25_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW25.means <- interactionMeans(model_AW25))
plot(model_AW25.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW25_718.svg", width = 12, height = 6.5)
(model_AW25.means <- interactionMeans(model_AW25))
plot(model_AW25.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW25)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW25_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW25)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW25_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW25)
dev.off()




### Rawdata_experimentAugust2018_718
model_AW23<-lmer(log10_Av_juv_biomass_mg~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_06_05_20_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW23)
AIC(model_AW23) #  -905.225
summary(model_AW23)


#718
capture.output(anova(model_AW23),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW23_718.txt")
write.csv(anova(model_AW23),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/anova_avjuvweight_model_AW23_718.csv")
capture.output(summary(model_AW23),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/summary_avjuvweight_model_AW23_718.txt")





### test residuals - mostly ok
qqnorm(resid(model_AW23))
hist(resid(model_AW23))
plot(model_AW23)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualsplot_model_AW23_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW23)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/Residualshist_model_AW23_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW23))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/QQnorm_model_AW23_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW23))
dev.off()



(model_AW23.means <- interactionMeans(model_AW23))
plot(model_AW23.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW23_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW23.means <- interactionMeans(model_AW23))
plot(model_AW23.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/interactionMeans_model_AW23_718.svg", width = 12, height = 6.5)
(model_AW23.means <- interactionMeans(model_AW23))
plot(model_AW23.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW23)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW23_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW23)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/visreg_model_AW23_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW23)
dev.off()




### Rawdata_experimentAugust2018_718
model_AW1.2<-lmer(log_Av_juv_biomass_mg~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor),
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW1.2)
AIC(model_AW1.2) #  -157.9319
summary(model_AW1.2)


#718
capture.output(anova(model_AW1.2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_avjuvweight_model_AW1.2_718.txt")
write.csv(anova(model_AW1.2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_avjuvweight_model_AW1.2_718.csv")
capture.output(summary(model_AW1.2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_avjuvweight_model_AW1.2_718.txt")





### test residuals - mostly ok
qqnorm(resid(model_AW1.2))
hist(resid(model_AW1.2))
plot(model_AW1.2)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_AW1.2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW1.2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_AW1.2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW1.2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_AW1.2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW1.2))
dev.off()



(model_AW1.2.means <- interactionMeans(model_AW1.2))
plot(model_AW1.2.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_AW1.2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW1.2.means <- interactionMeans(model_AW1.2))
plot(model_AW1.2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_AW1.2_718.svg", width = 12, height = 6.5)
(model_AW1.2.means <- interactionMeans(model_AW1.2))
plot(model_AW1.2.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW1.2)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_AW1.2_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW1.2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_AW1.2_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW1.2)
dev.off()

#has labels, but can't get all plots in one
visreg(model_AW1.2, gg = T) 



####   Mortality_tadsadded_26_06_21_percapita+
model_AW2<-lmer(log_Av_juv_biomass_mg~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW2)
AIC(model_AW2) #  -153.7187
summary(model_AW2)


#718
capture.output(anova(model_AW2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_avjuvweight_model_AW2_718.txt")
write.csv(anova(model_AW2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_avjuvweight_model_AW2_718.csv")
capture.output(summary(model_AW2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_avjuvweight_model_AW2_718.txt")





### test residuals - mostly ok
qqnorm(resid(model_AW2))
hist(resid(model_AW2))
plot(model_AW2)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_AW2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_AW2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_AW2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_AW2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_AW2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_AW2))
dev.off()



(model_AW2.means <- interactionMeans(model_AW2))
plot(model_AW2.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_AW2_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW2.means <- interactionMeans(model_AW2))
plot(model_AW2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_AW2_718.svg", width = 12, height = 6.5)
(model_AW2.means <- interactionMeans(model_AW2))
plot(model_AW2.means)
dev.off()


par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW2)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_AW2_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_AW2_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW2)
dev.off()

#has labels, but can't get all plots in one
visreg(model_AW2, gg = T) 

####### dif mortality - and not mg!
model_AW1<-lmer(log_Av_juv_biomass~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  (1+Days|Tank_factor)+
                  (1|Population_factor),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW1)
AIC(model_AW1) #  -200.1503 
summary(model_AW1)

#715
capture.output(anova(model_AW1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_avjuvweight_model_AW1_715.txt")
capture.output(summary(model_AW1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_avjuvweight_model_AW1_715.txt")

#718
capture.output(anova(model_AW1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_avjuvweight_model_AW1_718.txt")
capture.output(summary(model_AW1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_avjuvweight_model_AW1_718.txt")



### test residuals - mostly ok
qqnorm(resid(model_AW1))
hist(resid(model_AW1))
plot(model_AW1)


(model_AW1.means <- interactionMeans(model_AW1))
plot(model_AW1.means)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_AW1_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_AW1.means <- interactionMeans(model_AW1))
plot(model_AW1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_AW1_718.svg", width = 12, height = 6.5)
(model_AW1.means <- interactionMeans(model_AW1))
plot(model_AW1.means)
dev.off()


par(mar = c(2, 2,2, 2))
par(mfrow=c(3,3))
visreg(model_AW1)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_AW1_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_AW1_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_AW1)
dev.off()

#has labels, but can't get all plots in one
visreg(model_AW1, gg = T) 


#warning
model_AW1.1<-lmer(log_Av_juv_biomass~
                    Region*Competition_level+ 
                    #scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    #scaled_Mortality_tadsadded_26_06_21_percapita+
                    scaled_Count_toads_left_b4weigh+
                    
                    Days+
                    scaled_Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor),
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW1.1)
AIC(model_AW1.1) #  -192.2553
summary(model_AW1.1)


### test residuals - mostly ok
qqnorm(resid(model_AW1.1))
hist(resid(model_AW1.1))
plot(model_AW1.1)

(model_AW1.1.means <- interactionMeans(model_AW1.1))
plot(model_AW1.1.means)

#Count_toads_left_b4weigh and no Days fixed
model_GR1.3<-lmer(log_GR_final_days_mgDay~
                    Region*Competition_level+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Count_toads_left_b4weigh+
                    # Days+
                    Block_factor+
                    scaled_Mean_averageTemp+
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor), 
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_GR1.3)
AIC(model_GR1.3) #   -177.2915
summary(model_GR1.3)







model_avjuvbiomass_toads_Frank.2_mortality<-lmer(
  Av_juv_biomass~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mean_averageTemp+ #fixed effects
    Days+
    Mean_averageTemp+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))#

anova(model_avjuvbiomass_toads_Frank.2_mortality)
AIC(model_avjuvbiomass_toads_Frank.2_mortality) #-1962.045


"Type III Analysis of Variance Table with Satterthwaite's method
                                                                Sum Sq   Mean Sq NumDF  DenDF F value    Pr(>F)    
Region                                                       0.0027703 0.0027703     1  5.623  9.3600  0.024165 *  
Competition_level                                            0.0114116 0.0038039     3 39.405 12.8520 5.332e-06 ***
toadTadpoles_added_as_top.up_june7thand8th_percapita         0.0009540 0.0009540     1 43.780  3.2233  0.079503 .  
scaled_X25.5.18_experiment_start_tapole_av_individual_weight 0.0003926 0.0003926     1  6.559  1.3265  0.289675    
Mean_averageTemp                                             0.0024298 0.0024298     1 40.931  8.2096  0.006549 ** 
Days                                                         0.0102086 0.0102086     1 45.147 34.4915 4.768e-07 ***
Mortality_06_05_20_percapita                                 0.0053892 0.0053892     1 53.333 18.2081 8.154e-05 ***
Region:Competition_level                                     0.0028677 0.0009559     3 39.300  3.2296  0.032547 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"



#write.csv(anova(model_avjuvbiomass_toads_Frank.2_mortality),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_model_avjuvbiomass_toads_Frank.2_mortality_REMLTRUE_011220.csv")

#capture.output(model_avjuvbiomass_toads_Frank.2_mortality,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/model_avjuvbiomass_toads_Frank.2_mortality_REMLTRUE_011220.txt")

###### tadpoles percent -exactly the same
#model_avjuvbiomass_toads_Frank.2_mortality_percent<-lmer(
Av_juv_biomass~
  Region*Competition_level+ 
  toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
  Mean_averageTemp+ #fixed effects
  Days+
  Mean_averageTemp+
  Mortality_06_05_20_percapita+
  (1|Population)+ 
  (1+Days|Tank), #random effects
data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))#

anova(model_avjuvbiomass_toads_Frank.2_mortality)

#capture.output(anova(model_avjuvbiomass_toads_Frank.2_mortality),file="anova_model_avjuvbiomass_toads_Frank.2_mortality_REMLTRUE_291120.txt")
#capture.output(model_avjuvbiomass_toads_Frank.2_mortality,file="model_avjuvbiomass_toads_Frank.2_mortality_REMLTRUE_291120.txt")


########## arcsin ######
model_arcsin_avjuvbiomass_toads_Frank.2_mortality<-lmer(
  arcsin_Av_juv_biomass~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mean_averageTemp+ #fixed effects
    Days+
    Mean_averageTemp+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank)+
    (1|Block), #random effects
  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))#

anova(model_arcsin_avjuvbiomass_toads_Frank.2_mortality)


################## only removing one outlier
model_avjuvbiomass_toads_Frank.2_mortality2<-lmer(
  Av_juv_biomass~
    Region*Competition_level+ 
    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
    Mean_averageTemp+ #fixed effects
    Days+
    Mean_averageTemp+
    Mortality_06_05_20_percapita+
    (1|Population)+ 
    (1+Days|Tank), #random effects
  data=Rawdata_experimentAugust20182,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))#

anova(model_avjuvbiomass_toads_Frank.2_mortality)
AIC(model_avjuvbiomass_toads_Frank.2_mortality) #-1962.045

"Type III Analysis of Variance Table with Satterthwaite's method
                                                                Sum Sq   Mean Sq NumDF  DenDF F value    Pr(>F)    
Region                                                       0.0027703 0.0027703     1  5.623  9.3600  0.024165 *  
Competition_level                                            0.0114116 0.0038039     3 39.405 12.8520 5.332e-06 ***
toadTadpoles_added_as_top.up_june7thand8th_percapita         0.0009540 0.0009540     1 43.780  3.2233  0.079503 .  
scaled_X25.5.18_experiment_start_tapole_av_individual_weight 0.0003926 0.0003926     1  6.559  1.3265  0.289675    
Mean_averageTemp                                             0.0024298 0.0024298     1 40.931  8.2096  0.006549 ** 
Days                                                         0.0102086 0.0102086     1 45.147 34.4915 4.768e-07 ***
Mortality_06_05_20_percapita                                 0.0053892 0.0053892     1 53.333 18.2081 8.154e-05 ***
Region:Competition_level                                     0.0028677 0.0009559     3 39.300  3.2296  0.032547 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"







######### without mortality
#model_avjuvbiomass_toads_Frank.2<-lmer(
# Av_juv_biomass~
#  Region*Competition_level+ 
# toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+ 
#scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
Mean_averageTemp+ #fixed effects
  Days+
  Mean_averageTemp+
  (1|Population)+ 
  (1+Days|Tank), #random effects
data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))#

#anova(model_avjuvbiomass_toads_Frank.2)
AIC(model_avjuvbiomass_toads_Frank.2) #-1945.395

#capture.output(anova(model_avjuvbiomass_toads_Frank.2),file="anova_model_avjuvbiomass_toads_Frank.2_REMLFALSE.txt")
#capture.output(model_avjuvbiomass_toads_Frank.2,file="model_avjuvbiomass_toads_Frank.2_REMLFALSE.txt")

#capture.output(anova(model_avjuvbiomass_toads_Frank.2),file="anova_model_avjuvbiomass_toads_Frank.2_REMLTRUE.txt")
#capture.output(model_avjuvbiomass_toads_Frank.2,file="model_avjuvbiomass_toads_Frank.2_REMLTRUE.txt")



### BEST 17_01_22
#### Alba model
model_AW6<-lmer(Av_juv_biomass~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  Mean_averageTemp+ #fixed effects
                  
                  Days+
                  (1|Block_factor/Tank_factor)+
                  (1|Population_factor)+ 
                  (1+Days|Tank_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW6)
AIC(model_AW6) #-1957.847


### test residuals - mostly ok
qqnorm(resid(model_AW6))
hist(resid(model_AW6))
plot(model_AW6)

#### added block as fixed as well
model_AW6.3<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Mean_averageTemp+ #fixed effects
                    
                    Days+
                    Block_factor+
                    (1|Block_factor/Tank_factor)+
                    (1|Population_factor)+ 
                    (1+Days|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW6.3)
AIC(model_AW6.3) 


#### added block as fixed as well  (1+Block_factor|Tank_factor)+
model_AW6.3.1<-lmer(Av_juv_biomass~
                      Region*Competition_level+ 
                      scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                      scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                      scaled_Mortality_tadsadded_26_06_21_percapita+
                      Mean_averageTemp+ #fixed effects
                      
                      Days+
                      Block_factor+
                      (1+Block_factor|Tank_factor)+
                      (1|Population_factor)+ 
                      (1+Days|Tank_factor), #random effects
                    data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW6.3.1)
AIC(model_AW6.3.1) 

## signif
#### Alba model (1+Block_factor|Tank_factor) vs   (1|Block_factor/Tank_factor)
model_AW6.2<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Mean_averageTemp+ #fixed effects
                    
                    Days+
                    (1+Block_factor|Tank_factor)+
                    (1|Population_factor)+ 
                    (1+Days|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW6.2)
AIC(model_AW6.2) 

### test residuals - mostly ok
qqnorm(resid(model_AW6.2))
hist(resid(model_AW6.2))
plot(model_AW6.2)


#### Alba model 
model_AW6.2.1<-lmer(Av_juv_biomass~
                      Region*Competition_level+ 
                      scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                      scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                      Mortality_tadsadded_26_06_21_percapita+
                      Days+
                      Block_factor+
                      Mean_averageTemp+ #fixed effects
                      
                      (1|Population_factor)+ 
                      (1+Days|Tank_factor), #random effects
                    data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW6.2.1)
AIC(model_AW6.2.1) 

### test residuals - mostly ok
qqnorm(resid(model_AW6.2.1))
hist(resid(model_AW6.2.1))
plot(model_AW6.2.1)


model_AW10<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   #scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   
                   Block_factor+
                   (1|Population_factor)+ 
                   (1|Block_factor/Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW10)
AIC(model_AW10) #-1857.721


model_AW6<-lmer(Av_juv_biomass~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #scaled_Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Mean_averageTemp+ #fixed effects
                  
                  (1|Block_factor/Tank_factor)+
                  (1|Population_factor)+ 
                  (1+Days|Tank_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW6)

model_AW7<-lmer(Av_juv_biomass~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Mean_averageTemp+ #fixed effects
                  
                  (1|Block_factor)+
                  (1|Population_factor)+ 
                  (1|Tank_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW7)
AIC(model_AW7)#-1880.371


#### this is similar to model I had in Mary paper except added block
model_AW8<-lmer(Av_juv_biomass~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Mean_averageTemp+ #fixed effects
                  
                  Block_factor+
                  (1|Population_factor)+ 
                  (1|Tank_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW8)
AIC(model_AW8) #-1882.678

## significant
### mortality doesnt' have tads added (b/c tads added as top up has it in it?)
model_AW8.2<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    
                    Block_factor+
                    (1|Population_factor)+ 
                    (1|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW8.2)
AIC(model_AW8.2) #-1890.31





## model not significant without mortality
model_AW8.1<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    #scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    
                    Block_factor+
                    (1|Population_factor)+ 
                    (1|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW8.1)
AIC(model_AW8) #-1882.678


## model not significant without mortality
model_AW8.3<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    
                    Block_factor+
                    (1|Population_factor)+
                    (1|Days)+
                    (1|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW8.3)
AIC(model_AW8.3) #-1883.555


## model 
model_AW8.3<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    
                    Block_factor+
                    (1|Population_factor)+
                    (1|Days)+
                    (1|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW8.3)
AIC(model_AW8.3) #-1883.555



## model  Block_factor|Tank_factor
model_AW8.4<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Mean_averageTemp+ #fixed effects
                    Days+
                    Block_factor+
                    (1|Population_factor)+
                    #(Competition_level|Days)+
                    (Block_factor|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW8.4)
AIC(model_AW8.4) #-1874.185


## model  Block_factor|Tank_factor (Competition_level|Days)
model_AW8.5<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Mean_averageTemp+ #fixed effects
                    Days+
                    Block_factor+
                    (1|Population_factor)+
                    (Competition_level|Days)+
                    (Block_factor|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW8.5)
AIC(model_AW8.5) #-1888.818

# (1|Block_factor/Tank_factor)
model_AW9<-lmer(Av_juv_biomass~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Mean_averageTemp+ #fixed effects
                  
                  #Block_factor+
                  (1|Population_factor)+ 
                  (1|Block_factor/Tank_factor), #random effects
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW9)
AIC(model_AW9) #-1880.371




## block as fixed adn (1|Block_factor/Tank_factor)
model_AW9.1<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    
                    Block_factor+
                    (1|Population_factor)+ 
                    (1|Block_factor/Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW9.1)
AIC(model_AW9.1) #-1880.678


## block as fixed and (1+Block_factor|Tank_factor)
model_AW9.2<-lmer(Av_juv_biomass~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    scaled_Mortality_tadsadded_26_06_21_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    
                    Block_factor+
                    (1|Population_factor)+ 
                    (1+Block_factor|Tank_factor), #random effects
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW9.2)
AIC(model_AW9.2) #-1874.185









#https://newprairiepress.org/cgi/viewcontent.cgi?referer=&httpsredir=1&article=1474&context=agstatconference
#https://stats.stackexchange.com/questions/329366/accounting-for-time-in-repeated-measures-glmm-r
model_AW5<-lmer(Av_juv_biomass~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  scaled_Mortality_tadsadded_26_06_21_percapita+
                  Days+
                  Mean_averageTemp+ #fixed effects
                  
                  Block_factor+
                  (1|Population_factor)+ 
                  (0+Days|Tank_factor)+ #random effects
                  (1|Tank_factor), #random effects - accounts for repeated measures
                data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW5)
AIC(model_AW5) # -1893.471


# https://www.muscardinus.be/2017/07/lme4-random-effects/
##  (1|Block_factor:Tank_factor)
# (1|Tank_factor)+
#warning
model_AW11<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   (1|Tank_factor)+
                   (1|Population_factor)+ 
                   (1|Block_factor:Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW11)
AIC(model_AW11) #-1880.678

#warning
#https://stats.stackexchange.com/questions/242109/model-failed-to-converge-warning-in-lmer/243225
model_AW11.1<-lmer(Av_juv_biomass~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     (1|Tank_factor)+
                     (1|Population_factor)+ 
                     (1|Block_factor:Tank_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,
                   control = lmerControl(optimizer ="Nelder_Mead"))

## warning
model_AW11.2<-lmer(Av_juv_biomass~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     (1|Tank_factor)+
                     (1|Population_factor)+ 
                     (1|Block_factor:Tank_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,
                   control = lmerControl(
                     optimizer ='optimx', optCtrl=list(method='L-BFGS-B')))

# https://ourcodingclub.github.io/tutorials/mixed-models/#nested
model_AW12<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   #Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   (1|Days)+
                   (1|Population_factor)+ 
                   (1|Block_factor/Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW12)
AIC(model_AW12) # -1863.245

model_AW13<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #(1|Days)+
                   (1|Population_factor)+ 
                   (1|Block_factor/Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW13)
AIC(model_AW13) #  -1880.678
summary(model_AW13)


# warning
## change order tank and block
# https://www.muscardinus.be/2017/07/lme4-random-effects/
# (1|tank/block) expands to (1|tank) + (1|tank/block)
model_AW13.1<-lmer(Av_juv_biomass~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     (1|Population_factor)+ 
                     (1|Tank_factor/Block_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW13.1)
AIC(model_AW13.1) #  -1880.678
summary(model_AW13.1)

#warning
## same as 13.1 but it is spelled out in full here
model_AW13.1.1<-lmer(Av_juv_biomass~
                       Region*Competition_level+ 
                       scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                       scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                       scaled_Mortality_tadsadded_26_06_21_percapita+
                       Days+
                       Mean_averageTemp+ #fixed effects
                       Block_factor+
                       (1|Tank_factor)+
                       (1|Population_factor)+ 
                       (1|Tank_factor:Block_factor), #random effects
                     data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW13.1.1)
AIC(model_AW13.1.1) #  -1880.678
summary(model_AW13.1.1)



######## BEST AS AT 19:06 ON 18.01.22
## same as 13.1.1 but no block as fixed
# (1|Tank_factor)+ (1|Tank_factor:Block_factor) IS THE SAME AS 1|Tank_factor/Block_factor)
#https://www.muscardinus.be/2017/07/lme4-random-effects/
model_AW13.1.2<-lmer(Av_juv_biomass~
                       Region*Competition_level+ 
                       scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                       scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                       scaled_Mortality_tadsadded_26_06_21_percapita+
                       Days+
                       Mean_averageTemp+ #fixed effects
                       #Block_factor+
                       (1|Tank_factor)+
                       (1|Population_factor)+ 
                       (1|Tank_factor:Block_factor), #random effects
                     data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW13.1.2)
AIC(model_AW13.1.2) #  -1880.371
summary(model_AW13.1.2)






# (1|Tank_factor:Block_factor)
model_AW13.2<-lmer(Av_juv_biomass~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     (1|Population_factor)+ 
                     (1|Tank_factor:Block_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW13.2)
AIC(model_AW13.2) #   -1882.678
summary(model_AW13.2)


## doesn't matter which way round factors are when using ":" - but includes nested when like this also need (1|Tank)
# https://www.muscardinus.be/2017/07/lme4-random-effects/
# (1|Region:Population_factor) (1|Block_factor:Tank_factor)
model_AW13.3<-lmer(Av_juv_biomass~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     (1|Region:Population_factor)+ 
                     (1|Block_factor:Tank_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW13.3)
AIC(model_AW13.3) #   -1882.678
summary(model_AW13.3)



## wrong order
model_AW14<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #(1|Days)+
                   (1|Region/Population_factor)+ 
                   (1|Block_factor/Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW14)
AIC(model_AW14) #  -1878.678
summary(model_AW14)



model_AW15<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   #Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   (1|Days)+
                   (1|Region/Population_factor)+ 
                   (1|Block_factor/Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW15)
AIC(model_AW15) #   -1861.245


model_AW16<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   (1|Daysfactor/Tank_factor)+
                   (1|Region/Population_factor)+ 
                   (1|Block_factor/Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW16)
AIC(model_AW16) #  -1878.678

model_AW17<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   #Block_factor+
                   #(1|Daysfactor/Tank_factor)+
                   (1|Region/Population_factor)+ 
                   (1|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW17)
AIC(model_AW17) #  -1973.923
summary(model_AW17)


model_AW18<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   Days+
                   Mean_averageTemp+ #fixed effects
                   #Block_factor+
                   #(1|Daysfactor/Tank_factor)+
                   #(1|Daysfactor/Tank_factor)+
                   (1|Population_factor)+ 
                   (1|Tank_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW18)
AIC(model_AW18) #  -1975.923
summary(model_AW18)


model_AW19<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   #Days+
                   Mean_averageTemp+ #fixed effects
                   #Block_factor+
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor)+ 
                   (1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW19)
AIC(model_AW19) #  -2051.718
summary(model_AW19)



model_AW20<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   X25.5.18_experiment_start_tapole_av_individual_weight+
                   Mortality_tadsadded_26_06_21_percapita+
                   #Days+
                   Mean_averageTemp+ #fixed effects
                   #Block_factor+
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW20)
AIC(model_AW20) #  -1950.88
summary(model_AW20)


model_AW21<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   #Days+
                   Mean_averageTemp+ #fixed effects
                   Block_factor+
                   #Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW21)
AIC(model_AW21) #  -2056.222
summary(model_AW21)


### best 18.01.22
model_AW21.1<-lmer(Av_juv_biomass~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_tadsadded_26_06_21_percapita+
                     Days+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days|Tank_factor)+
                     (1|Population_factor),
                   #(1|Block_factor), #random effects
                   data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW21.1)
AIC(model_AW21.1) # -2075.278
summary(model_AW21.1)



model_AW22<-lmer(Av_juv_biomass~
                   Region*Competition_level+ 
                   scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                   scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                   scaled_Mortality_tadsadded_26_06_21_percapita+
                   #Days+
                   scaled_Mean_averageTemp+ #fixed effects
                   Block_factor+
                   scaled_Total_chla_conc_26.7.18_ug.l+
                   #(1|Daysfactor)+
                   
                   #(1|Daysfactor/Tank_factor)+
                   (1+Days|Tank_factor)+
                   (1|Population_factor),
                 #(1|Block_factor), #random effects
                 data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_AW22)
AIC(model_AW22) #  -2056.8
summary(model_AW22)


## check if total algae conc and temp are correlated
plot(Rawdata_experimentAugust2018$Mean_averageTemp,Rawdata_experimentAugust2018$Total_chla_conc_26.7.18_ug.l)

# they are --- means can't have algae and temp in weight model.. which one?
## NB AIC of model with only algae, model w only temp and model with model all have almost identical AIC values
## also warnings with any of them...


############################################################################
################################## CUSTOM CONTRASTS ########################
############################################################################


emm3_model_avjuvweight=emmeans(model_AW29,specs=~ Competition_level*Region)

write.csv(emm3_model_avjuvweight,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/CIS_emmeans_avjuvbiomass_model_AW29_718.csv")


#make into dataframe
emm3_model_avjuvweightdf<-as.data.frame(emm3_model_avjuvweight)

#make new column
emm3_model_avjuvweightdf<-cbind(Model = "model_AW29", emm3_model_avjuvweightdf)



#create custom contrasts
Low_controlHG<-rep(c(1,0), times = c(1,7))
FrogMLHG<-rep(c(0,1,0), times = c(1,1,6))
FrogHGHG<-rep(c(0,1,0), times = c(2,1,5))
High_controlHG<-rep(c(0,1,0), times = c(3,1,4))
Low_controlML<-rep(c(0,1,0), times = c(4,1,3))
FrogMLML<-rep(c(0,1,0), times = c(5,1,2))
FrogHGML<-rep(c(0,1,0), times = c(6,1,1))
High_controlML<-rep(c(0,1), times = c(7,1))

#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_emm3_model_avjuvweight_frogregion_19_01_22<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


capture.output(contrast_emm3_model_avjuvweight_frogregion_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_frogregion_19_01_22_model_AW29_718.txt")




### include both frog region
(contrast_emm3_model_avjuvweight_6tests_includefrogregion_bonf_values_19_01_22<-contrast(emm3_model_avjuvweight,adjust="bonferroni",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML
  
)))


#718
capture.output(contrast_emm3_model_avjuvweight_6tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_6tests_includefrogregion_bonf_values_19_01_22_model_AW29_718.txt")
write.csv(contrast_emm3_model_avjuvweight_6tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_6tests_includefrogregion_bonf_values_19_01_22_model_AW29_718.csv")




### include both frog region
(contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML
  
)))


#718
capture.output(contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22_model_AW29_718.txt")
write.csv(contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22_model_AW29_718.csv")






### include both frog region
(contrast_emm3_model_avjuvweight_8tests_includefrogregion_anbetwnfrog_mvt_values_19_01_22<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML,
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


#718
#capture.output(contrast_emm3_model_avjuvweight_8tests_includefrogregion_anbetwnfrog_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_8tests_includefrogregion_anbetwnfrog_mvt_values_19_01_2_model_AW29_718.txt")
write.csv(contrast_emm3_model_avjuvweight_8tests_includefrogregion_anbetwnfrog_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_8tests_includefrogregion_anbetwnfrog_mvt_values_19_01_22_model_AW29_718.csv")




(contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22_TESTminus<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogHGHG - High_controlHG) - (FrogHGML - High_controlML),
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogMLHG  - High_controlHG) - (FrogMLML - High_controlML)
)))


write.csv(contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22_TESTminus,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_6tests_includefrogregion_mvt_values_19_01_22_TESTminus_model_AW29_718.csv")



(contrast_emm3_model_avjuvweight_6tests_includefrogregion_bothareas_mvt_values_19_01_22_TESTminus<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  # "FrogMLHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogHGHG - FrogMLML" = FrogMLHG - FrogMLML,
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogHGHG - High_controlHG) - (FrogHGML - High_controlML),
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogMLHG  - High_controlHG) - (FrogMLML - High_controlML),
  "(FrogHGHG - FrogHGML) - (FrogMLHG - FrogMLML)"  = (FrogHGHG - FrogHGML) - (FrogMLHG - FrogMLML)
)))


write.csv(contrast_emm3_model_avjuvweight_6tests_includefrogregion_bothareas_mvt_values_19_01_22_TESTminus,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_6tests_includefrogregion_bothareas_mvt_values_19_01_22_TESTminus_model_AW29_718.csv")


#including interspeciif - low intra
(contrast_emm3_model_avjuvweight_19_01_22<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))


#718
capture.output(contrast_emm3_model_avjuvweight_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_19_01_22_model_AW29_adjustmvt_718.txt")
write.csv(contrast_emm3_model_avjuvweight_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_19_01_22_model_AW29_adjustmvt_718.csv")

### bonferroni
(contrast_emm3_model_avjuvweight_19_01_22<-contrast(emm3_model_avjuvweight,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))




### has low vs low and high v high and low v high
(contrast_emm3_model_avjuvweight_mvt_lowvlow_19_01_22<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  
  "Low_controlML - High_controlML" =Low_controlML - High_controlML,
  "Low_controlHG - High_controlHG" =Low_controlHG - High_controlHG
  
)))

#718
capture.output(contrast_emm3_model_avjuvweight_mvt_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_mvt_lowvlow_19_01_22_model_AW29_adjustmvt_718.txt")

write.csv(contrast_emm3_model_avjuvweight_mvt_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_mvt_lowvlow_19_01_22_model_AW29_adjustmvt_718.csv")



# bonf
### has low vs low and high v high and low v high
(contrast_emm3_model_avjuvweight_bonf_lowvlow_19_01_22<-contrast(emm3_model_avjuvweight,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  
  "Low_controlML - High_controlML" =Low_controlML - High_controlML,
  "Low_controlHG - High_controlHG" =Low_controlHG - High_controlHG
  
)))



#718
capture.output(contrast_emm3_model_avjuvweight_bonf_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_bonf_lowvlow_19_01_22_model_AW29_adjustbonf_718.txt")

write.csv(contrast_emm3_model_avjuvweight_bonf_lowvlow_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_bonf_lowvlow_19_01_22_model_AW29_adjustbonf_718.csv")



#same as above but 2 less tests
(contrast_emm3_model_avjuvweight_mvt_lowvlow_7tests_19_01_22<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
  
)))


#718
capture.output(contrast_emm3_model_avjuvweight_mvt_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_mvt_lowvlow_7tests_19_01_22_model_AW29_adjustmvt_718.txt")

write.csv(contrast_emm3_model_avjuvweight_mvt_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_mvt_lowvlow_7tests_19_01_22_model_AW29_adjustmvt_718.csv")

# bonferroni same as above but 2 less tests
(contrast_emm3_model_avjuvweight_bonf_lowvlow_7tests_19_01_22<-contrast(emm3_model_avjuvweight,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
  
)))


#718
capture.output(contrast_emm3_model_avjuvweight_bonf_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_bonf_lowvlow_7tests_19_01_22_model_AW29_adjustmvt_718.txt")

write.csv(contrast_emm3_model_avjuvweight_bonf_lowvlow_7tests_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_bonf_lowvlow_7tests_19_01_22_model_AW29_adjustmvt_718.csv")



##############################
##########  PERCENT ############
#############################


#region HG, comp level low control - single out estimate for each level of region/competition to insect into contrast table later to calculate percent
HGLow_controlHG_model_avjuvweightdf<-emm3_model_avjuvweightdf[1,4]
HGFrogMLHG_model_avjuvweightdf<-emm3_model_avjuvweightdf[2,4]
HGFrogHGHG_model_avjuvweightdf<-emm3_model_avjuvweightdf[3,4]
HGHigh_controlHG_model_avjuvweightdf<-emm3_model_avjuvweightdf[4,4]
MLLow_controlML_model_avjuvweightdf<-emm3_model_avjuvweightdf[5,4] 
MLFrogMLML_model_avjuvweightdf<-emm3_model_avjuvweightdf[6,4]
MLFrogHGML_model_avjuvweightdf<-emm3_model_avjuvweightdf[7,4]
MLHigh_controlML_model_avjuvweightdf<-emm3_model_avjuvweightdf[8,4]
HGFrog_overallHG_model_avjuvweightdf<-(emm3_model_avjuvweightdf[2,4]+emm3_model_avjuvweightdf[3,4])/2
MLFrog_overallML_model_avjuvweightdf<-(emm3_model_avjuvweightdf[6,4]+emm3_model_avjuvweightdf[7,4])/2
ML_lowC_minus_highC_avjuvweightdf<-MLLow_controlML_model_avjuvweightdf-MLHigh_controlML_model_avjuvweightdf
HG_lowC_minus_highC_avjuvweightdf<-HGLow_controlHG_model_avjuvweightdf-HGHigh_controlHG_model_avjuvweightdf
ML_lowC_minus_inter_avjuvweightdf<-MLLow_controlML_model_avjuvweightdf-MLFrog_overallML_model_avjuvweightdf
HG_lowC_minus_inter_avjuvweightdf<-HGLow_controlHG_model_avjuvweightdf-HGFrog_overallHG_model_avjuvweightdf
ML_lowC_minus_highC_avjuvweightdf_MINUS_ML_lowC_minus_inter_avjuvweightdf<-ML_lowC_minus_highC_avjuvweightdf-ML_lowC_minus_inter_avjuvweightdf



(contrast_emm3_model_avjuvweight_19_01_22_PERCENT<-contrast(emm3_model_avjuvweight,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_model_avjuvweightdf)*100,
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_model_avjuvweightdf))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_model_avjuvweightdf))*100,
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_model_avjuvweightdf)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_model_avjuvweightdf)*100
  
  
)))



#718
write.csv(contrast_emm3_model_avjuvweight_19_01_22_PERCENT,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_19_01_22_PERCENT_model_AW29_adjustmvt_718.csv")

## bonferroni
(contrast_emm3_model_avjuvweight_19_01_22_PERCENT_bonf<-contrast(emm3_model_avjuvweight,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_model_avjuvweightdf)*100,
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_model_avjuvweightdf))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_model_avjuvweightdf))*100,
  
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_model_avjuvweightdf)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_model_avjuvweightdf)*100
  
  
)))


write.csv(contrast_emm3_model_avjuvweight_19_01_22_PERCENT_bonf,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_19_01_22_PERCENT_model_AW29_adjustbonf_718.csv")


#############
#### CONFIDENCE INTERVALS ####
##############

##############
(contrast_model_avjuvweight_bonf_CI_19_01_22<-contrast(emm3_model_avjuvweight,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "bonferroni")%>%
   confint())


write.csv(contrast_model_avjuvweight_bonf_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_model_avjuvweight_bonf_CI_19_01_22_model_AW29_718.csv")


(contrast_model_avjuvweight_mvt_CI_19_01_22<-contrast(emm3_model_avjuvweight,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "mvt")%>%
    confint())


write.csv(contrast_model_avjuvweight_mvt_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_model_avjuvweight_mvt_CI_19_01_22_model_AW29_718.csv")




######## no low but both frog regions ###

emm3_model_avjuvweight_nolow=emmeans(model_AW28,specs=~ Competition_level*Region)


#718
capture.output(emm3_model_avjuvweight_nolow,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_model_avjuvweight_nolow_model_AW28_CI_718_19_01_22.txt")
write.csv(emm3_model_avjuvweight_nolow,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_model_avjuvweight_nolow_model_AW28_CI_718_19_01_22.csv")




#make into dataframe
emm3_model_avjuvweight_nolowdf<-as.data.frame(emm3_model_avjuvweight_nolow)

#make new column
emm3_model_avjuvweight_nolowdf<-cbind(Model = "model_GR_toads_model_AW28", emm3_model_avjuvweight_nolowdf)



#create custom contrasts
FrogMLHG<-rep(c(1,0), times = c(1,5))
FrogHGHG<-rep(c(0,1,0), times = c(1,1,4))
High_controlHG<-rep(c(0,1,0), times = c(2,1,3))
FrogMLML<-rep(c(0,1,0), times = c(3,1,2))
FrogHGML<-rep(c(0,1,0), times = c(4,1,1))
High_controlML<-rep(c(0,1), times = c(5,1))


#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_emm3_model_avjuvweight_nolow_frogregion_mvt_19_01_22<-contrast(emm3_model_avjuvweight_nolow,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


capture.output(contrast_emm3_model_avjuvweight_nolow_frogregion_mvt_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosiscontrast_emm3_model_avjuvweight_nolow_frogregion_mvt_19_01_22_model_AW28_718.txt")


###for 
(contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22<-contrast(emm3_model_avjuvweight_nolow,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))



#718
capture.output(contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22_model_AW28_adjustmvt_718.txt")
write.csv(contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22_model_AW28_adjustmvt_718.csv")


#bonferroni
(contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22<-contrast(emm3_model_avjuvweight_nolow,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))



#718
capture.output(contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22_model_AW28_718.txt")
write.csv(contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22_model_AW28_718.csv")




###for 
(contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22_withfrogregion<-contrast(emm3_model_avjuvweight_nolow,adjust="mvt",method=list(
  "FrogMLHG - FrogMLML" =FrogMLHG - FrogMLML,
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG " = FrogMLHG - High_controlHG,
  
  "FrogMLML - High_controlML " = FrogMLML - High_controlML,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML
)))



#718
capture.output(contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22_withfrogregion_model_AW28_adjustmvt_718.txt")
write.csv(contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_mvt_values_19_01_22_withfrogregion_model_AW28_adjustmvt_718.csv")

###for 
(contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22_withfrogregion<-contrast(emm3_model_avjuvweight_nolow,adjust="bonferroni",method=list(
  "FrogMLHG - FrogMLML" =FrogMLHG - FrogMLML,
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG " = FrogMLHG - High_controlHG,
  
  "FrogMLML - High_controlML " = FrogMLML - High_controlML,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML
)))



#718
capture.output(contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22_withfrogregion_model_AW28_adjustbonf_718.txt")
write.csv(contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22_withfrogregion,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/contrast_emm3_model_avjuvweight_nolow_bonf_values_19_01_22_withfrogregion_model_AW28_adjustbonf_718.csv")






#################################
#################### PLOTS ######
################################




png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_mg_3comp_nolow_logscale_nofacet_539_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Av_juv_biomass_mg_3comp_nolow_logscale_nofacet<- Rawdata_experimentAugust2018_nolow%>%
    ggplot(aes(x=Competitior_Identity, y=Av_juv_biomass_mg,fill=Toad_Cooccurrence_History)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad co-occurrence history\nwith the NRLF",breaks=c("Short", "Long"),
                      labels=c("Short", "Long"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight\nat metamorphosis (mg)")+
    scale_x_discrete(breaks=c( "Toad_control","NRLF_ML","NRLF_HG"),
                     labels=c("High density\nToad control","NRLFs\nMainland","NRLFs\nHaida Gwaii" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_mg_3comp_nolow_logscale_nofacet_539_600res.svg", width = 200, height = 150, units = 'mm')
(boxplot_Av_juv_biomass_mg_3comp_nolow_logscale_nofacet<- Rawdata_experimentAugust2018_nolow%>%
    ggplot(aes(x=Competitior_Identity, y=Av_juv_biomass_mg,fill=Toad_Cooccurrence_History)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad co-occurrence history\nwith the NRLF",breaks=c("Short", "Long"),
                      labels=c("Short", "Long"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c( "Toad_control","NRLF_ML","NRLF_HG"),
                     labels=c("Toad high\ncontrol","NRLFs\nMainland","NRLFs\nHaida Gwaii" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()





labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")
Rawdata_experimentAugust2018$Region = factor(Rawdata_experimentAugust2018$Region, levels=c('ML','HG'))


ylim1 = boxplot.stats(Rawdata_experimentAugust2018$Av_juv_biomass)$stats[c(1, 5)]






#### comp x 4 no facet beautiful

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_comp4xregion_model_AW23_logscale_nofacet_718.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_19_01_22 <- Rawdata_experimentAugust2018%>%
    ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg,fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_comp4xregion_model_AW23_logscale_nofacet_718.svg",width = 200, height = 150, units = 'mm')
(boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_19_01_22 <- Rawdata_experimentAugust2018%>%
    ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg,fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






### days vs ave weight

labelsco <- c(ML = "Long Co-occurrence History", HG = "Short Co-occurrence History")
Rawdata_experimentAugust2018$Region = factor(Rawdata_experimentAugust2018$Region, levels=c('ML','HG'))
labelscomp<- c(High_control = "Toad high\ncontrol",FrogML ="NRLFs\nMainland",FrogHG ="NRLFs\nHaida Gwaii")

## 3 treatments x region X days
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Days_Av_juv_biomass_mg_3compxregion_nolow_model_MJ_AW6_540_600res.png", width = 220, height = 250, units = 'mm', res = 600)
(boxplot_Days_Av_juv_biomass_mg_3compxregion_logscale<- Rawdata_experimentAugust2018_nolow%>%
    ggplot(aes(x=Days, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_MJ_AW6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region,labeller = labeller(Region = labelsco,Competition_level =labelscomp))+
    labs(x="Days")+
    labs(y="Average toad weight at metamorphosis (mg)")+
  
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    #scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #  labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Days_Av_juv_biomass_mg_3compxregion_nolow_model_MJ_AW6_540_600res.svg", width = 220, height = 250)
(boxplot_Days_Av_juv_biomass_mg_3compxregion_logscale<- Rawdata_experimentAugust2018_nolow%>%
    ggplot(aes(x=Days, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_MJ_AW6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region,labeller = labeller(Region = labelsco,Competition_level =labelscomp))+
    labs(x="Days")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    #scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #  labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()

















#### comp x4 region
### plot on log scale

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_comp4xregion_model_AW23_logscale_718.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_19_01_22 <- Rawdata_experimentAugust2018%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #                "Low_control", #"Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #               labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_comp4xregion_model_AW23_logscale_718.svg",width = 200, height = 150,units="mm")
(boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_19_01_22 <- Rawdata_experimentAugust2018%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #                "Low_control", #"Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #               labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


#facet_wrap(~Region,labeller = labeller(Region = labels))+

labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")

## foiur treatments x region X days
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Days_Av_juv_biomass_mg_4compxregion_model_AW24_720_600res.png", width = 220, height = 250, units = 'mm', res = 600)
(boxplot_Days_Av_juv_biomass_mg_4compxregion_logscale<- Rawdata_experimentAugust2018_720%>%
    ggplot(aes(x=Days, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_AW24) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region,labeller = labeller(Region = labels))+
    labs(x="Days")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Days_Av_juv_biomass_mg_4compxregion_model_AW24_720_600res.svg", width = 220, height = 250)
(boxplot_Days_Av_juv_biomass_mg_4compxregion_logscale<- Rawdata_experimentAugust2018_720%>%
    ggplot(aes(x=Days, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_AW24) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region,labeller = labeller(Region = labels))+
    labs(x="Days")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()










# log scale per DAY
## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Av_juv_biomass_perday_model_3compxregion_model_AW24_logscale_720_600re.png", width = 200, height = 180, units = 'mm', res = 600)
(boxplot_Av_juv_biomass_mg_perday_logscale<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_AW24) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Av_juv_biomass_perday_model_3compxregion_model_AW24_logscale_720_600res.svg", width = 200, height = 180)
(boxplot_Av_juv_biomass_mg_perday_logscale<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_AW24) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




# log scale per mortality
## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Av_juv_biomass_permortality_model_3compxregion_model_AW25_logscale_720_600res.png", width = 200, height = 180, units = 'mm', res = 600)
(boxplot_Av_juv_biomass_mg_perMortality_logscale<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Mortality_06_05_20_percapita, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_AW25) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Mortality per capita")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/plot_Av_juv_biomass_permortality_model_3compxregion_model_AW25_logscale_720_600res.svg", width = 200, height = 180)
(boxplot_Av_juv_biomass_mg_perMortality_logscale<- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Mortality_06_05_20_percapita, y=Av_juv_biomass_mg)) +
    geom_point() +
    stat_summary(fun.data= model_AW25) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Mortality per capita")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



(boxplot_Competition_level_treat3_JUVWEIGHT_mg_19_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))



## plot per population
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_perpopulation_718.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_pops_21_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_perpopulation_718.svg",width = 200, height = 150)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_pops_21_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()




## save as svg and also save as four panel plot...

### plot on log scale

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_model_AW23_logscale_718.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_logscale_19_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_model_AW23_logscale_718.svg",width = 200, height = 150,units="mm")
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_logscale_19_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



#### comp x4 region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_comp4xregion_model_AW23_718.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_4_JUVWEIGHT_mg19_01_22 <- Rawdata_experimentAugust2018%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #                "Low_control", #"Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #               labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_comp4xregion_model_AW23_718.svg",width = 200, height = 150,units="mm")
(boxplot_Competition_level_4_JUVWEIGHT_mg_19_01_22 <- Rawdata_experimentAugust2018%>%
    #mutate(Treatment_three = fct_relevel(Treatment_three, 
    #                "Low_control", #"Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #               labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






### per pop
#log scale
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_perpopulation_logscale_718.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_pops_21_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_perpopulation_logscale_718.svg",width = 200, height = 150)
(boxplot_Competition_level_treat3_JUVWEIGHT_mg_pops_21_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Average toad weight at metamorphosis (mg)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()

### log
labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")


ylim1 = boxplot.stats(Rawdata_experimentAugust2018$log_Av_juv_biomass)$stats[c(1, 5)]

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_logged_model_AW23_718.png",width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Competition_level_treat3_log_JUVWEIGHT_mg_19_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=log10_Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="log(Average toad weight at metamorphosis (mg))")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/WeightatMetamorphosis/boxplot_Av_juv_biomass_logged_model_AW23_718.svg",width = 200, height = 150)
(boxplot_Competition_level_treat3_log_JUVWEIGHT_mg_19_01_22 <- Rawdata_experimentAugust2018%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Treatment_three, y=log10_Av_juv_biomass_mg)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="log(Average toad weight at metamorphosis (mg))")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()



############################################################################
############################################################################
############################# 3. MEDIAN TIME TO METAMORPHOSIS #############
#########################################################################
##################################################################################

#rm(list=ls())
### KEEP USING THE FILE USED FORGROWTH RATE AND WEIGHT AT METAMORPHOSIS!

#Rawdata_experimentAugust2018_indivrows2_median2_large<-read.csv(file="Rawdata_experimentAugust2018_indivrows2_median2_large.csv",header=T,row.names=NULL,sep=",")

#subset_dataRGRdd_renamedsomecolumns_2_10_20<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/subset_dataRGRdd_renamedsomecolumns_2_10_20.csv",header=T,row.names=NULL,sep=",")

#Rawdata_experimentAugust2018<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Rawdata_experiment_August_2018.csv",header=T,row.names=NULL,sep=",")



#order levels of factor
#Rawdata_experimentAugust2018$Competition_level<- factor(Rawdata_experimentAugust2018$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
#Rawdata_experimentAugust2018<- droplevels(Rawdata_experimentAugust2018)


########## how to calc MedianDays ################################
#make each toad have its own row and then run the code below
Rawdata_experimentAugust2018_indivrows2 <- as.data.frame(lapply(Rawdata_experimentAugust2018, rep, Rawdata_experimentAugust2018$Count_juv_emerged))


#cal median
Rawdata_experimentAugust2018_indivrows2_median2<-setDT(Rawdata_experimentAugust2018_indivrows2)[,list(MeanDays=mean(Days), MaxDays=max(Days), MinDays=min(Days), MedianDays=as.numeric(median(Days)), StdDays=sd(Days)), by=Tank]
dim(Rawdata_experimentAugust2018_indivrows2_median2) #70

#join to large dataset
Rawdata_experimentAugust2018_indivrows2_median2_large<-dplyr::left_join(Rawdata_experimentAugust2018_indivrows2_median2,subset_dataRGRdd_renamedsomecolumns_2_10_20,by="Tank")

#calc toad tadpoles percentage top up
Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percentagetotal<-(Rawdata_experimentAugust2018_indivrows2_median2_large$Tadpoles_added_as_top.up_june7thand8th/Rawdata_experimentAugust2018_indivrows2_median2_large$Total_number_individuals_start)*100

#### percapita tadpole additions due to diving beetle predation
Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percapita<-(Rawdata_experimentAugust2018_indivrows2_median2_large$Tadpoles_added_as_top.up_june7thand8th/Rawdata_experimentAugust2018_indivrows2_median2_large$Total_number_individuals_start)


## name new name
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity<-Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_level
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity<-as.character(Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity)
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity[Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity == "High_control"] <- "Toad_control" 
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity[Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity== "FrogHG"] <- "NRLF_HG" 
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity[Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity== "FrogML"] <- "NRLF_ML" 
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity<-as.factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity)

Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_Treatment<-Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitor_Identity<-Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity




#Write csv
#write.csv(Rawdata_experimentAugust2018_indivrows2_median2_large,"Rawdata_experimentAugust2018_indivrows2_median2_large.csv")

######## add mortality

##############
Mortalitydataset_26_06_2021<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortalitydataset_26_06_2021.csv",header=T,row.names=NULL,sep=",")

Rawdata_experimentAugust2018_indivrows2_median2_large<-left_join(Rawdata_experimentAugust2018_indivrows2_median2_large,Mortalitydataset_26_06_2021,by="Tank")

#order levels of factor
Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_level<- factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
Rawdata_experimentAugust2018_indivrows2_median2_large<- droplevels(Rawdata_experimentAugust2018_indivrows2_median2_large)



Rawdata_experimentAugust2018_indivrows2_median2_large$Block_factor<-as.factor((Rawdata_experimentAugust2018_indivrows2_median2_large$Block))

Rawdata_experimentAugust2018_indivrows2_median2_large$Tank_factor<-as.factor((Rawdata_experimentAugust2018_indivrows2_median2_large$Tank))





#####################################
######## CORRECT SCALING  i.e from 0 to 1 ############
########################

Rawdata_experimentAugust2018_indivrows2_median2_large$Mean_Average_Water_Temperature_Scaled<-(Rawdata_experimentAugust2018_indivrows2_median2_large$Mean_averageTemp-min(Rawdata_experimentAugust2018_indivrows2_median2_large$Mean_averageTemp))/(max(Rawdata_experimentAugust2018_indivrows2_median2_large$Mean_averageTemp)-min(Rawdata_experimentAugust2018_indivrows2_median2_large$Mean_averageTemp))


Rawdata_experimentAugust2018_indivrows2_median2_large$Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled<-(Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percapita-min(Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percapita))/(max(Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percapita)-min(Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percapita))


Rawdata_experimentAugust2018_indivrows2_median2_large$Average_Individual_Toad_Tadpole_Starting_Weight_Scaled<-(Rawdata_experimentAugust2018_indivrows2_median2_large$X25.5.18_experiment_start_tapole_av_individual_weight-min(Rawdata_experimentAugust2018_indivrows2_median2_large$X25.5.18_experiment_start_tapole_av_individual_weight))/(max(Rawdata_experimentAugust2018_indivrows2_median2_large$X25.5.18_experiment_start_tapole_av_individual_weight)-min(Rawdata_experimentAugust2018_indivrows2_median2_large$X25.5.18_experiment_start_tapole_av_individual_weight))


Rawdata_experimentAugust2018_indivrows2_median2_large$Toad_Mortality_per_Capita_Scaled<-(Rawdata_experimentAugust2018_indivrows2_median2_large$Mortality_06_05_20_percapita-min(Rawdata_experimentAugust2018_indivrows2_median2_large$Mortality_06_05_20_percapita))/(max(Rawdata_experimentAugust2018_indivrows2_median2_large$Mortality_06_05_20_percapita)-min(Rawdata_experimentAugust2018_indivrows2_median2_large$Mortality_06_05_20_percapita))


Rawdata_experimentAugust2018_indivrows2_median2_large$Days_Since_Experiment_Began_Scaled<-(Rawdata_experimentAugust2018_indivrows2_median2_large$Days-min(Rawdata_experimentAugust2018_indivrows2_median2_large$Days))/(max(Rawdata_experimentAugust2018_indivrows2_median2_large$Days)-min(Rawdata_experimentAugust2018_indivrows2_median2_large$Days))




###########################
############### SCALING #######
#################################


Xtemp <- Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percentagetotal

Xscaled <- (Xtemp - mean(Xtemp))/sd(Xtemp)
Rawdata_experimentAugust2018_indivrows2_median2_large$scaled_toadTadpoles_added_as_top.up_june7thand8th_percentagetotal <- Xscaled


Xtemp2 <- Rawdata_experimentAugust2018_indivrows2_median2_large$X25.5.18_experiment_start_tapole_av_individual_weight

Xscaled2 <- (Xtemp2 - mean(Xtemp2))/sd(Xtemp2)
Rawdata_experimentAugust2018_indivrows2_median2_large$scaled_X25.5.18_experiment_start_tapole_av_individual_weight <- Xscaled2


Xtemp3 <- Rawdata_experimentAugust2018_indivrows2_median2_large$toadTadpoles_added_as_top.up_june7thand8th_percapita

Xscaled3 <- (Xtemp3 - mean(Xtemp3))/sd(Xtemp3)
Rawdata_experimentAugust2018_indivrows2_median2_large$scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita <- Xscaled3



Xtemp4 <- Rawdata_experimentAugust2018_indivrows2_median2_large$Mortality_06_05_20_percapita

Xscaled4 <- (Xtemp4 - mean(Xtemp4))/sd(Xtemp4)
Rawdata_experimentAugust2018_indivrows2_median2_large$scaled_Mortality_06_05_20_percapita<- Xscaled4



Xtemp5 <- Rawdata_experimentAugust2018_indivrows2_median2_large$Mean_averageTemp
Xscaled5 <- (Xtemp5 - mean(Xtemp5))/sd(Xtemp5)
Rawdata_experimentAugust2018_indivrows2_median2_large$scaled_Mean_averageTemp<- Xscaled5





######  test normality #########
qqPlot(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)
shapiro.test(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)
hist(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)

#log - doesn't fix that well...
hist(log(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))
qqPlot(log(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))
shapiro.test(log(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))

#arcsine - didn't work
# delte NAs
Rawdata_experimentAugust2018_indivrows2_median2_large_noNA<-Rawdata_experimentAugust2018_indivrows2_median2_large[!is.na(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays),]

Rawdata_experimentAugust2018_indivrows2_median2_large_noNA$arcsin_MedianDays<-transf.arcsin(Rawdata_experimentAugust2018_indivrows2_median2_large_noNA$MedianDays)
hist(Rawdata_experimentAugust2018_indivrows2_median2_large_noNA$arcsin_MedianDays)

Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays_noNA<-drop_na(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)

Rawdata_experimentAugust2018_indivrows2_median2_large_noNA$MedianDays

#power - not good
hist((Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)^2)

# inverse, not good
hist(1/(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))


# log
Rawdata_experimentAugust2018_indivrows2_median2_large$log_MedianDays<-log(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)



# log10
Rawdata_experimentAugust2018_indivrows2_median2_large$log10_MedianDays<-log10(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)


# check normality of response
hist(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)
qqPlot(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)


#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/hist_MedianDays_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist((Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))
dev.off()




hist(log10(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))
qqPlot(log10(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))

#png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/hist_log10_MedianDays_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log10(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays))
dev.off()

### get means and standard errors
mediandaymean_72 <- Rawdata_experimentAugust2018_indivrows2_median2_large %>%
  group_by(Region,Competition_level)

mediandaymean_72<-mediandaymean_72 %>%
  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), MedianDays)

mediandaymean_72<-as.data.frame(mediandaymean_72)
mediandaymean_72

write.csv(mediandaymean_72,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Mean_sd_se_mediandaysmetamorph_72.csv")

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/hist_log10_MedianDays_model_MD4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_indivrows2_median2_large$log10_MedianDays)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/hist_MedianDays_model_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)
dev.off()



######### percent

mediandaymean_72minus<-mediandaymean_72


HGfrog_HGlowtoad=75.25000
HGhightoad=75.44444
HGfrog_MLlowtoad=68.11111
MLhightoad=76.66667 

###### HG frog and intra vs inter
mediandaymean_72minus$Contrast<-("HGfrog_HGlowtoad__HGhightoad")
#mediandaymean_72minus$mean_GR<-

#mediandaymean_72minus$mean_GR_PERCENT<-((HGfrog_HGlowtoad-HGhightoad)/HGfrog_HGlowtoad)*100

#mediandaymean_72minus$Contrast<-("HGfrog_MLlowtoad__MLhightoad")
#mediandaymean_72minus$mean_GR<-

#mediandaymean_72minus$Contrast<-("HGfrog_HGlowtoad__HGhightoad_MINUS_HGfrog_MLlowtoad__MLhightoad")

#mediandaymean_72minus$mean_GR<-((HGfrog_HGlowtoad-HGhightoad)-(HGfrog_MLlowtoad-MLhightoad))

#bad
#mediandaymean_72minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)-(HGfrog_MLlowtoad-MLhightoad))/(HGfrog_HGlowtoad-HGhightoad))*100

#mediandaymean_72minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)-((HGfrog_MLlowtoad-MLhightoad)/MLhightoad))*100

#toads grew (0.20  0.09 mg/day (mean  SE) (13.2%)) slower and emerged 26.8  6.0 mg (28.2%) lighter 

### intra vs inter
mediandaymean_72minus$mean_GR_PERCENT<-(((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)*100)



(((HGfrog_HGlowtoad-HGhightoad)/HGhightoad)*100)                                          
(((HGfrog_MLlowtoad-MLhightoad)/MLhightoad)*100)


### inter - HG vs ML toad
(HGfrog_HGlowtoad-HGfrog_MLlowtoad)
(((HGfrog_HGlowtoad-HGfrog_MLlowtoad)/HGfrog_MLlowtoad)*100) 




######################################
############ LMMER ############
#########################################



### order factors this way.... key!!!!!!!
Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity<- factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Competitior_Identity, levels = c("Toad_control","NRLF_HG","NRLF_ML","Low_control"))
Rawdata_experimentAugust2018_indivrows2_median2_large<- droplevels(Rawdata_experimentAugust2018_indivrows2_median2_large)

Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_Treatment<- factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_Treatment, levels = c("Toad_control","NRLF_HG","NRLF_ML","Low_control"))
Rawdata_experimentAugust2018_indivrows2_median2_large<- droplevels(Rawdata_experimentAugust2018_indivrows2_median2_large)



Rawdata_experimentAugust2018_indivrows2_median2_large$Toad_Cooccurrence_History<- factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Toad_Cooccurrence_History, levels = c("Long","Short"))
Rawdata_experimentAugust2018_indivrows2_median2_large<- droplevels(Rawdata_experimentAugust2018_indivrows2_median2_large)


summary(Rawdata_experimentAugust2018_indivrows2_median2_large)


Rawdata_experimentAugust2018_indivrows2_median2_large$Block<-as.factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Block)
Rawdata_experimentAugust2018_indivrows2_median2_large$Population<-as.factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Population)
Rawdata_experimentAugust2018_indivrows2_median2_large$Tank<-as.factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Tank)




###########################################
#### remove low treatment ############
######################################


Rawdata_experimentAugust2018_indivrows2_median2_large_nolow<-Rawdata_experimentAugust2018_indivrows2_median2_large
Rawdata_experimentAugust2018_indivrows2_median2_large_nolow<-Rawdata_experimentAugust2018_indivrows2_median2_large_nolow[!(Rawdata_experimentAugust2018_indivrows2_median2_large_nolow$Competition_level=="Low_control"),]
dim(Rawdata_experimentAugust2018_indivrows2_median2_large_nolow) #539  104




### BEST 16_02_22
#### model_MJ_MD6 ####
model_MJ_MD6<-lmer(MedianDays~
                           Toad_Cooccurrence_History*Competition_Treatment+ 
                           Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled+ 
                           Toad_Mortality_per_Capita_Scaled+
                           Block+
                           Mean_Average_Water_Temperature_Scaled+
                           #(1|Daysfactor/Tank_factor)+
                           (1|Population), 
                         #(1|Block_factor), #random effects
                         data=Rawdata_experimentAugust2018_indivrows2_median2_large_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))



car::Anova(model_MJ_MD6)
AIC(model_MJ_MD6) #   359.4783
summary(model_MJ_MD6)


capture.output(check_collinearity(model_MJ_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/collinearity_mediandaysmetamorph_model_MJ_MD6_54.txt")


#54
capture.output(anova(model_MJ_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MJ_MD6_54.txt")
capture.output(car::Anova(model_MJ_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MJ_MD6_54.txt")
write.csv(anova(model_MJ_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MJ_MD6_54.csv")
write.csv(car::Anova(model_MJ_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MJ_MD6_54.csv")
capture.output(summary(model_MJ_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MJ_MD6_54.txt")

capture.output(summary(model_MJ_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MJ_MD6_54.csv")

tab_model(model_MJ_MD6, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MJ_MD6_54.doc")

tab_model(model_MJ_MD6,show.df = TRUE,p.val = "kr",  file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MJ_MD6_54_df_pkr.doc")

#file didn't open
#tab_model(model_MJ_MD6,show.df = TRUE,p.val = "kr",  file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MJ_MD6_54_df_pkr.svg")



### test residuals - mostly ok
qqnorm(resid(model_MJ_MD6))
hist(resid(model_MJ_MD6))
plot(model_MJ_MD6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualsplot_model_MJ_MD6_54.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MJ_MD6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualshist_model_MJ_MD6_54.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MJ_MD6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/QQnorm_model_MJ_MD6_54.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MJ_MD6))
dev.off()



## interaction plots
(model_MJ_MD6.means <- interactionMeans(model_MJ_MD6))
plot(model_MJ_MD6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MJ_MD6_54.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MJ_MD6.means <- interactionMeans(model_MJ_MD6))
plot(model_MJ_MD6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MJ_MD6_54.svg", width = 8, height = 6.5)
(model_MJ_MD6.means <- interactionMeans(model_MJ_MD6))
plot(model_MJ_MD6.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_MD6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MJ_MD6_54.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_MD6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MJ_MD6_54.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MJ_MD6)
dev.off()



L.S_model_MJ_MD6_frog <- pairs(lsmeans(model_MJ_MD6, ~ Toad_Cooccurrence_History | Competition_Treatment))
test(L.S_model_MJ_MD6_frog, adjust = "tukey")

capture.output(test(L.S_model_MJ_MD6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MJ_MD6_frog_718.txt")
write.csv(test(L.S_model_MJ_MD6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MJ_MD6_frog_718.csv")


L.S_model_MJ_MD6_region <- pairs(lsmeans(model_MJ_MD6, ~ Competition_Treatment | Toad_Cooccurrence_History ))
test(L.S_model_MJ_MD6_region, adjust = "tukey")


capture.output(test(L.S_model_MJ_MD6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MJ_MD6_region_718.txt")
write.csv(test(L.S_model_MJ_MD6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MJ_MD6_region_718.csv")













#### model_MD6_clean ####
model_MD6_clean<-lmer(MedianDays~
                     Toad_Cooccurrence_History*Competition_Treatment+ 
                     Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled+ 
                     Toad_Mortality_per_Capita_Scaled+
                     Block+
                     Mean_Average_Water_Temperature_Scaled+
                     #(1|Daysfactor/Tank_factor)+
                     (1|Population), 
                   #(1|Block_factor), #random effects
                   data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))



car::Anova(model_MD6_clean)
AIC(model_MD6_clean) #   473.5184
summary(model_MD6_clean)


capture.output(check_collinearity(model_MD6_clean),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/collinearity_mediandaysmetamorph_model_MD6_clean_72.txt")


#72
capture.output(anova(model_MD6_clean),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD6_clean_72.txt")
capture.output(car::Anova(model_MD6_clean),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD6_clean_72.txt")
write.csv(anova(model_MD6_clean),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD6_clean_72.csv")
write.csv(car::Anova(model_MD6_clean),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD6_clean_72.csv")
capture.output(summary(model_MD6_clean),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD6_clean_72.txt")

capture.output(summary(model_MD6_clean),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD6_clean_72.csv")

tab_model(model_MD6_clean, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD6_clean_72.doc")

tab_model(model_MD6_clean,show.df = TRUE,p.val = "kr",  file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD6_clean_72_df_pkr.doc")

#file didn't open
#tab_model(model_MD6_clean,show.df = TRUE,p.val = "kr",  file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD6_clean_72_df_pkr.svg")



### test residuals - mostly ok
qqnorm(resid(model_MD6_clean))
hist(resid(model_MD6_clean))
plot(model_MD6_clean)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualsplot_model_MD6_clean_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD6_clean)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualshist_model_MD6_clean_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD6_clean))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/QQnorm_model_MD6_clean_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD6_clean))
dev.off()



## interaction plots
(model_MD6_clean.means <- interactionMeans(model_MD6_clean))
plot(model_MD6_clean.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD6_clean_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD6_clean.means <- interactionMeans(model_MD6_clean))
plot(model_MD6_clean.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD6_clean_72.svg", width = 8, height = 6.5)
(model_MD6_clean.means <- interactionMeans(model_MD6_clean))
plot(model_MD6_clean.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD6_clean)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD6_clean_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD6_clean)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD6_clean_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD6_clean)
dev.off()











L.S_model_MD6_clean_frog <- pairs(lsmeans(model_MD6_clean, ~ Toad_Cooccurrence_History | Competition_level))
test(L.S_model_MD6_clean_frog, adjust = "tukey")

capture.output(test(L.S_model_MD6_clean_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD6_clean_frog_718.txt")
write.csv(test(L.S_model_MD6_clean_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD6_clean_frog_718.csv")


L.S_model_MD6_clean_region <- pairs(lsmeans(model_MD6_clean, ~ Competition_level | Toad_Cooccurrence_History ))
test(L.S_model_MD6_clean_region, adjust = "tukey")


capture.output(test(L.S_model_MD6_clean_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD6_clean_region_718.txt")
write.csv(test(L.S_model_MD6_clean_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD6_clean_region_718.csv")








##################################



#### VERY IMPORTANT FOR CUSTOM CONTRASTS #####
#order levels of factor
Rawdata_experimentAugust2018_indivrows2_median2_large$Region<- factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Region, levels = c("HG","ML"))
Rawdata_experimentAugust2018_indivrows2_median2_large<- droplevels(Rawdata_experimentAugust2018_indivrows2_median2_large)

###########



#### best model 26.01.22 - block factor and 
#### model_MD6 ####
model_MD6<-lmer(MedianDays~
                  Region*Competition_level+ 
                  toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


car::Anova(model_MD6)
AIC(model_MD6) #   473.5184
summary(model_MD6)


capture.output(check_collinearity(model_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/collinearity_mediandaysmetamorph_model_MD6_72.txt")


#72
capture.output(anova(model_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD6_72.txt")
capture.output(car::Anova(model_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD6_72.txt")
write.csv(anova(model_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD6_72.csv")
write.csv(car::Anova(model_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD6_72.csv")
capture.output(summary(model_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD6_72.txt")

capture.output(summary(model_MD6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD6_72.csv")

tab_model(model_MD6, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD6_72.doc")

tab_model(model_MD6,show.df = TRUE,p.val = "kr",  file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD6_72_df_pkr.doc")

#file didn't open
#tab_model(model_MD6,show.df = TRUE,p.val = "kr",  file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD6_72_df_pkr.svg")



### test residuals - mostly ok
qqnorm(resid(model_MD6))
hist(resid(model_MD6))
plot(model_MD6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualsplot_model_MD6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualshist_model_MD6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/QQnorm_model_MD6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD6))
dev.off()



## interaction plots
(model_MD6.means <- interactionMeans(model_MD6))
plot(model_MD6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD6.means <- interactionMeans(model_MD6))
plot(model_MD6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD6_72.svg", width = 8, height = 6.5)
(model_MD6.means <- interactionMeans(model_MD6))
plot(model_MD6.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD6_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD6_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD6)
dev.off()











### region * temp
#### model_MD7 ####
model_MD7<-lmer(MedianDays~
                  Region*Competition_level+ 
                  toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  #Days+
                  Mean_averageTemp*Region+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


Anova(model_MD7)
AIC(model_MD7) #   473.3156
summary(model_MD7)


capture.output(check_collinearity(model_MD7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/collinearity_mediandaysmetamorph_model_MD7_72.txt")


#72
capture.output(anova(model_MD7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD7_72.txt")
capture.output(Anova(model_MD7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD7_72.txt")
write.csv(anova(model_MD7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD7_72.csv")
write.csv(Anova(model_MD7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD7_72.csv")
capture.output(summary(model_MD7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD7_72.txt")



tab_model(model_MD7, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD7_72.doc")




### test residuals - mostly ok
qqnorm(resid(model_MD7))
hist(resid(model_MD7))
plot(model_MD7)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualsplot_model_MD7_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD7)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualshist_model_MD7_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD7))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/QQnorm_model_MD7_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD7))
dev.off()



## interaction plots
(model_MD7.means <- interactionMeans(model_MD7))
plot(model_MD7.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD7_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD7.means <- interactionMeans(model_MD7))
plot(model_MD7.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD7_72.svg", width = 8, height = 6.5)
(model_MD7.means <- interactionMeans(model_MD7))
plot(model_MD7.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD7)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD7_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD7)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD7_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD7)
dev.off()

















###########################################################
########### Jen suggestion, remove low treatments ########
##########################################################
dim(Rawdata_experimentAugust2018_indivrows2_median2_large) # 72 269

Rawdata_experimentAugust2018_indivrows2_median2_large_nolow<-Rawdata_experimentAugust2018_indivrows2_median2_large
Rawdata_experimentAugust2018_indivrows2_median2_large_nolow<-Rawdata_experimentAugust2018_indivrows2_median2_large_nolow[!(Rawdata_experimentAugust2018_indivrows2_median2_large_nolow$Competition_level=="Low_control"),]
dim(Rawdata_experimentAugust2018_indivrows2_median2_large_nolow) # 52 269



Rawdata_experimentAugust2018_indivrows2_median2_large_nolow$Treatment_three<-as.factor(Rawdata_experimentAugust2018_indivrows2_median2_large_nolow$Treatment_three)


### get means and standard errors
mediandaymean_52 <- Rawdata_experimentAugust2018_indivrows2_median2_large_nolow %>%
  group_by(Region,Competition_level)

mediandaymean_52<-mediandaymean_52 %>%
  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), MedianDays)

mediandaymean_52<-as.data.frame(mediandaymean_52)
mediandaymean_52

write.csv(mediandaymean_52,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Mean_sd_se_mediandaysmetamorph_52.csv")


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/hist_log10_MedianDays_model_MD4_52.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_indivrows2_median2_large_nolow$log10_MedianDays)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/hist_MedianDays_model_52.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_indivrows2_median2_large_nolow$MedianDays)
dev.off()










#### model_MD5 ####
model_MD5<-lmer(MedianDays~
                  Region*Competition_level+ 
                  toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_indivrows2_median2_large_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


anova(model_MD5)
AIC(model_MD5) #   360.7994
summary(model_MD5)





#52
capture.output(anova(model_MD5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD5_52.txt")
write.csv(anova(model_MD5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD5_52.csv")
write.csv(Anova(model_MD5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD5_52.csv")
capture.output(Anova(model_MD5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD5_52.txt")

capture.output(summary(model_MD5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD5_52.txt")


tab_model(model_MD5, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD5_52.doc")


### test residuals - mostly ok
qqnorm(resid(model_MD5))
hist(resid(model_MD5))
plot(model_MD5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualsplot_model_MD5_52.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD5)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualshist_model_MD5_52.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD5))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/QQnorm_model_MD5_52.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD5))
dev.off()



## interaction plots
(model_MD5.means <- interactionMeans(model_MD5))
plot(model_MD5.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD5_52.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD5.means <- interactionMeans(model_MD5))
plot(model_MD5.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD5_52.svg", width = 8, height = 6.5)
(model_MD5.means <- interactionMeans(model_MD5))
plot(model_MD5.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD5_52.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD5)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD5_52.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD5)
dev.off()





######## no low but both frog regions ###

L.S_model_MD5_frog <- pairs(lsmeans(model_MD5, ~ Region | Competition_level))
test(L.S_model_MD5_frog, adjust = "tukey")


capture.output(test(L.S_model_MD5_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD5_frog_52.txt")
write.csv(test(L.S_model_MD5_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD5_frog_52.csv")


L.S_model_MD5_region <- pairs(lsmeans(model_MD5, ~ Competition_level | Region ))
test(L.S_model_MD5_region, adjust = "tukey")


capture.output(test(L.S_model_MD5_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD5_region_52.txt")
write.csv(test(L.S_model_MD5_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/L.S_model_MD5_region_52.csv")


### no low ########
#### model_MD4 ####
model_MD4<-lmer(log10_MedianDays~
                  Region*Competition_level+ 
                  toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_indivrows2_median2_large_nolow,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


anova(model_MD4)
AIC(model_MD4) #   -168.8964
summary(model_MD4)





#52
capture.output(anova(model_MD4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD4_52.txt")
write.csv(anova(model_MD4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD4_52.csv")
write.csv(Anova(model_MD4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_mediandaysmetamorph_model_MD4_52.csv")
capture.output(Anova(model_MD4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_mediandaysmetamorph_model_MD4_52.txt")

capture.output(summary(model_MD4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD4_52.txt")


tab_model(model_MD4, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD4_52.doc")


### test residuals - mostly ok
qqnorm(resid(model_MD4))
hist(resid(model_MD4))
plot(model_MD4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualsplot_model_MD4_52.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD4)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualshist_model_MD4_52.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD4))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/QQnorm_model_MD4_52.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD4))
dev.off()



## interaction plots
(model_MD4.means <- interactionMeans(model_MD4))
plot(model_MD4.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD4_52.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD4.means <- interactionMeans(model_MD4))
plot(model_MD4.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD4_52.svg", width = 8, height = 6.5)
(model_MD4.means <- interactionMeans(model_MD4))
plot(model_MD4.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD4_52.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD4)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD4_52.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD4)
dev.off()





######## no low but both frog regions ###

L.S_model_MD4_frog <- pairs(lsmeans(model_MD4, ~ Region | Competition_level))
test(L.S_model_MD4_frog, adjust = "tukey")



L.S_model_MD4_region <- pairs(lsmeans(model_MD4, ~ Competition_level | Region ))
test(L.S_model_MD4_region, adjust = "tukey")























#### best model 26.01.22 - block factor and logged 10 response
#### model_MD3 ####
model_MD3<-lmer(log10_MedianDays~
                  Region*Competition_level+ 
                  toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


anova(model_MD3)
AIC(model_MD3) #   -236.7262
summary(model_MD3)





#72
capture.output(anova(model_MD3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD3_72.txt")
capture.output(Anova(model_MD3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD3_72.txt")
write.csv(anova(model_MD3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD3_72.csv")
write.csv(Anova(model_MD3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Anova_chisq_mediandaysmetamorph_model_MD3_72.csv")
capture.output(summary(model_MD3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD3_72.txt")



tab_model(model_MD3, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/tab_model_mediandaysmetamorph_model_MD3_72.doc")




### test residuals - mostly ok
qqnorm(resid(model_MD3))
hist(resid(model_MD3))
plot(model_MD3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualsplot_model_MD3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD3)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/Residualshist_model_MD3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD3))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/QQnorm_model_MD3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD3))
dev.off()



## interaction plots
(model_MD3.means <- interactionMeans(model_MD3))
plot(model_MD3.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD3.means <- interactionMeans(model_MD3))
plot(model_MD3.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD3_72.svg", width = 8, height = 6.5)
(model_MD3.means <- interactionMeans(model_MD3))
plot(model_MD3.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD3_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD3)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD3_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD3)
dev.off()
















#### best model 19.01.22 - block factor and logged response
## model_MD1.2 ####
model_MD1.2<-lmer(log_MedianDays~
                    Region*Competition_level+ 
                    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    #Days+
                    Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    #(1|Tank_factor)+
                    (1|Population),
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


anova(model_MD1.2)
AIC(model_MD1.2) #   -119.9616
summary(model_MD1.2)



#72
#capture.output(anova(model_MD1.2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mediandaysmetamorph_model_MD1.2_72.txt")
write.csv(anova(model_MD1.2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mediandaysmetamorph_model_MD1.2_72.csv")
#capture.output(summary(model_MD1.2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_mediandaysmetamorph_model_MD1.2_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_MD1.2))
hist(resid(model_MD1.2))
plot(model_MD1.2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_MD1.2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD1.2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_MD1.2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD1.2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_MD1.2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD1.2))
dev.off()



## interaction plots
(model_MD1.2.means <- interactionMeans(model_MD1.2))
plot(model_MD1.2.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD1.2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD1.2.means <- interactionMeans(model_MD1.2))
plot(model_MD1.2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD1.2_72.svg", width = 8, height = 6.5)
(model_MD1.2.means <- interactionMeans(model_MD1.2))
plot(model_MD1.2.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD1.2_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD1.2_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.2)
dev.off()



#### Mortality_tadsadded_26_06_21_percapita
model_MD2<-lmer(log_MedianDays~
                  Region*Competition_level+ 
                  toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_tadsadded_26_06_21_percapita+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_MD2)
AIC(model_MD2) #  -117.5634
summary(model_MD2)




#72
#capture.output(anova(model_MD2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mediandaysmetamorph_model_MD2_72.txt")
write.csv(anova(model_MD2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mediandaysmetamorph_model_MD2_72.csv")
capture.output(summary(model_MD2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_mediandaysmetamorph_model_MD2_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_MD2))
hist(resid(model_MD2))
plot(model_MD2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_MD2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MD2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_MD2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MD2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_MD2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MD2))
dev.off()



## interaction plots
(model_MD2.means <- interactionMeans(model_MD2))
plot(model_MD2.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD2.means <- interactionMeans(model_MD2))
plot(model_MD2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD2_72.svg", width = 8, height = 6.5)
(model_MD2.means <- interactionMeans(model_MD2))
plot(model_MD2.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD2_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD2_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD2)
dev.off()



## traditional anaova
anova_model_MD1.2<-aov(log_MedianDays~
                         Region*Competition_level+ 
                         toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         X25.5.18_experiment_start_tapole_av_individual_weight+
                         Mortality_06_05_20_percapita+
                         #Days+
                         Mean_averageTemp+ #fixed effects
                         Block_factor,
                       #Total_chla_conc_26.7.18_ug.l+
                       #(1|Daysfactor)+
                       
                       #(1|Daysfactor/Tank_factor)+
                       #(1|Tank_factor)+
                       # (1|Population),
                       #(1|Block_factor), #random effects
                       data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude)

anova(anova_model_MD1.2)
AIC(anova_model_MD1.2) #   -121.9616
summary(anova_model_MD1.2)



####  same as 1.3 but no logged response ---  block factor no log
model_MD1.3<-lmer(MedianDays~
                    Region*Competition_level+ 
                    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    #Days+
                    Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    #(1|Tank_factor)+
                    (1|Population),
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_MD1.3)
AIC(model_MD1.3) #  473.5184
summary(model_MD1.3)


### test residuals - mostly ok
qqnorm(resid(model_MD1.3))
hist(resid(model_MD1.3))
plot(model_MD1.3)

#72
write.csv(anova(model_MD1.3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/anova_mediandaysmetamorph_model_MD1.3_72.csv")
capture.output(summary(model_MD1.3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/summary_mediandaysmetamorph_model_MD1.3_72.txt")


## interaction plots
(model_MD1.3.means <- interactionMeans(model_MD1.3))
plot(model_MD1.3.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD1.3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD1.3.means <- interactionMeans(model_MD1.3))
plot(model_MD1.3.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/interactionMeans_model_MD1.3_72.svg", width = 8, height = 6.5)
(model_MD1.3.means <- interactionMeans(model_MD1.3))
plot(model_MD1.3.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD1.3_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.3)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/visreg_model_MD1.3_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.3)
dev.off()






#### log
model_MD1.1<-lmer(log_MedianDays~
                    Region*Competition_level+ 
                    toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    #Days+
                    Mean_averageTemp+ #fixed effects
                    Block+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    #(1|Tank_factor)+
                    (1|Population),
                  #(1|Block_factor), #random effects
                  data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_MD1.1)
AIC(model_MD1.1) #  -121.8493
summary(model_MD1.1)


### test residuals - mostly ok
qqnorm(resid(model_MD1.1))
hist(resid(model_MD1.1))
plot(model_MD1.1)

#72
#capture.output(anova(model_MD1.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mediandaysmetamorph_model_MD1.1_72.txt")
#capture.output(summary(model_MD1.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_mediandaysmetamorph_model_MD1.1_72.txt")


## interaction plots
(model_MD1.1.means <- interactionMeans(model_MD1.1))
plot(model_MD1.1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD1.1_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD1.1.means <- interactionMeans(model_MD1.1))
plot(model_MD1.1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD1.1_72.svg", width = 8, height = 6.5)
(model_MD1.1.means <- interactionMeans(model_MD1.1))
plot(model_MD1.1.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD1.1_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD1.1_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.1)
dev.off()

## no log
model_MD1<-lmer(MedianDays~
                  Region*Competition_level+ 
                  toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_MD1)
AIC(model_MD1) #  471.5541
summary(model_MD1)


#72
#capture.output(anova(model_MD1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mediandaysmetamorph_model_MD1_72.txt")
#capture.output(summary(model_MD1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_mediandaysmetamorph_model_MD1_72.txt")



### test residuals - mostly ok
qqnorm(resid(model_MD1))
hist(resid(model_MD1))
plot(model_MD1)

(model_MD1.means <- interactionMeans(model_MD1))
plot(model_MD1.means)

#par(mfrow=c(1, 1))
#par(mar = c(bottom, left, top, right))
#par(mar = c(2, 2, 2, 2))

# interaction plots
(model_MD1.means <- interactionMeans(model_MD1))
plot(model_MD1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD1_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MD1.means <- interactionMeans(model_MD1))
plot(model_MD1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MD1_72.svg", width = 12, height = 6.5)
(model_MD1.means <- interactionMeans(model_MD1))
plot(model_MD1.means)
dev.off()

# visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1.1)



png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD1_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MD1_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MD1)
dev.off()





### added mortality
timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality<-lmer(MedianDays~
                                                                            Region*Competition_level +
                                                                            toadTadpoles_added_as_top.up_june7thand8th_percapita+
                                                                            X25.5.18_experiment_start_tapole_av_individual_weight+
                                                                            Mean_averageTemp+ #fixed effects
                                                                            Mortality_06_05_20_percapita +
                                                                            (1|Population),
                                                                          data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=TRUE,control=lmerControl(check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4))) 

anova(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality)
AIC(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality)  #433.1097

"Type III Analysis of Variance Table with Satterthwaite's method
                                                       Sum Sq Mean Sq NumDF  DenDF F value    Pr(>F)    
Region                                                  50.47   50.47     1  3.874  1.3166 0.3170932    
Competition_level                                     1447.61  482.54     3 54.476 12.5884 2.306e-06 ***
toadTadpoles_added_as_top.up_june7thand8th_percapita    23.53   23.53     1 57.666  0.6138 0.4365711    
X25.5.18_experiment_start_tapole_av_individual_weight    0.05    0.05     1  5.079  0.0014 0.9715859    
Mean_averageTemp                                       461.50  461.50     1 57.955 12.0396 0.0009898 ***
Mortality_06_05_20_percapita                           669.88  669.88     1 57.445 17.4757 0.0001004 ***
Region:Competition_level                               499.36  166.45     3 54.585  4.3424 0.0081491 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"


#write.csv(anova(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality_REMLTRUE_011220.csv")

#capture.output(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/model_timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality_REMLTRUE_011220.txt")


######## tadpole percent top up
#capture.output(anova(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality),file="anova_timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality_REMLTRUE_291120.txt")

#capture.output(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality,file="timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality_REMLTRUE_291120.txt")


################# no mortality
timetotoadmeta_toad_emergencemodel_median_june5_nocaptive<-lmer(MedianDays~
                                                                  Region*Competition_level +
                                                                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percentagetotal+
                                                                  X25.5.18_experiment_start_tapole_av_individual_weight+
                                                                  Mean_averageTemp+ #fixed effects
                                                                  (1|Population),
                                                                data=Rawdata_experimentAugust2018_indivrows2_median2_large,na.action=na.exclude,REML=TRUE,control=lmerControl(check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4))) 

anova(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive)
AIC(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive)  #441.7858


#interaction plot
timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_interaction<- 
  effect('Region*Competition_level', 
         timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality,
         se=TRUE)
(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_interactionplot<-
    plot(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_interaction, multiline = TRUE))

#capture.output(anova(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive),file="anova_timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_REMLTRUE.txt")
#capture.output(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive,file="timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_REMLTRUE.txt")


#capture.output(anova(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive),file="anova_timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_REMLFALSE.txt")
#capture.output(timetotoadmeta_toad_emergencemodel_median_june5_nocaptive,file="timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_REMLFALSE.txt")



############################################################################
################################## CUSTOM CONTRASTS ########################
############################################################################

emm3_model_timetotoadmeta_toad_emergence_mediandays=emmeans(model_MD7,specs=~ Competition_level*Region)


write.csv(emm3_model_timetotoadmeta_toad_emergence_mediandays,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/CI_emm3_model_timetotoadmeta_toad_emergence_mediandays_19_02_22_model_model_MD6_72.csv")

#make into dataframe
emm3_model_timetotoadmeta_toad_emergence_mediandaysdf<-as.data.frame(emm3_model_timetotoadmeta_toad_emergence_mediandays)

#make new column
emm3_model_timetotoadmeta_toad_emergence_mediandaysdf<-cbind(Model = "timetotoadmeta_toad_emergencemodel_median_june5_nocaptive_mortality", emm3_model_timetotoadmeta_toad_emergence_mediandaysdf)



#create custom contrasts
Low_controlHG<-rep(c(1,0), times = c(1,7))
FrogMLHG<-rep(c(0,1,0), times = c(1,1,6))
FrogHGHG<-rep(c(0,1,0), times = c(2,1,5))
High_controlHG<-rep(c(0,1,0), times = c(3,1,4))
Low_controlML<-rep(c(0,1,0), times = c(4,1,3))
FrogMLML<-rep(c(0,1,0), times = c(5,1,2))
FrogHGML<-rep(c(0,1,0), times = c(6,1,1))
High_controlML<-rep(c(0,1), times = c(7,1))

#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2




### test frog region doesn't have effect for both toad regions
(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_frogregion_mvt_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))



#72
write.csv(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_frogregion_mvt_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_frogregion_mvt_19_01_22_model_model_MD6_72.csv")



### include both frog region - 6 TESTS
(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_bonf_values_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="bonferroni",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML
  
)))


#72
capture.output(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_bonf_values_19_01_22_model_MD6_72.txt")
write.csv(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_bonf_values_19_01_22_model_MD6_72.csv")


### include both frog region - 6 TESTS - mvt
(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML
  
)))


#72
capture.output(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22_model_MD6_72.txt")
write.csv(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22_model_MD6_72.csv")


(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML,
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


#72
capture.output(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22_model_MD6_72.txt")
write.csv(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_anbtwnfrog_mvt_values_19_01_22_model_MD6_72.csv")







### include both frog region 8 TESTS
(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_bonf_values_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="bonferroni",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogMLHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogHGHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogHGHG - High_controlHG" = FrogHGHG - High_controlHG,
  "FrogMLHG - High_controlHG" = FrogMLHG - High_controlHG,
  "FrogHGML - High_controlML" = FrogHGML - High_controlML,
  "FrogMLML - High_controlML" = FrogMLML - High_controlML
  
)))


#718
capture.output(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_bonf_values_19_01_22_model_MD6_72.txt")
write.csv(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_bonf_values_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_8tests_includefrogregion_bonf_values_19_01_22_model_MD6_72.csv")






(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22_TESTminus<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogHGHG - High_controlHG) - (FrogHGML - High_controlML),
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogMLHG  - High_controlHG) - (FrogMLML - High_controlML)
)))


write.csv(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22_TESTminus,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_mvt_values_19_01_22_TESTminus_model_MD6_72.csv")



(contrast_emm3_model_timetotoadmeta_toad_emergence_mediandays_6tests_includefrogregion_bothareas_mvt_values_19_01_22_TESTminus<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "FrogHGHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogMLHG - FrogMLML" = FrogMLHG - FrogMLML,
  "FrogMLHG - FrogHGML" = FrogHGHG - FrogHGML,
  "FrogHGHG - FrogMLML" = FrogMLHG - FrogMLML,
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogHGHG - High_controlHG) - (FrogHGML - High_controlML),
  "(FrogHGHG - High_controlHG) - (FrogHGML - High_controlML)" = (FrogMLHG  - High_controlHG) - (FrogMLML - High_controlML)
)))







## mvt
(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))


#72
write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_19_01_22_model_model_MD6_72.csv")


## bonferroni
(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonferroni_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))



#72
write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonferroni_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonferroni_19_01_22_model_model_MD6_72.csv")


### low vs high, low vs low, high vs high
(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_lowvlow_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  
  "Low_controlML - High_controlML" =Low_controlML - High_controlML,
  "Low_controlHG - High_controlHG" =Low_controlHG - High_controlHG
)))



#72
write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_lowvlow_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_lowvlow_19_01_22_model_model_MD6_72.csv")


#bonf
### low vs high, low vs low, high vs high
(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonf_lowvlow_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  
  "Low_controlML - High_controlML" =Low_controlML - High_controlML,
  "Low_controlHG - High_controlHG" =Low_controlHG - High_controlHG
)))





#72
write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonf_lowvlow_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonf_lowvlow_19_01_22_model_model_MD6_72.csv")


# 7 tests
### low vs high, low vs low, high vs high
(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_lowvlow_7tests_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#72
write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_values_mvt_lowvlow_7tests_19_01_22_model_model_MD6_72.csv")



# 7 tests
### low vs high, low vs low, high vs high
(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonf_lowvlow_7tests_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#72
write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonf_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_values_bonf_lowvlow_7tests_19_01_22_model_model_MD6_72.csv")

################################
########## PERCENT ###########
############################
#region HG, comp level low control - single out estimate for each level of region/competition to insect into contrast table later to calculate percent
HGLow_controlHG_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[1,4]
HGFrogMLHG_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[2,4]
HGFrogHGHG_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[3,4]
HGHigh_controlHG_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[4,4]
MLLow_controlML_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[5,4]
MLFrogMLML_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[6,4]
MLFrogHGML_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[7,4]
MLHigh_controlML_model_timetotoadmeta_toad_emergencedf<-emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[8,4]
HGFrog_overallHG_model_timetotoadmeta_toad_emergencedf<-(emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[2,4]+emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[3,4])/2
MLFrog_overallML_model_timetotoadmeta_toad_emergencedf<-(emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[6,4]+emm3_model_timetotoadmeta_toad_emergence_mediandaysdf[7,4])/2
ML_lowC_minus_highC_timetotoadmeta_toad_emergencedf<-MLLow_controlML_model_timetotoadmeta_toad_emergencedf-MLHigh_controlML_model_timetotoadmeta_toad_emergencedf
HG_lowC_minus_highC_timetotoadmeta_toad_emergencedf<-HGLow_controlHG_model_timetotoadmeta_toad_emergencedf-HGHigh_controlHG_model_timetotoadmeta_toad_emergencedf
ML_lowC_minus_inter_timetotoadmeta_toad_emergencedf<-MLLow_controlML_model_timetotoadmeta_toad_emergencedf-MLFrog_overallML_model_timetotoadmeta_toad_emergencedf
HG_lowC_minus_highC_MINUS_HG_lowC_minus_inter_timetotoadmeta_toad_emergencedf<-HGLow_controlHG_model_timetotoadmeta_toad_emergencedf-HGFrog_overallHG_model_timetotoadmeta_toad_emergencedf
ML_lowC_minus_highC_MINUS_ML_lowC_minus_inter_timetotoadmeta_toad_emergencedf<-ML_lowC_minus_highC_timetotoadmeta_toad_emergencedf-ML_lowC_minus_inter_timetotoadmeta_toad_emergencedf





(contrast_model_timetotoadmeta_toad_emergence_mediandays_PERCENT_mvt_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_model_timetotoadmeta_toad_emergencedf)*100,
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_model_timetotoadmeta_toad_emergencedf))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_model_timetotoadmeta_toad_emergencedf))*100,
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_model_timetotoadmeta_toad_emergencedf)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_model_timetotoadmeta_toad_emergencedf)*100
  
  
  
)))



write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_PERCENT_mvt_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_PERCENT_mvt_19_01_22_model_model_MD3_72.csv")


### bonferroni
(contrast_model_timetotoadmeta_toad_emergence_mediandays_PERCENT_bonf_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_model_timetotoadmeta_toad_emergencedf)*100,
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_model_timetotoadmeta_toad_emergencedf))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_model_timetotoadmeta_toad_emergencedf))*100,
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_model_timetotoadmeta_toad_emergencedf)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_model_timetotoadmeta_toad_emergencedf)*100
  
  
  
  
  
)))



#72 
write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_PERCENT_bonf_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_PERCENT_bonf_19_01_22_model_model_MD3_72.csv")



#############
#### CONFIDENCE INTERVALS ####
##############

(contrast_model_timetotoadmeta_toad_emergence_mediandays_bonf_CI_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "bonferroni")%>%
   confint())



write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_bonf_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_bonf_CI_19_01_22_model_MD3_72.csv")


(contrast_model_timetotoadmeta_toad_emergence_mediandays_mvt_CI_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "mvt")%>%
    confint())



write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_mvt_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_mvt_CI_19_01_22_model_MD3_72.csv")


##more estimates
(contrast_model_timetotoadmeta_toad_emergence_mediandays_bonf_lowvlow_CI_19_01_22<-contrast(emm3_model_timetotoadmeta_toad_emergence_mediandays,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  
  "Low_controlML - High_controlML" =Low_controlML - High_controlML,
  "Low_controlHG - High_controlHG" =Low_controlHG - High_controlHG),
  adjust = "bonferroni")%>%
    confint())



write.csv(contrast_model_timetotoadmeta_toad_emergence_mediandays_bonf_lowvlow_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/contrast_model_timetotoadmeta_toad_emergence_mediandays_bonf_lowvlow_CI_19_01_22_model_MD3_72.csv")


################################
#################### PLOTS ######
################################

#order levels of factor
Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_level<- factor(Rawdata_experimentAugust2018_indivrows2_median2_large$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
Rawdata_experimentAugust2018_indivrows2_median2_large<- droplevels(Rawdata_experimentAugust2018_indivrows2_median2_large)


#labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")

#ylim1 = boxplot.stats(Rawdata_experimentAugust2018_indivrows2_median2_large$MedianDays)$stats[c(1, 5)]



### 3 levels no low
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP3XREGION_nolow_nofacet_54.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_timing_toad_MedianDays_comp3region_nolow_19_01_22_nofacet <-Rawdata_experimentAugust2018_indivrows2_median2_large_nolow %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_Treatment, y=MedianDays, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad co-occurrence history\nwith the NRLF",breaks=c("HG", "ML"),
                      labels=c("Short", "Long"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Toad_control","NRLF_ML","NRLF_HG"),
                     labels=c("High density\nToad control","NRLFs\nMainland","NRLFs\nHaida Gwaii"))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP3XREGION_nolow_nofacet_54.svg", width = 200, height = 150, units = 'mm')
(boxplot_timing_toad_MedianDays_comp3region_nolow_19_01_22_nofacet <-Rawdata_experimentAugust2018_indivrows2_median2_large_nolow %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_Treatment, y=MedianDays, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad co-occurrence history\nwith the NRLF",breaks=c("HG", "ML"),
                      labels=c("Short", "Long"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Toad_control","NRLF_ML","NRLF_HG"),
                     labels=c("Toad high\ncontrol","NRLFs\nMainland","NRLFs\nHaida Gwaii"))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
dev.off()



###### beautiful
### 4 COMP LEVELS
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP4XREGION_nofacet_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP4XREGION_nofacet_72.svg", width = 200, height = 150, units = 'mm')
(boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()





### 4 COMP LEVELS
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP4XREGION_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_timing_toad_MedianDays_comp4region_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                    labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP4XREGION_72.svg", width = 200, height = 150, units = 'mm')
(boxplot_timing_toad_MedianDays_comp4region_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                    labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


##logscale
### 4 COMP LEVELS
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP4XREGION_logscale_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_timing_toad_MedianDays_comp4region_logscale_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                    labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_COMP4XREGION_logscale_72.svg", width = 200, height = 150, units = 'mm')
(boxplot_timing_toad_MedianDays_comp4region_logscale_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    #mutate(Competition_level = fct_relevel(Treatment_three, 
    #                                          "Low_control", "Frog"#,"High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #                    labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()





png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_timing_toad_MedianDays_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_72.svg", width = 200, height = 150)
(boxplot_timing_toad_MedianDays_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()


# log scale
# reso
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_logscale_72_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_timing_toad_MedianDays_logscale_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_logscale_72_600res.svg", width = 200, height = 150)
(boxplot_timing_toad_MedianDays_logscale_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


#perpop
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_logscale_72_perpopulation.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_timing_toad_MedianDays_logscale_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                                                            labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/MedianDays/boxplot_MedianDays_metamorph_logscale_72_perpopulation.svg", width = 200, height = 150)
(boxplot_timing_toad_MedianDays_logscale_19_01_22 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=MedianDays)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    #coord_cartesian(ylim = ylim1*1.1)+
    facet_wrap(~Population)+
    labs(x="Competition Treatment")+
    labs(y="Median time to toad metamorphosis (days)")+    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                                                            labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()




#####################################################################
##############################################################################
########## 4. Toad Mortality #################################################
##############################################################################
##############################################################################

#rm(list=ls())

#same data as Rawdata_experimentAugust2018 but only have one mortality point per tank, so it's a short dataframe (don't have repeated measures of mortality per tank)

subset_dataRGRdd_renamedsomecolumns_2_10_20<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/subset_dataRGRdd_renamedsomecolumns_2_10_20.csv",header=T,row.names=NULL,sep=",")

#order levels of factor
subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level<- factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
subset_dataRGRdd_renamedsomecolumns_2_10_20<- droplevels(subset_dataRGRdd_renamedsomecolumns_2_10_20)

#--------------------------------
subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percentagetotal<-
  (subset_dataRGRdd_renamedsomecolumns_2_10_20$Tadpoles_added_as_top.up_june7thand8th/
     subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start)*100

#-----------------------------
subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_tadsadded_26_06_21<-
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start+
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Tadpoles_added_as_top.up_june7thand8th-
  
  (subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged+
     subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_tadpoles+
     subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_metamorphs+
     subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_number_of_metamorphs)

#---------
subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_tadsadded_26_06_21_percapita<-
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_tadsadded_26_06_21/
  
  (subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start +                                                                                                   subset_dataRGRdd_renamedsomecolumns_2_10_20$Tadpoles_added_as_top.up_june7thand8th)
#-------------------

subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20<-
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start-
  
  (subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged+                                                                                                       subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_tadpoles+                                                                                                      subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_endexperiment_number_metamorphs+                                                                                             subset_dataRGRdd_renamedsomecolumns_2_10_20$X23.8.18_number_of_metamorphs)

#-----------

subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita<-
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20/
  
  (subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start)
#----------------------------------



#save as file
Mortalitydataset_26_06_2021<-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
  dplyr::select(Tank,toadTadpoles_added_as_top.up_june7thand8th_percentagetotal,Mortality_tadsadded_26_06_21,Mortality_tadsadded_26_06_21_percapita,Mortality_06_05_20,Mortality_06_05_20_percapita)

#write.csv(Mortalitydataset_26_06_2021,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortalitydataset_26_06_2021.csv")



#test normality - not normal
qqPlot(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita)
shapiro.test(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita)


#inverse
subset_dataRGRdd_renamedsomecolumns_2_10_20$inverse_Mortality_06_05_20_percapita<-1/sqrt(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$inverse_Mortality_06_05_20_percapita)

#arcsin -metafor


subset_dataRGRdd_renamedsomecolumns_2_10_20$arcsin_Mortality_06_05_20_percapita<-transf.arcsin(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita)


hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$arcsin_Mortality_06_05_20_percapita)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/hist_Mortality_tadsadded_26_06_21_percapita_72.png", width = 200, height = 150, units = 'mm', res = 600)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_tadsadded_26_06_21_percapita)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/hist_Mortality_tadsadded_26_06_21_percapita_72.svg", width = 200, height = 150)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_tadsadded_26_06_21_percapita)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/hist_Mortality_06_05_20_percapita_72.png", width = 200, height = 150, units = 'mm', res = 600)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita)
dev.off()



### get means and standard errors
Mortality_06_05_20_percapitamean_72 <- subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
  group_by(Region,Competition_level)

Mortality_06_05_20_percapitamean_72<-Mortality_06_05_20_percapitamean_72 %>%
  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), Mortality_06_05_20_percapita)

Mortality_06_05_20_percapitamean_72<-as.data.frame(Mortality_06_05_20_percapitamean_72)
Mortality_06_05_20_percapitamean_72

write.csv(Mortality_06_05_20_percapitamean_72,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Mean_sd_se_Mortality_06_05_20_percapita_72.csv")



#######################################
############# LMMR- toad mortality ############
#########################################


#### percapita tadpole additions due to diving beetle predation
subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percapita<-(subset_dataRGRdd_renamedsomecolumns_2_10_20$Tadpoles_added_as_top.up_june7thand8th/subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start)


## old scale
### scale tadpole top up
Xtemp2 <-subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percapita 

Xscaled2 <- (Xtemp2 - mean(Xtemp2))/sd(Xtemp2)
subset_dataRGRdd_renamedsomecolumns_2_10_20$scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita  <- Xscaled2


# make sure block a factor
subset_dataRGRdd_renamedsomecolumns_2_10_20$Block_factor<-as.factor((subset_dataRGRdd_renamedsomecolumns_2_10_20$Block))

subset_dataRGRdd_renamedsomecolumns_2_10_20$Block<-as.factor((subset_dataRGRdd_renamedsomecolumns_2_10_20$Block))

### rename tretament

subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Region
subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History<-as.character(subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History)
subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History[subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History == "HG"] <- "Short" 
subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History[subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History== "ML"] <- "Long" 
subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History<-as.factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History)


###### CORRECT SCALING #################

subset_dataRGRdd_renamedsomecolumns_2_10_20$Mean_Average_Water_Temperature_Scaled<-(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mean_averageTemp-min(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mean_averageTemp))/(max(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mean_averageTemp)-min(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mean_averageTemp))


subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled<-(subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percapita-min(subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percapita))/(max(subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percapita)-min(subset_dataRGRdd_renamedsomecolumns_2_10_20$toadTadpoles_added_as_top.up_june7thand8th_percapita))


subset_dataRGRdd_renamedsomecolumns_2_10_20$Average_Individual_Toad_Tadpole_Starting_Weight_Scaled<-(subset_dataRGRdd_renamedsomecolumns_2_10_20$X25.5.18_experiment_start_tapole_av_individual_weight-min(subset_dataRGRdd_renamedsomecolumns_2_10_20$X25.5.18_experiment_start_tapole_av_individual_weight))/(max(subset_dataRGRdd_renamedsomecolumns_2_10_20$X25.5.18_experiment_start_tapole_av_individual_weight)-min(subset_dataRGRdd_renamedsomecolumns_2_10_20$X25.5.18_experiment_start_tapole_av_individual_weight))



########## VERY IMPORTANT FOR CUSTOM CONTRASTS #######
#order levels of factor
subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level<- factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
subset_dataRGRdd_renamedsomecolumns_2_10_20<- droplevels(subset_dataRGRdd_renamedsomecolumns_2_10_20)


### to order the way I want for MJ mdoel ####
subset_dataRGRdd_renamedsomecolumns_2_10_20$Region<- factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Region, levels = c("ML","HG"))
subset_dataRGRdd_renamedsomecolumns_2_10_20<- droplevels(subset_dataRGRdd_renamedsomecolumns_2_10_20)


subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History<- factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Toad_Cooccurrence_History, levels = c("Long","Short"))
subset_dataRGRdd_renamedsomecolumns_2_10_20<- droplevels(subset_dataRGRdd_renamedsomecolumns_2_10_20)



subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level<- factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level, levels = c("High_control","Low_control","FrogHG","FrogML"))
subset_dataRGRdd_renamedsomecolumns_2_10_20<- droplevels(subset_dataRGRdd_renamedsomecolumns_2_10_20)






model_MJ_MT4<-lmer(arcsin_Mortality_06_05_20_percapita~
                     Toad_Cooccurrence_History*Competition_level+ 
                  #Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled*Competition_level+ 
                    #Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled*Toad_Cooccurrence_History+ 
                  # Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled +  
          # Toad_Tadpoles_Top_up_Two_Weeks_per_Capita_Scaled*Toad_Cooccurrence_History*Competition_level+ 
                    
                    #Average_Individual_Toad_Tadpole_Starting_Weight_Scaled+
                  #Days+
                    Mean_Average_Water_Temperature_Scaled+ #fixed effects
                  Block*Competition_level+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control = lmerControl(optimizer ="Nelder_Mead"))


anova(model_MJ_MT4)
car::Anova(model_MJ_MT4)
AIC(model_MJ_MT4) #18.40918
summary(model_MJ_MT4)


L.S_model_MJ_MT4_frog <- pairs(lsmeans(model_MJ_MT4, ~ Toad_Cooccurrence_History | Competition_level))
test(L.S_model_MJ_MT4_frog, adjust = "tukey")

capture.output(test(L.S_model_MJ_MT4_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MJ_MT4_frog_718.txt")
write.csv(test(L.S_model_MJ_MT4_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MJ_MT4_frog_718.csv")


L.S_model_MJ_MT4_region <- pairs(lsmeans(model_MJ_MT4, ~ Competition_level | Toad_Cooccurrence_History ))
test(L.S_model_MJ_MT4_region, adjust = "tukey")


capture.output(test(L.S_model_MJ_MT4_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MJ_MT4_region_718.txt")
write.csv(test(L.S_model_MJ_MT4_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MJ_MT4_region_718.csv")






# Block_factor*Competition_level
############ BEST 27.01.22
model_MT4<-lmer(arcsin_Mortality_06_05_20_percapita~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor*Competition_level+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control = lmerControl(optimizer ="Nelder_Mead"))


anova(model_MT4)
AIC(model_MT4) #14.57289
summary(model_MT4)





#72
capture.output(anova(model_MT4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/anova_mortality_model_MT4_72.txt")
write.csv(anova(model_MT4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/anova_mortality_model_MT4_72.csv")
capture.output(summary(model_MT4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/summary_mortality_model_MT4_72.txt")

tab_model(model_MT4,show.df = TRUE,p.val = "kr",  file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/tab_model_mortality_model_MT4_72_df_pkr.doc")



### test residuals - mostly ok
qqnorm(resid(model_MT4))
hist(resid(model_MT4))
plot(model_MT4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Residualsplot_model_MT4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MT4)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Residualshist_model_MT4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MT4))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/QQnorm_model_MT4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MT4))
dev.off()



## interaction plots
(model_MT4.means <- interactionMeans(model_MT4))
plot(model_MT4.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/interactionMeans_model_MT4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MT4.means <- interactionMeans(model_MT4))
plot(model_MT4.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/interactionMeans_model_MT4_72.svg", width = 8, height = 6.5)
(model_MT4.means <- interactionMeans(model_MT4))
plot(model_MT4.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/visreg_model_MT4_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT4)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/visreg_model_MT4_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT4)
dev.off()






L.S_model_MT4_frog <- pairs(lsmeans(model_MT4, ~ Region | Competition_level))
test(L.S_model_MT4_frog, adjust = "tukey")

capture.output(test(L.S_model_MT4_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT4_frog_718.txt")
write.csv(test(L.S_model_MT4_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT4_frog_718.csv")


L.S_model_MT4_region <- pairs(lsmeans(model_MT4, ~ Competition_level | Region ))
test(L.S_model_MT4_region, adjust = "tukey")


capture.output(test(L.S_model_MT4_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT4_region_718.txt")
write.csv(test(L.S_model_MT4_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT4_region_718.csv")




####  arcsin_Mortality_tadsadded_26_06_21_percapita
# Block_factor*Competition_level
model_MT6<-lmer(arcsin_Mortality_tadsadded_26_06_21_percapita~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor*Competition_level+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control = lmerControl(optimizer ="Nelder_Mead"))


anova(model_MT6)
AIC(model_MT6) #14.57289
summary(model_MT6)





#72
capture.output(anova(model_MT6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/anova_mortality_model_MT6_72.txt")
write.csv(anova(model_MT6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/anova_mortality_model_MT6_72.csv")
capture.output(summary(model_MT6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/summary_mortality_model_MT6_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_MT6))
hist(resid(model_MT6))
plot(model_MT6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Residualsplot_model_MT6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MT6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Residualshist_model_MT6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MT6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/QQnorm_model_MT6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MT6))
dev.off()



## interaction plots
(model_MT6.means <- interactionMeans(model_MT6))
plot(model_MT6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/interactionMeans_model_MT6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MT6.means <- interactionMeans(model_MT6))
plot(model_MT6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/interactionMeans_model_MT6_72.svg", width = 8, height = 6.5)
(model_MT6.means <- interactionMeans(model_MT6))
plot(model_MT6.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/visreg_model_MT6_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/visreg_model_MT6_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT6)
dev.off()






L.S_model_MT6_frog <- pairs(lsmeans(model_MT6, ~ Region | Competition_level))
test(L.S_model_MT6_frog, adjust = "tukey")

capture.output(test(L.S_model_MT6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT6_frog_718.txt")
write.csv(test(L.S_model_MT6_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT6_frog_718.csv")


L.S_model_MT6_region <- pairs(lsmeans(model_MT6, ~ Competition_level | Region ))
test(L.S_model_MT6_region, adjust = "tukey")


capture.output(test(L.S_model_MT6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT6_region_718.txt")
write.csv(test(L.S_model_MT6_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT6_region_718.csv")
































####### model_MT5 #######
model_MT5<-lmer(arcsin_Mortality_06_05_20_percapita~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor*Competition_level+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control = lmerControl(optimizer ="Nelder_Mead"))


anova(model_MT5)
AIC(model_MT5) # 13.16693
summary(model_MT5)





#72
capture.output(anova(model_MT5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/anova_mortality_model_MT5_72.txt")
write.csv(anova(model_MT5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/anova_mortality_model_MT5_72.csv")
capture.output(Anova(model_MT5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Anova_chisq_mortality_model_MT5_72.txt")
write.csv(Anova(model_MT5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Anova_chisq_mortality_model_MT5_72.csv")
capture.output(summary(model_MT5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/summary_mortality_model_MT5_72.txt")


tab_model(model_MT5, file = "C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/tab_model_mortality_model_MT5_72.doc")



### test residuals - mostly ok
qqnorm(resid(model_MT5))
hist(resid(model_MT5))
plot(model_MT5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Residualsplot_model_MT5_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MT5)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/Residualshist_model_MT5_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MT5))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/QQnorm_model_MT5_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MT5))
dev.off()



## interaction plots
(model_MT5.means <- interactionMeans(model_MT5))
plot(model_MT5.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/interactionMeans_model_MT5_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MT5.means <- interactionMeans(model_MT5))
plot(model_MT5.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/interactionMeans_model_MT5_72.svg", width = 8, height = 6.5)
(model_MT5.means <- interactionMeans(model_MT5))
plot(model_MT5.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/visreg_model_MT5_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT5)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/visreg_model_MT5_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT5)
dev.off()






L.S_model_MT5_frog <- pairs(lsmeans(model_MT5, ~ Region | Competition_level))
test(L.S_model_MT5_frog, adjust = "tukey")

capture.output(test(L.S_model_MT5_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT5_frog_718.txt")
write.csv(test(L.S_model_MT5_frog, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT5_frog_718.csv")


L.S_model_MT5_region <- pairs(lsmeans(model_MT5, ~ Competition_level | Region ))
test(L.S_model_MT5_region, adjust = "tukey")


capture.output(test(L.S_model_MT5_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT5_region_718.txt")
write.csv(test(L.S_model_MT5_region, adjust = "tukey"),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/L.S_model_MT5_region_718.csv")










### dif lmer control to get model to converge
# https://stats.stackexchange.com/questions/242109/model-failed-to-converge-warning-in-lmer/243225
model_MT3<-lmer(arcsin_Mortality_06_05_20_percapita~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control = lmerControl(optimizer ="Nelder_Mead"))


anova(model_MT3)
AIC(model_MT3) #18.06574
summary(model_MT3)



#72
capture.output(anova(model_MT3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mortality_model_MT3_72.txt")
write.csv(anova(model_MT3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mortality_model_MT3_72.csv")
capture.output(summary(model_MT3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_mortality_model_MT3_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_MT3))
hist(resid(model_MT3))
plot(model_MT3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_MT3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MT3)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_MT3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MT3))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_MT3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MT3))
dev.off()



## interaction plots
(model_MT3.means <- interactionMeans(model_MT3))
plot(model_MT3.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MT3_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MT3.means <- interactionMeans(model_MT3))
plot(model_MT3.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MT3_72.svg", width = 8, height = 6.5)
(model_MT3.means <- interactionMeans(model_MT3))
plot(model_MT3.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MT3_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT3)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MT3_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT3)
dev.off()














### REML true and old version of fixigin model convergence issues
model_MT1<-lmer(arcsin_Mortality_06_05_20_percapita~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=TRUE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


anova(model_MT1)
AIC(model_MT1) #62.95787
summary(model_MT1)



#72
#capture.output(anova(model_MT1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_mortality_model_MT1_72.txt")
#capture.output(summary(model_MT1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_mortality_model_MT1_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_MT1))
hist(resid(model_MT1))
plot(model_MT1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_MT1_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_MT1)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_MT1_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_MT1))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_MT1_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_MT1))
dev.off()



## interaction plots
(model_MT1.means <- interactionMeans(model_MT1))
plot(model_MT1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MT1_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_MT1.means <- interactionMeans(model_MT1))
plot(model_MT1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_MT1_72.svg", width = 8, height = 6.5)
(model_MT1.means <- interactionMeans(model_MT1))
plot(model_MT1.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MT1_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_MT1_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_MT1)
dev.off()





model_MT2<-lmer(arcsin_Mortality_06_05_20_percapita~
                  Region*Competition_level+ 
                  scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                  #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                  #Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))


anova(model_MT2)
AIC(model_MT2) #16.21912
summary(model_MT2)










Model_mortality_tadsadded_percapita_arcsin<-lmer(arcsin_Mortality_06_05_20_percapita~
                                                   Region*Competition_level + 
                                                   X25.5.18_experiment_start_tapole_av_individual_weight+
                                                   Mean_averageTemp+ #fixed effects
                                                   (1|Population),
                                                 data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=TRUE,control=lmerControl(check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4))) 

anova(Model_mortality_tadsadded_percapita_arcsin)
AIC(Model_mortality_tadsadded_percapita_arcsin) #53.28388
visreg(Model_mortality_tadsadded_percapita_arcsin)
plot(Model_mortality_tadsadded_percapita_arcsin)

"Type III Analysis of Variance Table with Satterthwaite's method
                                                       Sum Sq  Mean Sq NumDF  DenDF F value  Pr(>F)  
Region                                                0.23087 0.230866     1  4.077  3.0829 0.15262  
Competition_level                                     0.05768 0.019228     3 58.247  0.2568 0.85621  
X25.5.18_experiment_start_tapole_av_individual_weight 0.01640 0.016396     1  5.240  0.2189 0.65866  
Mean_averageTemp                                      0.02404 0.024044     1 60.200  0.3211 0.57307  
Region:Competition_level                              0.87157 0.290524     3 58.279  3.8795 0.01346 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"

#write.csv(anova(Model_mortality_tadsadded_percapita_arcsin),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anovaModel_mortality_tadsadded_percapita_arcsin_REMLTRUE_291120.csv")


#capture.output(Model_mortality_tadsadded_percapita_arcsin,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Model_mortality_tadsadded_percapita_arcsin_REMLTRUE_291120.txt")

##### .txt files
#capture.output(Model_mortality_tadsadded_percapita_arcsin,file="Model_mortality_tadsadded_percapita_arcsin_REMLTRUE_291120.txt")
#capture.output(anova(Model_mortality_tadsadded_percapita_arcsin),file="anovaModel_mortality_tadsadded_percapita_arcsin_REMLTRUE_291120.txt")
#capture.outputModel_mortality_tadsadded_percapita_arcsin,file="Model_mortality_tadsadded_percapita_arcsin_REMLFALSE.txt")
#capture.output(anova(Model_mortality_tadsadded_percapita_arcsin),file="anova_Model_mortality_tadsadded_percapita_arcsin_REMLFALSE.txt")


####################################################################
################### CUSTOM CONTRASTS ################
####################################################################

emm3_Model_mortality_tadsadded_percapita=emmeans(model_MT4,specs=~ Competition_level*Region)

write.csv(emm3_Model_mortality_tadsadded_percapita,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/emm3_Model_mortality_tadsadded_percapita_arcsin_model_MT4_19_01_22.csv")



#make into dataframe
emm3_Model_mortality_tadsadded_percapitadf<-as.data.frame(emm3_Model_mortality_tadsadded_percapita)

#make new column
emm3_Model_mortality_tadsadded_percapitadf<-cbind(Model = "Model_mortality_tadsadded_percapita_arcsin", emm3_Model_mortality_tadsadded_percapitadf)


#create custom contrasts
Low_controlHG<-rep(c(1,0), times = c(1,7))
FrogMLHG<-rep(c(0,1,0), times = c(1,1,6))
FrogHGHG<-rep(c(0,1,0), times = c(2,1,5))
High_controlHG<-rep(c(0,1,0), times = c(3,1,4))
Low_controlML<-rep(c(0,1,0), times = c(4,1,3))
FrogMLML<-rep(c(0,1,0), times = c(5,1,2))
FrogHGML<-rep(c(0,1,0), times = c(6,1,1))
High_controlML<-rep(c(0,1), times = c(7,1))

#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_MORTALITY_mvt_frogregion_mvt_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


#72
write.csv(contrast_MORTALITY_mvt_frogregion_mvt_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_mvt_frogregion_mvt_19_01_22_model_MT4_72.csv")




# adjust = "mvt" adds multiple tests adjustment, could also use "bonferroni" but its too conservative https://cran.r-project.org/web/packages/emmeans/vignettes/confidence-intervals.html



###for MS 01_12_20
(contrast_MORTALITY_mvt_values_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))




write.csv(contrast_MORTALITY_mvt_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_mvt_values_19_01_22_model_MT4_72.csv")



(contrast_MORTALITY_BONFERRONI_values_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))



write.csv(contrast_MORTALITY_BONFERRONI_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_BONFERRONI_values_19_01_22_model_MT4_72.csv")


# 7 tests
### low vs high, low vs low, high vs high
(contrast_MORTALITY_mvt_lowvlow_7tests_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#72
write.csv(contrast_MORTALITY_mvt_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_mvt_lowvlow_7tests_19_01_22_model_MT4_72.csv")



# 7 tests
### low vs high, low vs low, high vs high
(contrast_MORTALITY_bonf_lowvlow_7tests_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#72
write.csv(contrast_MORTALITY_bonf_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_bonf_lowvlow_7tests_19_01_22_model_MT4_72.csv")



###########################
########## PERCENT ################
###################################

#region HG, comp level low control - single out estimate for each level of region/competition to insect into contrast table later to calculate percent
HGLow_controlHG_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[1,4]
HGFrogMLHG_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[2,4]
HGFrogHGHG_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[3,4]
HGHigh_controlHG_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[4,4]
MLLow_controlML_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[5,4] 
MLFrogMLML_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[6,4]
MLFrogHGML_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[7,4]
MLHigh_controlML_MORTALITY<-emm3_Model_mortality_tadsadded_percapitadf[8,4]
HGFrog_overallHG_MORTALITY<-(emm3_Model_mortality_tadsadded_percapitadf[2,4]+emm3_Model_mortality_tadsadded_percapitadf[3,4])/2
MLFrog_overallML_MORTALITY<-(emm3_Model_mortality_tadsadded_percapitadf[6,4]+emm3_Model_mortality_tadsadded_percapitadf[7,4])/2
ML_lowC_minus_highC_MORTALITY<-MLLow_controlML_MORTALITY-MLHigh_controlML_MORTALITY
HG_lowC_minus_highC_MORTALITY<-HGLow_controlHG_MORTALITY-HGHigh_controlHG_MORTALITY
ML_lowC_minus_inter_MORTALITY<-MLLow_controlML_MORTALITY-MLFrog_overallML_MORTALITY
HG_lowC_minus_inter_MORTALITY<-HGLow_controlHG_MORTALITY-HGFrog_overallHG_MORTALITY
ML_lowC_minus_highC_MORTALITY_MINUS_ML_lowC_minus_inter_MORTALITY<-ML_lowC_minus_highC_MORTALITY-ML_lowC_minus_inter_MORTALITY



(contrast_MORTALITY_mvt_PERCENT_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_MORTALITY)*100,
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_MORTALITY))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_MORTALITY))*100,
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_MORTALITY)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_MORTALITY)*100
  
  
  
  
)))



write.csv(contrast_MORTALITY_mvt_PERCENT_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_mvt_PERCENT_19_01_22_model_MT4_72.csv")



### bonferroni

(contrast_MORTALITY_PERCENT_bonferroni_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_MORTALITY)*100,
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_MORTALITY))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_MORTALITY))*100,
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_MORTALITY)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_MORTALITY)*100
  
  
  
  
  
)))


write.csv(contrast_MORTALITY_PERCENT_bonferroni_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_PERCENT_bonferroni_19_01_22_model_MT4_72.csv")



#############
#### CONFIDENCE INTERVALS ####
##############

(contrast_MORTALITY_CI_19_01_22<-contrast(emm3_Model_mortality_tadsadded_percapita,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "bonferroni")%>%
   confint())




write.csv(contrast_MORTALITY_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/contrast_MORTALITY_bonf_CI_19_01_22_model_MT4_72.csv")



###############################################
#################### PLOT ###################
##############################################
labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")


ylim1 = boxplot.stats(subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita)$stats[c(1, 5)]










(boxplot_Mortality_06_05_20_percapita_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6) +
    scale_fill_manual("grey")+
    coord_cartesian(ylim = ylim1*1.05)+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))




##### beautiful
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_06_05_20_percapita_4COMPXREGION_nofacet_72_cooccur.png", width = 230, height = 150, units = 'mm', res = 600)
(boxplot_Mortality_06_05_20_percapita_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad Co-occurrence History\nwith the NRLF ",breaks=c("HG", "ML"),
                      labels=c("Short", "Long"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(legend.key.size = unit(2, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_06_05_20_percapita_4COMPXREGION_nofacet_72_cooccur.svg", width = 200, height = 150, units = 'mm')
(boxplot_Mortality_06_05_20_percapita_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad Co-occurrence History\nwith the NRLF ",breaks=c("HG", "ML"),
                      labels=c("Short", "Long"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(legend.key.size = unit(2, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()





png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_06_05_20_percapita_4COMPXREGION_nofacet_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Mortality_06_05_20_percapita_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_06_05_20_percapita_4COMPXREGION_nofacet_72.svg", width = 200, height = 150, units = 'mm')
(boxplot_Mortality_06_05_20_percapita_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita, fill=Region)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad origin",breaks=c("HG", "ML"),
                      labels=c("Haida Gwaii", "Mainland"))+
    #facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                     labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
    #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
    #     labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(axis.title.x = element_text(margin = margin(t = 10)))+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



# arcsine trans formed y axis
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_mortalitypercapita_modelMT3_arcsinetrans_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_mortality_arcsine_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=arcsin_Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Toad mortality per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_mortalitypercapita_modelMT3_arcsinetrans_72.svg", width = 200, height = 150)
(boxplot_mortality_arcsine_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=arcsin_Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Toad mortality per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



### 4 comp treatments

# arcsine trans formed y axis
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_arcsin_Mortality_06_05_20_percapita_4COMPXREGION_modelMT3_arcsinetrans_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_mortality_arcsine_4comp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=arcsin_Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Toad mortality per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #           labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_arcsin_Mortality_06_05_20_percapita_4COMPXREGION_modelMT3_arcsinetrans_72.svg", width = 200, height = 150,units="mm")
(boxplot_mortality_arcsine_4comp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=arcsin_Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Toad mortality per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #           labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




### 4 comp treatments
#RAW
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_06_05_20_percapita_4COMPXREGION_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_mortality_arcsine_4comp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #           labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_06_05_20_percapita_4COMPXREGION_72.svg", width = 200, height = 150,units="mm")
(boxplot_mortality_4comp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #           labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()



### Mortality_tadsadded_26_06_21_percapita
### 4 treats
# raw
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_tadsadded_26_06_21_percapita_4COMPXREGION_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Mortality_tadsadded_26_06_21_percapita_4comp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_tadsadded_26_06_21_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #           labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_Mortality_tadsadded_26_06_21_percapita_4COMPXREGION_72.svg", width = 200, height = 150,units="mm")
(boxplot_Mortality_tadsadded_26_06_21_percapita_4comp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    ggplot(aes(x=Competition_level, y=Mortality_tadsadded_26_06_21_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Toad mortality per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #           labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()





# 
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_mortalitypercapita_modelMT3_72.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_mortality_arcsine_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Toad mortality per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortality/boxplot_mortalitypercapita_modelMT3_72.svg", width = 200, height = 150)
(boxplot_mortality_arcsine_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Mortality_06_05_20_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Toad mortality per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




############################################################################
############################################################################
############################# 5. COUNTS juveniles emerged #############
#########################################################################
##################################################################################


### continue on without all these thigns...


## not sure where I'm going with this one.. model not going great

#subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged

############## join mortality data
Mortalitydataset_26_06_2021<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Mortalitydataset_26_06_2021.csv",header=T,row.names=NULL,sep=",")

subset_dataRGRdd_renamedsomecolumns_2_10_20<-left_join(subset_dataRGRdd_renamedsomecolumns_2_10_20,Mortalitydataset_26_06_2021,by="Tank")



#order levels of factor
subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level<- factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
subset_dataRGRdd_renamedsomecolumns_2_10_20<- droplevels(subset_dataRGRdd_renamedsomecolumns_2_10_20)

# normality - ok
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged)


hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged)

#log
hist(log(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged))

subset_dataRGRdd_renamedsomecolumns_2_10_20$log_Running_total_of_adults_emerged<-log(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged)


dim(subset_dataRGRdd_renamedsomecolumns_2_10_20)

###############
##### scale variables ###########
#############

Tadpoles_added_as_top.up_june7thand8th_percapita+
  X25.5.18_experiment_start_tapole_av_individual_weight
Mortality_06_05_20_percapita




#starting weight
Xtemp <- subset_dataRGRdd_renamedsomecolumns_2_10_20$X25.5.18_experiment_start_tapole_av_individual_weight 
Xtemp

Xscaled <- (Xtemp - mean(Xtemp))/sd(Xtemp)
subset_dataRGRdd_renamedsomecolumns_2_10_20$scaled_X25.5.18_experiment_start_tapole_av_individual_weight  <- Xscaled

### tadpole top up
Xtemp2 <-subset_dataRGRdd_renamedsomecolumns_2_10_20$Tadpoles_added_as_top.up_june7thand8th_percapita 

Xscaled2 <- (Xtemp2 - mean(Xtemp2))/sd(Xtemp2)
subset_dataRGRdd_renamedsomecolumns_2_10_20$scaled_Tadpoles_added_as_top.up_june7thand8th_percapita  <- Xscaled2

### mortality
Xtemp3 <-subset_dataRGRdd_renamedsomecolumns_2_10_20$Mortality_06_05_20_percapita 

Xscaled3 <- (Xtemp3 - mean(Xtemp3))/sd(Xtemp3)
subset_dataRGRdd_renamedsomecolumns_2_10_20$scaled_Mortality_06_05_20_percapita  <- Xscaled3




### per capita

subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita<-
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged/
  subset_dataRGRdd_renamedsomecolumns_2_10_20$Total_number_individuals_start


### transform


subset_dataRGRdd_renamedsomecolumns_2_10_20$arcsine_Running_total_of_adults_emerged_percapita<-
  transf.arcsin(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita)



par(mar = c(5, 5,2, 2))
par(mfrow=c(1,1))

hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita)

#Running_total_of_adults_emerged_percapita_TADSADDED
subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita_TADSADDED<-subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged/subset_dataRGRdd_renamedsomecolumns_2_10_20$Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th



hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita_TADSADDED)


############# best 19.01.22 ################
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/hist_Running_total_of_adults_emerged_percapita_TADSADDED_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita_TADSADDED)
dev.off()

model_CJ1.6<-lmer(Running_total_of_adults_emerged_percapita_TADSADDED~
                    Region*Competition_level+ 
                    Tadpoles_added_as_top.up_june7thand8th_percapita+ 
                    X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    # Days+
                    Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    #(1|Tank_factor)+
                    (1|Population),
                  #(1|Block_factor), #random effects
                  data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4))) 


anova(model_CJ1.6)
AIC(model_CJ1.6) #   -99.44868
summary(model_CJ1.6)


#72
capture.output(anova(model_CJ1.6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/anova_countjuveniles_percapita_tadsadd_model_CJ1.6_72.txt")
write.csv(anova(model_CJ1.6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/anova_countjuveniles_percapita_tadsadd_model_CJ1.6_72.csv")
capture.output(summary(model_CJ1.6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/summary_countjuveniles_percapita_tadsadd_model_CJ1.6_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ1.6))
hist(resid(model_CJ1.6))
plot(model_CJ1.6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/Residualsplot_model_CJ1.6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ1.6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/Residualshist_model_CJ1.6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ1.6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/QQnorm_model_CJ1.6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ1.6))
dev.off()



## interaction plots
(model_CJ1.6.means <- interactionMeans(model_CJ1.6))
plot(model_CJ1.6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/interactionMeans_model_CJ1.6_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ1.6.means <- interactionMeans(model_CJ1.6))
plot(model_CJ1.6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/interactionMeans_model_CJ1.6_72.svg", width = 8, height = 6.5)
(model_CJ1.6.means <- interactionMeans(model_CJ1.6))
plot(model_CJ1.6.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/visreg_model_CJ1.6_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/visreg_model_CJ1.6_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.6)
dev.off()






### model_CJ2 ####
# log 10

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/hist_log10_Running_total_of_adults_emerged_percapita_TADSADDED_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log10(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita_TADSADDED))
dev.off()


subset_dataRGRdd_renamedsomecolumns_2_10_20$log10_Running_total_of_adults_emerged_percapita_TADSADDED<-log10(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita_TADSADDED)



subset_dataRGRdd_renamedsomecolumns_2_10_20_nozeros<-subset_dataRGRdd_renamedsomecolumns_2_10_20[!(subset_dataRGRdd_renamedsomecolumns_2_10_20$Running_total_of_adults_emerged_percapita_TADSADDED==0),]
dim(subset_dataRGRdd_renamedsomecolumns_2_10_20_nozeros)

model_CJ2<-lmer(log10_Running_total_of_adults_emerged_percapita_TADSADDED~
                  Region*Competition_level+ 
                  Tadpoles_added_as_top.up_june7thand8th_percapita+ 
                  X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  # Days+
                  Mean_averageTemp+ #fixed effects
                  Block_factor+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4))) 


anova(model_CJ2)
AIC(model_CJ2) #   -2.634344
summary(model_CJ2)


#72
capture.output(anova(model_CJ2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/anova_countjuveniles_percapita_tadsadd_model_CJ2_72.txt")
write.csv(anova(model_CJ2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/anova_countjuveniles_percapita_tadsadd_model_CJ2_72.csv")
capture.output(summary(model_CJ2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/summary_countjuveniles_percapita_tadsadd_model_CJ2_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ2))
hist(resid(model_CJ2))
plot(model_CJ2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/Residualsplot_model_CJ2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/Residualshist_model_CJ2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/QQnorm_model_CJ2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ2))
dev.off()



## interaction plots
(model_CJ2.means <- interactionMeans(model_CJ2))
plot(model_CJ2.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/interactionMeans_model_CJ2_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ2.means <- interactionMeans(model_CJ2))
plot(model_CJ2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/interactionMeans_model_CJ2_72.svg", width = 8, height = 6.5)
(model_CJ2.means <- interactionMeans(model_CJ2))
plot(model_CJ2.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/visreg_model_CJ2_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/visreg_model_CJ2_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ2)
dev.off()







# Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th

model_CJ1.4<-lmer(Running_total_of_adults_emerged_percapita~
                    Region*Competition_level+ 
                    Tadpoles_added_as_top.up_june7thand8th_percapita+ 
                    X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    # Days+
                    Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    #(1|Tank_factor)+
                    (1|Population),
                  #(1|Block_factor), #random effects
                  data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4))) 


anova(model_CJ1.4)
AIC(model_CJ1.4) #   -95.57915
summary(model_CJ1.4)


#72
capture.output(anova(model_CJ1.4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_countjuveniles_model_CJ1.4_72.txt")
write.csv(anova(model_CJ1.4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_countjuveniles_model_CJ1.4_72.csv")
capture.output(summary(model_CJ1.4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_countjuveniles_model_CJ1.4_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ1.4))
hist(resid(model_CJ1.4))
plot(model_CJ1.4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_CJ1.4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ1.4)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_CJ1.4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ1.4))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_CJ1.4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ1.4))
dev.off()



## interaction plots
(model_CJ1.4.means <- interactionMeans(model_CJ1.4))
plot(model_CJ1.4.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_CJ1.4_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ1.4.means <- interactionMeans(model_CJ1.4))
plot(model_CJ1.4.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_CJ1.4_72.svg", width = 8, height = 6.5)
(model_CJ1.4.means <- interactionMeans(model_CJ1.4))
plot(model_CJ1.4.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_CJ1.4_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.4)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_CJ1.4_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.4)
dev.off()


##3 arcsine response
model_CJ1.5<-lmer(arcsine_Running_total_of_adults_emerged_percapita~
                    Region*Competition_level+ 
                    Tadpoles_added_as_top.up_june7thand8th_percapita+ 
                    X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    # Days+
                    Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    #(1|Tank_factor)+
                    (1|Population),
                  #(1|Block_factor), #random effects
                  data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4))) 


anova(model_CJ1.5)
AIC(model_CJ1.5) #   -69.45952
summary(model_CJ1.5)




#72
capture.output(anova(model_CJ1.5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_countjuveniles_model_CJ1.5_arcsine_72.txt")
write.csv(anova(model_CJ1.5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_countjuveniles_model_CJ1.5_arcsine_72.csv")
capture.output(summary(model_CJ1.5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_countjuveniles_model_CJ1.5_arcsine_72.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ1.5))
hist(resid(model_CJ1.5))
plot(model_CJ1.5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_CJ1.5_arcsine_72.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ1.5)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_CJ1.5_arcsine_72.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ1.5))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_CJ1.5_arcsine_72.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ1.5))
dev.off()



## interaction plots
(model_CJ1.5.means <- interactionMeans(model_CJ1.5))
plot(model_CJ1.5.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_CJ1.5_arcsine_72.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ1.5.means <- interactionMeans(model_CJ1.5))
plot(model_CJ1.5.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_CJ1.5_arcsine_72.svg", width = 8, height = 6.5)
(model_CJ1.5.means <- interactionMeans(model_CJ1.5))
plot(model_CJ1.5.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_CJ1.5_arcsine_72.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.5)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_CJ1.5_arcsine_72.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.5)
dev.off()







#### try with 718 dataset

model_CJ1.3<-lmer(Count_juv_emerged~
                    Region*Competition_level+ 
                    scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                    scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    Days+
                    Mean_averageTemp+ #fixed effects
                    Block_factor+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    (1+Days|Tank_factor)+
                    (1|Population_factor),
                  data=Rawdata_experimentAugust2018,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ1.3)
AIC(model_CJ1.3) #  4024.653
summary(model_CJ1.3)


#718
capture.output(anova(model_CJ1.3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_countjuveniles_model_CJ1.3_718.txt")
write.csv(anova(model_CJ1.3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/anova_countjuveniles_model_CJ1.3_718.csv")
capture.output(summary(model_CJ1.3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/summary_countjuveniles_model_CJ1.3_718.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ1.3))
hist(resid(model_CJ1.3))
plot(model_CJ1.3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualsplot_model_CJ1.3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ1.3)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Residualshist_model_CJ1.3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ1.3))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/QQnorm_model_CJ1.3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ1.3))
dev.off()



## interaction plots
(model_CJ1.3.means <- interactionMeans(model_CJ1.3))
plot(model_CJ1.3.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_CJ1.3_718.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ1.3.means <- interactionMeans(model_CJ1.3))
plot(model_CJ1.3.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/interactionMeans_model_CJ1.3_718.svg", width = 8, height = 6.5)
(model_CJ1.3.means <- interactionMeans(model_CJ1.3))
plot(model_CJ1.3.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_CJ1.3_718.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.3)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/visreg_model_CJ1.3_718.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1.3)
dev.off()








# try with 72 dataset
# ooops block is continuous here

model_CJ1<-lmer(Running_total_of_adults_emerged~
                  Region*Competition_level+ 
                  Tadpoles_added_as_top.up_june7thand8th_percapita+ 
                  X25.5.18_experiment_start_tapole_av_individual_weight+
                  Mortality_06_05_20_percapita+
                  # Days+
                  Mean_averageTemp+ #fixed effects
                  Block+
                  #Total_chla_conc_26.7.18_ug.l+
                  #(1|Daysfactor)+
                  
                  #(1|Daysfactor/Tank_factor)+
                  #(1|Tank_factor)+
                  (1|Population),
                #(1|Block_factor), #random effects
                data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_CJ1)
AIC(model_CJ1) #  -121.8493
summary(model_CJ1)


### test residuals - mostly ok
qqnorm(resid(model_CJ1))
hist(resid(model_CJ1))
plot(model_CJ1)

(model_CJ1.means <- interactionMeans(model_CJ1))

plot(model_CJ1.means)



par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ1)





#glmer
model_CJ1.2<-glmer(Running_total_of_adults_emerged~
                     Region*Competition_level+ 
                     scaled_Tadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     scaled_Mortality_06_05_20_percapita+
                     #Days+
                     Mean_averageTemp+ #fixed effects
                     Block+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     #(1|Tank_factor)+
                     (1|Population),
                   #(1|Block_factor), #random effects
                   data=subset_dataRGRdd_renamedsomecolumns_2_10_20,family="poisson",na.action=na.exclude,control=glmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_CJ1.2)
AIC(model_CJ1.2) #  -121.8493
summary(model_CJ1)


### test residuals - mostly ok
qqnorm(resid(model_CJ1.2))
hist(resid(model_CJ1.2))
plot(model_CJ1.2)



# Error in mkRespMod(fr, REML = REMLpass) : NA/NaN/Inf in 'y'
model_CJ1.1<-lmer(log_Running_total_of_adults_emerged~
                    Region*Competition_level+ 
                    Tadpoles_added_as_top.up_june7thand8th_percapita+ 
                    X25.5.18_experiment_start_tapole_av_individual_weight+
                    Mortality_06_05_20_percapita+
                    #Days+
                    Mean_averageTemp+ #fixed effects
                    Block+
                    #Total_chla_conc_26.7.18_ug.l+
                    #(1|Daysfactor)+
                    
                    #(1|Daysfactor/Tank_factor)+
                    #(1|Tank_factor)+
                    (1|Population),
                  #(1|Block_factor), #random effects
                  data=subset_dataRGRdd_renamedsomecolumns_2_10_20,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

anova(model_CJ1)
AIC(model_CJ1) #  -121.8493
summary(model_CJ1)


### test residuals - mostly ok
qqnorm(resid(model_CJ1))
hist(resid(model_CJ1))
plot(model_CJ1)




####################################################################
################### CUSTOM CONTRASTS ################
####################################################################



emm3_Model_countjuvemerged_percapita_tadsadded_percapita=emmeans(model_CJ1.6,specs=~ Competition_level*Region)

#capture.output(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,file="emm3_Model_countjuvemerged_percapita_tadsadded_percapita_arcsin.txt")



#make into dataframe
emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf<-as.data.frame(emm3_Model_countjuvemerged_percapita_tadsadded_percapita)

#make new column
emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf<-cbind(Model = "Model_countjuvemerged_percapita_tadsadded_percapita_arcsin", emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf)


#create custom contrasts
Low_controlHG<-rep(c(1,0), times = c(1,7))
FrogMLHG<-rep(c(0,1,0), times = c(1,1,6))
FrogHGHG<-rep(c(0,1,0), times = c(2,1,5))
High_controlHG<-rep(c(0,1,0), times = c(3,1,4))
Low_controlML<-rep(c(0,1,0), times = c(4,1,3))
FrogMLML<-rep(c(0,1,0), times = c(5,1,2))
FrogHGML<-rep(c(0,1,0), times = c(6,1,1))
High_controlML<-rep(c(0,1), times = c(7,1))

#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_countjuvemerged_percapita_mvt_frogregion_mvt_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


#72
write.csv(contrast_countjuvemerged_percapita_mvt_frogregion_mvt_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_mvt_frogregion_mvt_19_01_22_model_CJ1.6_72.csv")




# adjust = "mvt" adds multiple tests adjustment, could also use "bonferroni" but its too conservative https://cran.r-project.org/web/packages/emmeans/vignettes/confidence-intervals.html



###for MS 01_12_20
(contrast_countjuvemerged_percapita_mvt_values_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))




write.csv(contrast_countjuvemerged_percapita_mvt_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_mvt_values_19_01_22_model_CJ1.6_72.csv")



(contrast_countjuvemerged_percapita_BONFERRONI_values_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))



write.csv(contrast_countjuvemerged_percapita_BONFERRONI_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_BONFERRONI_values_19_01_22_model_CJ1.6_72.csv")


# 7 tests
### low vs high, low vs low, high vs high
(contrast_countjuvemerged_percapita_mvt_lowvlow_7tests_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#72
write.csv(contrast_countjuvemerged_percapita_mvt_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_mvt_lowvlow_7tests_19_01_22_model_CJ1.6_72.csv")



# 7 tests
### low vs high, low vs low, high vs high
(contrast_countjuvemerged_percapita_bonf_lowvlow_7tests_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#72
write.csv(contrast_countjuvemerged_percapita_bonf_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_bonf_lowvlow_7tests_19_01_22_model_CJ1.6_72.csv")



###########################
########## PERCENT ################
###################################

#region HG, comp level low control - single out estimate for each level of region/competition to insect into contrast table later to calculate percent
HGLow_controlHG_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[1,4]
HGFrogMLHG_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[2,4]
HGFrogHGHG_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[3,4]
HGHigh_controlHG_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[4,4]
MLLow_controlML_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[5,4] 
MLFrogMLML_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[6,4]
MLFrogHGML_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[7,4]
MLHigh_controlML_countjuvemerged_percapita<-emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[8,4]
HGFrog_overallHG_countjuvemerged_percapita<-(emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[2,4]+emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[3,4])/2
MLFrog_overallML_countjuvemerged_percapita<-(emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[6,4]+emm3_Model_countjuvemerged_percapita_tadsadded_percapitadf[7,4])/2
ML_lowC_minus_highC_countjuvemerged_percapita<-MLLow_controlML_countjuvemerged_percapita-MLHigh_controlML_countjuvemerged_percapita
HG_lowC_minus_highC_countjuvemerged_percapita<-HGLow_controlHG_countjuvemerged_percapita-HGHigh_controlHG_countjuvemerged_percapita
ML_lowC_minus_inter_countjuvemerged_percapita<-MLLow_controlML_countjuvemerged_percapita-MLFrog_overallML_countjuvemerged_percapita
HG_lowC_minus_inter_countjuvemerged_percapita<-HGLow_controlHG_countjuvemerged_percapita-HGFrog_overallHG_countjuvemerged_percapita
ML_lowC_minus_highC_countjuvemerged_percapita_MINUS_ML_lowC_minus_inter_countjuvemerged_percapita<-ML_lowC_minus_highC_countjuvemerged_percapita-ML_lowC_minus_inter_countjuvemerged_percapita



(contrast_countjuvemerged_percapita_mvt_PERCENT_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_countjuvemerged_percapita)*100,
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_countjuvemerged_percapita))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_countjuvemerged_percapita))*100,
  
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_countjuvemerged_percapita)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_countjuvemerged_percapita)*100
  
  
  
)))



write.csv(contrast_countjuvemerged_percapita_mvt_PERCENT_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_mvt_PERCENT_19_01_22_model_CJ1.6_72.csv")



### bonferroni

(contrast_countjuvemerged_percapita_PERCENT_bonferroni_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_countjuvemerged_percapita)*100,
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_countjuvemerged_percapita))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_countjuvemerged_percapita))*100,
  
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_countjuvemerged_percapita)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_countjuvemerged_percapita)*100
  
  
)))


write.csv(contrast_countjuvemerged_percapita_PERCENT_bonferroni_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_PERCENT_bonferroni_19_01_22_model_CJ1.6_72.csv")



#############
#### CONFIDENCE INTERVALS ####
##############

(contrast_countjuvemerged_percapita_bonf_CI_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "bonferroni")%>%
   confint())




write.csv(contrast_countjuvemerged_percapita_bonf_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_bonf_CI_19_01_22_model_CJ1.6_72.csv")


(contrast_countjuvemerged_percapita_mvt_CI_19_01_22<-contrast(emm3_Model_countjuvemerged_percapita_tadsadded_percapita,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "mvt")%>%
    confint())




write.csv(contrast_countjuvemerged_percapita_mvt_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/contrast_countjuvemerged_percapita_mvt_CI_19_01_22_model_CJ1.6_72.csv")



##################
### PLOT #########
#################

## model CJ1.4
(boxplot_countjuvemerged_percapita_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
   mutate(Competition_level = fct_relevel(Treatment_three, 
                                          "Low_control", "Frog","High_control")) %>%
   ggplot(aes(x=Competition_level, y=Running_total_of_adults_emerged_percapita)) +
   geom_boxplot(lwd=0.6)+
   scale_fill_manual("grey")+
   facet_wrap(~Region,labeller = labeller(Region = labels))+
   labs(x="Competition Treatment")+
   labs(y="Number juveniles emerged per capita")+
   scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                    labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
   scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                         labels=c("Haida Gwaii", "Mainland"))+
   theme_bw()+
   theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))




png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_model_CJ1.4_72_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_countjuvemerged_percapita_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Running_total_of_adults_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_model_CJ1.4_72_600re.svg", width = 200, height = 150)
(boxplot_countjuvemerged_percapita_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Running_total_of_adults_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

#Running_total_of_adults_emerged_percapita_TADSADDED
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_TADSADDED_model_CJ1.6_72_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_countjuvemerged_percapita_TADSADDED_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Running_total_of_adults_emerged_percapita_TADSADDED)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number metamorphosed per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_TADSADDED_model_CJ1.6_72_600res.svg", width = 200, height = 150)
(boxplot_countjuvemerged_percapita_TADSADDED_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Running_total_of_adults_emerged_percapita_TADSADDED)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number metamorphosed per capita per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


##log
#Running_total_of_adults_emerged_percapita_TADSADDED
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_TADSADDED_logscale_model_CJ1.6_72_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_countjuvemerged_percapita_TADSADDED_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Running_total_of_adults_emerged_percapita_TADSADDED)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number metamorphosed per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_TADSADDED_logscale_model_CJ1.6_72_600res.svg", width = 200, height = 150)
(boxplot_countjuvemerged_percapita_TADSADDED_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Running_total_of_adults_emerged_percapita_TADSADDED)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number metamorphosed per capita per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()







######### 1.4 but arcsine response
## model CJ1.5
(boxplot_countjuvemerged_percapita_arcsine_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=arcsine_Running_total_of_adults_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))





png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_arcsine_model_CJ1.5_72_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_countjuvemerged_percapita_arcsine_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=arcsine_Running_total_of_adults_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Number juveniles emerged per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/TotalCountJuvTank72/boxplot_countjuvemerged_percapita_arcsine_model_CJ1.5_72_600re.svg", width = 200, height = 150)
(boxplot_countjuvemerged_percapita_arcsine_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=arcsine_Running_total_of_adults_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Number juveniles emerged per capita_")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




### old - 718 dataset
(boxplot_countjuvemerged_19_01_22 <-Rawdata_experimentAugust2018 %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Count_juv_emerged)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))




############################################################################
############################################################################
############################# 6. CUMCUMLATIVE COUNTS juveniles emerged over time #############
#########################################################################
##################################################################################


Rawdata_experimentAugust2018_720<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Rcode_plots_RGG_experiment_MS_sept8th2020/Rawdata_02_03_20.csv",header=T,row.names=NULL,sep=",")
dim(Rawdata_experimentAugust2018_720) #720




Rawdata_experimentAugust2018_720
Rawdata_experimentAugust2018_720$Daysfactor<-as.factor(Rawdata_experimentAugust2018_720$Days)


levels(Rawdata_experimentAugust2018_720$Daysfactor)
[1] "55" "63" "67" "70" "74" "77" "80" "83" "87" "90"

Rawdata_experimentAugust2018_720$Count_juv_emerged



# split into 10 datasets, day 55 just has day 55, day 63 has day 55 and day 63, day 67 has day 55, day 63 and 67 etc

###################
### day 55 - only day 55 - should be 72 datapoints ####

Rawdata_experimentAugust2018_720_day55<-Rawdata_experimentAugust2018_720[(Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day55) #72 86
head(Rawdata_experimentAugust2018_720_day55)

Rawdata_experimentAugust2018_720_day55_cum<-Rawdata_experimentAugust2018_720_day55%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))



Rawdata_experimentAugust2018_720_day55_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day55_cum)
head(Rawdata_experimentAugust2018_720_day55_cum)
dim(Rawdata_experimentAugust2018_720_day55_cum)


#delete NA
Rawdata_experimentAugust2018_720_day55_cum <- Rawdata_experimentAugust2018_720_day55_cum[!is.na(Rawdata_experimentAugust2018_720_day55_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day55_cum)

# make days column
Rawdata_experimentAugust2018_720_day55_cum$Daysfactor<-rep("55")
head(Rawdata_experimentAugust2018_720_day55_cum)
str(Rawdata_experimentAugust2018_720_day55_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day55_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day55_large<-left_join(Rawdata_experimentAugust2018_720_day55_cum,Rawdata_experimentAugust2018_720_day55)

head(Rawdata_experimentAugust2018_720_day55_large)
dim(Rawdata_experimentAugust2018_720_day55_large) #72 57


##############
### day 63 should be 144 datapoints #######

Rawdata_experimentAugust2018_720_day63<-Rawdata_experimentAugust2018_720[(Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day63) 
head(Rawdata_experimentAugust2018_720_day63)

# get cumulative sum
Rawdata_experimentAugust2018_720_day63_cum<-Rawdata_experimentAugust2018_720_day63%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day63_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day63_cum)
head(Rawdata_experimentAugust2018_720_day63_cum)
dim(Rawdata_experimentAugust2018_720_day63_cum)


#delete NA
Rawdata_experimentAugust2018_720_day63_cum <- Rawdata_experimentAugust2018_720_day63_cum[!is.na(Rawdata_experimentAugust2018_720_day63_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day63_cum)

# make days column
Rawdata_experimentAugust2018_720_day63_cum$Daysfactor<-rep("63")
head(Rawdata_experimentAugust2018_720_day63_cum)
str(Rawdata_experimentAugust2018_720_day63_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day63_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day63_large<-left_join(Rawdata_experimentAugust2018_720_day63_cum,Rawdata_experimentAugust2018_720_day63)

head(Rawdata_experimentAugust2018_720_day63_large)
dim(Rawdata_experimentAugust2018_720_day63_large) #72 57


##############
### day 67 should be 216 datapoints ####
##(215 b/c removed one point b/c weight wrong and so count could be wrong too)

Rawdata_experimentAugust2018_720_day67<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day67) 
head(Rawdata_experimentAugust2018_720_day67)


# get cumulative sum
Rawdata_experimentAugust2018_720_day67_cum<-Rawdata_experimentAugust2018_720_day67%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day67_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day67_cum)
head(Rawdata_experimentAugust2018_720_day67_cum)
dim(Rawdata_experimentAugust2018_720_day67_cum)


#delete NA
Rawdata_experimentAugust2018_720_day67_cum <- Rawdata_experimentAugust2018_720_day67_cum[!is.na(Rawdata_experimentAugust2018_720_day67_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day67_cum)

# make days column
Rawdata_experimentAugust2018_720_day67_cum$Daysfactor<-rep("67")
head(Rawdata_experimentAugust2018_720_day67_cum)
str(Rawdata_experimentAugust2018_720_day67_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day67_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day67_large<-left_join(Rawdata_experimentAugust2018_720_day67_cum,Rawdata_experimentAugust2018_720_day67)

head(Rawdata_experimentAugust2018_720_day67_large)
dim(Rawdata_experimentAugust2018_720_day67_large) #71 87 - one less b/c deleted one point

#################
### day 70 should be 288 datapoints ####

Rawdata_experimentAugust2018_720_day70<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="70"|Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day70) 
head(Rawdata_experimentAugust2018_720_day70)

# get cumulative sum
Rawdata_experimentAugust2018_720_day70_cum<-Rawdata_experimentAugust2018_720_day70%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day70_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day70_cum)
head(Rawdata_experimentAugust2018_720_day70_cum)
dim(Rawdata_experimentAugust2018_720_day70_cum)


#delete NA
Rawdata_experimentAugust2018_720_day70_cum <- Rawdata_experimentAugust2018_720_day70_cum[!is.na(Rawdata_experimentAugust2018_720_day70_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day70_cum)

# make days column
Rawdata_experimentAugust2018_720_day70_cum$Daysfactor<-rep("70")
head(Rawdata_experimentAugust2018_720_day70_cum)
str(Rawdata_experimentAugust2018_720_day70_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day70_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day70_large<-left_join(Rawdata_experimentAugust2018_720_day70_cum,Rawdata_experimentAugust2018_720_day70)

head(Rawdata_experimentAugust2018_720_day70_large)
dim(Rawdata_experimentAugust2018_720_day70_large) #72 87 




################
### day 74 should be 360 datapoints ####

Rawdata_experimentAugust2018_720_day74<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="74"|Rawdata_experimentAugust2018_720$Daysfactor=="70"|Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day74) 
head(Rawdata_experimentAugust2018_720_day74)

# get cumulative sum
Rawdata_experimentAugust2018_720_day74_cum<-Rawdata_experimentAugust2018_720_day74%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day74_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day74_cum)
head(Rawdata_experimentAugust2018_720_day74_cum)
dim(Rawdata_experimentAugust2018_720_day74_cum)


#delete NA
Rawdata_experimentAugust2018_720_day74_cum <- Rawdata_experimentAugust2018_720_day74_cum[!is.na(Rawdata_experimentAugust2018_720_day74_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day74_cum)

# make days column
Rawdata_experimentAugust2018_720_day74_cum$Daysfactor<-rep("74")
head(Rawdata_experimentAugust2018_720_day74_cum)
str(Rawdata_experimentAugust2018_720_day74_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day74_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day74_large<-left_join(Rawdata_experimentAugust2018_720_day74_cum,Rawdata_experimentAugust2018_720_day74)

head(Rawdata_experimentAugust2018_720_day74_large)
dim(Rawdata_experimentAugust2018_720_day74_large) #72 87 




##################
### day 77 should be 432 datapoints ####
Rawdata_experimentAugust2018_720_day77<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="77"|Rawdata_experimentAugust2018_720$Daysfactor=="74"|Rawdata_experimentAugust2018_720$Daysfactor=="70"|Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day77) 
head(Rawdata_experimentAugust2018_720_day77)

# get cumulative sum
Rawdata_experimentAugust2018_720_day77_cum<-Rawdata_experimentAugust2018_720_day77%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day77_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day77_cum)
head(Rawdata_experimentAugust2018_720_day77_cum)
dim(Rawdata_experimentAugust2018_720_day77_cum)


#delete NA
Rawdata_experimentAugust2018_720_day77_cum <- Rawdata_experimentAugust2018_720_day77_cum[!is.na(Rawdata_experimentAugust2018_720_day77_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day77_cum)

# make days column
Rawdata_experimentAugust2018_720_day77_cum$Daysfactor<-rep("77")
head(Rawdata_experimentAugust2018_720_day77_cum)
str(Rawdata_experimentAugust2018_720_day77_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day77_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day77_large<-left_join(Rawdata_experimentAugust2018_720_day77_cum,Rawdata_experimentAugust2018_720_day77)

head(Rawdata_experimentAugust2018_720_day77_large)
dim(Rawdata_experimentAugust2018_720_day77_large) #71 87


#################
### day 80 should be 504 datapoints ####
Rawdata_experimentAugust2018_720_day80<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="80"|Rawdata_experimentAugust2018_720$Daysfactor=="77"|Rawdata_experimentAugust2018_720$Daysfactor=="74"|Rawdata_experimentAugust2018_720$Daysfactor=="70"|Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day80) 
head(Rawdata_experimentAugust2018_720_day80)

# get cumulative sum
Rawdata_experimentAugust2018_720_day80_cum<-Rawdata_experimentAugust2018_720_day80%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day80_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day80_cum)
head(Rawdata_experimentAugust2018_720_day80_cum)
dim(Rawdata_experimentAugust2018_720_day80_cum)


#delete NA
Rawdata_experimentAugust2018_720_day80_cum <- Rawdata_experimentAugust2018_720_day80_cum[!is.na(Rawdata_experimentAugust2018_720_day80_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day80_cum)

# make days column
Rawdata_experimentAugust2018_720_day80_cum$Daysfactor<-rep("80")
head(Rawdata_experimentAugust2018_720_day80_cum)
str(Rawdata_experimentAugust2018_720_day80_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day80_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day80_large<-left_join(Rawdata_experimentAugust2018_720_day80_cum,Rawdata_experimentAugust2018_720_day80)

head(Rawdata_experimentAugust2018_720_day80_large)
dim(Rawdata_experimentAugust2018_720_day80_large) #72 87

###############
### day 83 should be 576 datapoints ####
Rawdata_experimentAugust2018_720_day83<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="83"|Rawdata_experimentAugust2018_720$Daysfactor=="80"|Rawdata_experimentAugust2018_720$Daysfactor=="77"|Rawdata_experimentAugust2018_720$Daysfactor=="74"|Rawdata_experimentAugust2018_720$Daysfactor=="70"|Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day83) 
head(Rawdata_experimentAugust2018_720_day83)

# get cumulative sum
Rawdata_experimentAugust2018_720_day83_cum<-Rawdata_experimentAugust2018_720_day83%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day83_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day83_cum)
head(Rawdata_experimentAugust2018_720_day83_cum)
dim(Rawdata_experimentAugust2018_720_day83_cum)


#delete NA
Rawdata_experimentAugust2018_720_day83_cum <- Rawdata_experimentAugust2018_720_day83_cum[!is.na(Rawdata_experimentAugust2018_720_day83_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day83_cum)

# make days column
Rawdata_experimentAugust2018_720_day83_cum$Daysfactor<-rep("83")
head(Rawdata_experimentAugust2018_720_day83_cum)
str(Rawdata_experimentAugust2018_720_day83_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day83_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day83_large<-left_join(Rawdata_experimentAugust2018_720_day83_cum,Rawdata_experimentAugust2018_720_day83)

head(Rawdata_experimentAugust2018_720_day83_large)
dim(Rawdata_experimentAugust2018_720_day83_large) #72 87

##################
### day 87 should be 648 datapoints ####
Rawdata_experimentAugust2018_720_day87<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="87"|Rawdata_experimentAugust2018_720$Daysfactor=="83"|Rawdata_experimentAugust2018_720$Daysfactor=="80"|Rawdata_experimentAugust2018_720$Daysfactor=="77"|Rawdata_experimentAugust2018_720$Daysfactor=="74"|Rawdata_experimentAugust2018_720$Daysfactor=="70"|Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day87) 
head(Rawdata_experimentAugust2018_720_day87)

# get cumulative sum
Rawdata_experimentAugust2018_720_day87_cum<-Rawdata_experimentAugust2018_720_day87%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day87_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day87_cum)
head(Rawdata_experimentAugust2018_720_day87_cum)
dim(Rawdata_experimentAugust2018_720_day87_cum)


#delete NA
Rawdata_experimentAugust2018_720_day87_cum <- Rawdata_experimentAugust2018_720_day87_cum[!is.na(Rawdata_experimentAugust2018_720_day87_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day87_cum)

# make days column
Rawdata_experimentAugust2018_720_day87_cum$Daysfactor<-rep("87")
head(Rawdata_experimentAugust2018_720_day87_cum)
str(Rawdata_experimentAugust2018_720_day87_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day87_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day87_large<-left_join(Rawdata_experimentAugust2018_720_day87_cum,Rawdata_experimentAugust2018_720_day87)

head(Rawdata_experimentAugust2018_720_day87_large)
dim(Rawdata_experimentAugust2018_720_day87_large) #72 87

#################
### day 90 should be 720 datapoints ####
Rawdata_experimentAugust2018_720_day90<-Rawdata_experimentAugust2018_720[c(Rawdata_experimentAugust2018_720$Daysfactor=="90"|Rawdata_experimentAugust2018_720$Daysfactor=="87"|Rawdata_experimentAugust2018_720$Daysfactor=="83"|Rawdata_experimentAugust2018_720$Daysfactor=="80"|Rawdata_experimentAugust2018_720$Daysfactor=="77"|Rawdata_experimentAugust2018_720$Daysfactor=="74"|Rawdata_experimentAugust2018_720$Daysfactor=="70"|Rawdata_experimentAugust2018_720$Daysfactor=="67"| Rawdata_experimentAugust2018_720$Daysfactor=="63"| Rawdata_experimentAugust2018_720$Daysfactor=="55"),]
dim(Rawdata_experimentAugust2018_720_day90) 
head(Rawdata_experimentAugust2018_720_day90)

# get cumulative sum
Rawdata_experimentAugust2018_720_day90_cum<-Rawdata_experimentAugust2018_720_day90%>% 
  group_by(Tank) %>% 
  summarise(Cumulative_Count_juv_emerged= sum(Count_juv_emerged))


Rawdata_experimentAugust2018_720_day90_cum<-as.data.frame(Rawdata_experimentAugust2018_720_day90_cum)
head(Rawdata_experimentAugust2018_720_day90_cum)
dim(Rawdata_experimentAugust2018_720_day90_cum)


#delete NA
Rawdata_experimentAugust2018_720_day90_cum <- Rawdata_experimentAugust2018_720_day90_cum[!is.na(Rawdata_experimentAugust2018_720_day90_cum$Tank),]
dim(Rawdata_experimentAugust2018_720_day90_cum)

# make days column
Rawdata_experimentAugust2018_720_day90_cum$Daysfactor<-rep("90")
head(Rawdata_experimentAugust2018_720_day90_cum)
str(Rawdata_experimentAugust2018_720_day90_cum$Daysfactor)
dim(Rawdata_experimentAugust2018_720_day90_cum)

# join with other variables
Rawdata_experimentAugust2018_720_day90_large<-left_join(Rawdata_experimentAugust2018_720_day90_cum,Rawdata_experimentAugust2018_720_day90)

head(Rawdata_experimentAugust2018_720_day90_large)
dim(Rawdata_experimentAugust2018_720_day90_large) #72 90





############### join now merge all 10 datasets together with row bind ########

# didn't work
#Rawdata_experimentAugust2018_510_cumsumtest<-bind_rows(list(Rawdata_experimentAugust2018_720_day55_large, Rawdata_experimentAugust2018_720_day63_large, Rawdata_experimentAugust2018_720_day67_large, Rawdata_experimentAugust2018_720_day70_large, Rawdata_experimentAugust2018_720_day74_large, Rawdata_experimentAugust2018_720_day77, Rawdata_experimentAugust2018_720_day80_large, Rawdata_experimentAugust2018_720_day83_large, Rawdata_experimentAugust2018_720_day87_large, Rawdata_experimentAugust2018_720_day90_large))

#dim(Rawdata_experimentAugust2018_720_cumsumtest)


# another way
join63<-dplyr::bind_rows(Rawdata_experimentAugust2018_720_day55_large, Rawdata_experimentAugust2018_720_day63_large)
head(join63)
dim(join63) #144  57

join67<-dplyr::bind_rows(join63, Rawdata_experimentAugust2018_720_day67_large)
head(join67)
dim(join67) #216  57

join70<-dplyr::bind_rows(join67, Rawdata_experimentAugust2018_720_day70_large)
head(join70)
dim(join70) #288  57


join74<-dplyr::bind_rows(join70, Rawdata_experimentAugust2018_720_day74_large)
head(join74)
dim(join74) #360  57


join77<-dplyr::bind_rows(join74, Rawdata_experimentAugust2018_720_day77_large)
head(join77)
dim(join77) #432  57

join80<-dplyr::bind_rows(join77, Rawdata_experimentAugust2018_720_day80_large)
head(join80)
dim(join80) #504  57

join83<-dplyr::bind_rows(join80, Rawdata_experimentAugust2018_720_day83_large)
head(join83)
dim(join83) #576  57

join87<-dplyr::bind_rows(join83, Rawdata_experimentAugust2018_720_day87_large)
head(join87)
dim(join87) #648  57

join90<-dplyr::bind_rows(join87, Rawdata_experimentAugust2018_720_day90_large)
head(join90)
dim(join90) #720 57

Rawdata_experimentAugust2018_720_cumsum<-join90
head(Rawdata_experimentAugust2018_720_cumsum)
dim(Rawdata_experimentAugust2018_720_cumsum) #720




## join with other dataset ############

##############
Mortalitydataset_26_06_2021<-read.csv(file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_07_06_21/Mortalitydataset_26_06_2021.csv",header=T,row.names=NULL,sep=",")

Rawdata_experimentAugust2018_720_cumsum<-left_join(Rawdata_experimentAugust2018_720_cumsum,Mortalitydataset_26_06_2021,by="Tank")


#order levels of factor
Rawdata_experimentAugust2018_720_cumsum$Competition_level<- factor(Rawdata_experimentAugust2018_720_cumsum$Competition_level, levels = c("Low_control","FrogML","FrogHG","High_control"))
Rawdata_experimentAugust2018_720_cumsum<- droplevels(Rawdata_experimentAugust2018_720_cumsum)

#days as factor
Rawdata_experimentAugust2018_720_cumsum$Daysfactor<-as.factor(Rawdata_experimentAugust2018_720_cumsum$Days)

############ calculate toad growth rate
Rawdata_experimentAugust2018_720_cumsum$GR_finalmin_intial_degreedays_mgDD<-((Rawdata_experimentAugust2018_720_cumsum$Av_juv_biomass-Rawdata_experimentAugust2018_720_cumsum$X25.5.18_experiment_start_tapole_av_individual_weight)/Rawdata_experimentAugust2018_720_cumsum$SumDD)*1000


############ calculate toad growth rate - Richter Boix 2011
Rawdata_experimentAugust2018_720_cumsum$GR_final_days_mgDay<-(Rawdata_experimentAugust2018_720_cumsum$Av_juv_biomass/Rawdata_experimentAugust2018_720_cumsum$Days)*1000



# log
Rawdata_experimentAugust2018_720_cumsum$log_GR_final_days_mgDay<-log(Rawdata_experimentAugust2018_720_cumsum$GR_final_days_mgDay)
hist(Rawdata_experimentAugust2018_720_cumsum$log_GR_final_days_mgDay)


#### percetnage tadpole additions due to diving beetle predation
Rawdata_experimentAugust2018_720_cumsum$toadTadpoles_added_as_top.up_june7thand8th_percentagetotal<-(Rawdata_experimentAugust2018_720_cumsum$Tadpoles_added_as_top.up_june7thand8th/Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start)*100

#### percapita tadpole additions due to diving beetle predation
Rawdata_experimentAugust2018_720_cumsum$toadTadpoles_added_as_top.up_june7thand8th_percapita<-(Rawdata_experimentAugust2018_720_cumsum$Tadpoles_added_as_top.up_june7thand8th/Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start)

#########################
############### SCALING ##########
######################

#starting weight
Xtemp <- Rawdata_experimentAugust2018_720_cumsum$X25.5.18_experiment_start_tapole_av_individual_weight 
Xtemp

Xscaled <- (Xtemp - mean(Xtemp))/sd(Xtemp)
Rawdata_experimentAugust2018_720_cumsum$scaled_X25.5.18_experiment_start_tapole_av_individual_weight  <- Xscaled

### tadpole top up
Xtemp2 <-Rawdata_experimentAugust2018_720_cumsum$toadTadpoles_added_as_top.up_june7thand8th_percapita 

Xscaled2 <- (Xtemp2 - mean(Xtemp2))/sd(Xtemp2)
Rawdata_experimentAugust2018_720_cumsum$scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita  <- Xscaled2

### mortality
Xtemp3 <-Rawdata_experimentAugust2018_720_cumsum$Mortality_tadsadded_26_06_21_percapita 

Xscaled3 <- (Xtemp3 - mean(Xtemp3))/sd(Xtemp3)
Rawdata_experimentAugust2018_720_cumsum$scaled_Mortality_tadsadded_26_06_21_percapita  <- Xscaled3


###### add density minus mortality column #######

Rawdata_experimentAugust2018_720_cumsum$Density_minus_mortality<-
  Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start - 
  Rawdata_experimentAugust2018_720_cumsum$Mortality_06_05_20

Rawdata_experimentAugust2018_720_cumsum$Density_minus_mortality_percapita<-
  Rawdata_experimentAugust2018_720_cumsum$Density_minus_mortality/
  Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start

# ------------------------

Rawdata_experimentAugust2018_720_cumsum$Density_tadsadded_minus_mortality<-
  (Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start +
     Rawdata_experimentAugust2018_720_cumsum$Tadpoles_added_as_top.up_june7thand8th) - 
  
  Rawdata_experimentAugust2018_720_cumsum$Mortality_tadsadded_26_06_21

## ---------------


Rawdata_experimentAugust2018_720_cumsum$Density_tadsadded_minus_mortality_percapita<-
  Rawdata_experimentAugust2018_720_cumsum$Density_tadsadded_minus_mortality / 
  (Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start+
     Rawdata_experimentAugust2018_720_cumsum$Tadpoles_added_as_top.up_june7thand8th)



### scaled Density_tadsadded_minus_mortality_percapita
Xtemp4 <-Rawdata_experimentAugust2018_720_cumsum$Density_tadsadded_minus_mortality_percapita 

Xscaled4 <- (Xtemp4 - mean(Xtemp4))/sd(Xtemp4)
Rawdata_experimentAugust2018_720_cumsum$scaled_Density_tadsadded_minus_mortality_percapita  <- Xscaled4


### scaled Count_toads_left_b4weigh
Xtemp5 <-Rawdata_experimentAugust2018_720_cumsum$Count_toads_left_b4weigh 

Xscaled5 <- (Xtemp5 - mean(Xtemp5))/sd(Xtemp5)
Rawdata_experimentAugust2018_720_cumsum$scaled_Count_toads_left_b4weigh  <- Xscaled5



##  Mortality_06_05_20_percapita



Xtemp6 <-Rawdata_experimentAugust2018_720_cumsum$Mortality_06_05_20_percapita 

Xscaled6 <- (Xtemp6 - mean(Xtemp6))/sd(Xtemp6)
Rawdata_experimentAugust2018_720_cumsum$scaled_Mortality_06_05_20_percapita  <- Xscaled6



### Total_chla_conc_26.7.18_ug.l

Xtemp7 <-Rawdata_experimentAugust2018_720_cumsum$Total_chla_conc_26.7.18_ug.l

Xscaled7 <- (Xtemp7 - mean(Xtemp7))/sd(Xtemp7)
Rawdata_experimentAugust2018_720_cumsum$scaled_Total_chla_conc_26.7.18_ug.l  <- Xscaled7

######### Mean_averageTemp
Xtemp8 <-Rawdata_experimentAugust2018_720_cumsum$Mean_averageTemp

Xscaled8 <- (Xtemp8 - mean(Xtemp8))/sd(Xtemp8)
Rawdata_experimentAugust2018_720_cumsum$scaled_Mean_averageTemp  <- Xscaled8





##### add treatment column thats frogs ml, frogs hg, no frogs ###

Rawdata_experimentAugust2018_720_cumsum$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720_cumsum$Competition_level== "Low_control"] <- "No_frogs"

Rawdata_experimentAugust2018_720_cumsum$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720_cumsum$Competition_level== "High_control"] <- "No_frogs"

Rawdata_experimentAugust2018_720_cumsum$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720_cumsum$Competition_level== "FrogML"] <- "FrogML"

Rawdata_experimentAugust2018_720_cumsum$Treatment_3_FROGMlHG_NOfrogs[Rawdata_experimentAugust2018_720_cumsum$Competition_level== "FrogHG"] <- "FrogHG"



## make sure all random effects are factors
levels(Rawdata_experimentAugust2018_720_cumsum$Daysfactor)

levels(Rawdata_experimentAugust2018_720_cumsum$Population)



Rawdata_experimentAugust2018_720_cumsum$Tank_factor<-as.factor((Rawdata_experimentAugust2018_720_cumsum$Tank))

levels(Rawdata_experimentAugust2018_720_cumsum$Tank_factor)


Rawdata_experimentAugust2018_720_cumsum$Block_factor<-as.factor((Rawdata_experimentAugust2018_720_cumsum$Block))

Rawdata_experimentAugust2018_720_cumsum$Region_factor<-as.factor((Rawdata_experimentAugust2018_720_cumsum$Region))

levels(Rawdata_experimentAugust2018_720_cumsum$Region_factor)


Rawdata_experimentAugust2018_720_cumsum$Population_factor<-as.factor((Rawdata_experimentAugust2018_720_cumsum$Population))

levels(Rawdata_experimentAugust2018_720_cumsum$Population_factor)



### ave weight
Rawdata_experimentAugust2018_720_cumsum$Av_juv_biomass_mg<-Rawdata_experimentAugust2018_720_cumsum$Av_juv_biomass*1000



#log - looks good
Rawdata_experimentAugust2018_720_cumsum$log_Av_juv_biomass<-log(Rawdata_experimentAugust2018_720_cumsum$Av_juv_biomass)


Rawdata_experimentAugust2018_720_cumsum$log_Av_juv_biomass_mg<-log(Rawdata_experimentAugust2018_720_cumsum$Av_juv_biomass_mg)




## including toads added as top up
Rawdata_experimentAugust2018_720_cumsum$toadTadpoles_added_as_top.up_june7thand8th<-Rawdata_experimentAugust2018_720_cumsum$toadTadpoles_added_as_top.up_june7thand8th_percapita*Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start

Rawdata_experimentAugust2018_720_cumsum$Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th<-Rawdata_experimentAugust2018_720_cumsum$toadTadpoles_added_as_top.up_june7thand8th+Rawdata_experimentAugust2018_720_cumsum$Total_number_individuals_start


##### CUMULATIVE
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/hist_Cumulative_Count_juv_emerged_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/hist_log_Cumulative_Count_juv_emerged_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged))
dev.off()



Rawdata_experimentAugust2018_720_cumsum$log_Cumulative_Count_juv_emerged<-(log(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged))




### PERCAPITA
Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged_percapita<-Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged/Rawdata_experimentAugust2018_720_cumsum$Totalindivstart_PLUS_toadTadpoles_added_as_top.up_june7thand8th


Rawdata_experimentAugust2018_720_cumsum$log_Cumulative_Count_juv_emerged_percapita<-log(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged_percapita)

Rawdata_experimentAugust2018_720_cumsum$log10_Cumulative_Count_juv_emerged_percapita<-log10(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged_percapita)

##############################
############## LMMR ########
#####################



## log10
##### model_CumCJ8 #####
### BEST 19.01.22
####### add intital weight



Rawdata_experimentAugust2018_720_cumsum_nozeros<-Rawdata_experimentAugust2018_720_cumsum[!(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_cumsum_nozeros) #664  86


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/hist_log10_Cumulative_Count_juv_emerged_percapita_NOZEROS_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist((Rawdata_experimentAugust2018_720_cumsum_nozeros$log10_Cumulative_Count_juv_emerged_percapita))
dev.off()



model_CumCJ8<-lmer(log10_Cumulative_Count_juv_emerged_percapita~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     Mortality_06_05_20_percapita+
                     Days*Competition_level+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days|Tank_factor)+
                     (1|Population_factor),
                   data=Rawdata_experimentAugust2018_720_cumsum_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CumCJ8)
AIC(model_CumCJ8) #  -401.1277
summary(model_CumCJ8)


#664
capture.output(anova(model_CumCJ8),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ8_664.txt")
write.csv(anova(model_CumCJ8),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ8_664.csv")
capture.output(summary(model_CumCJ8),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ8_664.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ8))
hist(resid(model_CumCJ8))
plot(model_CumCJ8)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ8_664.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ8)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ8_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ8))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ8_664.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ8))
dev.off()



## interaction plots
(model_CumCJ8.means <- interactionMeans(model_CumCJ8))
plot(model_CumCJ8.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ8_664.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ8.means <- interactionMeans(model_CumCJ8))
plot(model_CumCJ8.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ8_664.svg", width = 8, height = 6.5)
(model_CumCJ8.means <- interactionMeans(model_CumCJ8))
plot(model_CumCJ8.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ8)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ8_664.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ8)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ8_664.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ8)
dev.off()





##### model_CumCJ6 #####
####### add intital weight


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/hist_log_natural_Cumulative_Count_juv_emerged_percapita_NOZEROS_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist((Rawdata_experimentAugust2018_720_cumsum_nozeros$log_Cumulative_Count_juv_emerged_percapita))
dev.off()

model_CumCJ6<-lmer(log_Cumulative_Count_juv_emerged_percapita~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     Mortality_06_05_20_percapita+
                     Days*Competition_level+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days|Tank_factor)+
                     (1|Population_factor),
                   data=Rawdata_experimentAugust2018_720_cumsum_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CumCJ6)
AIC(model_CumCJ6) #   -5418.439
summary(model_CumCJ6)


#664
capture.output(anova(model_CumCJ6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ6_664.txt")
write.csv(anova(model_CumCJ6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ6_664.csv")
capture.output(summary(model_CumCJ6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ6_664.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ6))
hist(resid(model_CumCJ6))
plot(model_CumCJ6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ6_664.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ6_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ6_664.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ6))
dev.off()



## interaction plots
(model_CumCJ6.means <- interactionMeans(model_CumCJ6))
plot(model_CumCJ6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ6_664.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ6.means <- interactionMeans(model_CumCJ6))
plot(model_CumCJ6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ6_664.svg", width = 8, height = 6.5)
(model_CumCJ6.means <- interactionMeans(model_CumCJ6))
plot(model_CumCJ6.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ6_664.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ6_664.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ6)
dev.off()



### model_CumCJ7 #####
### added region*day interaction
####### add intital weight
Rawdata_experimentAugust2018_720_cumsum_nozeros<-Rawdata_experimentAugust2018_720_cumsum[!(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_cumsum_nozeros) #664  86

model_CumCJ7<-lmer(log_Cumulative_Count_juv_emerged_percapita~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     Mortality_06_05_20_percapita+
                     Days*Competition_level*Region+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days|Tank_factor)+
                     (1|Population_factor),
                   data=Rawdata_experimentAugust2018_720_cumsum_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CumCJ7)
AIC(model_CumCJ7) #   -5420.809
summary(model_CumCJ7)


#664
capture.output(anova(model_CumCJ7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ7_664.txt")
write.csv(anova(model_CumCJ7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ7_664.csv")
capture.output(summary(model_CumCJ7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ7_664.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ7))
hist(resid(model_CumCJ7))
plot(model_CumCJ7)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ7_664.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ7)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ7_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ7))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ7_664.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ7))
dev.off()



## interaction plots
(model_CumCJ7.means <- interactionMeans(model_CumCJ7))
plot(model_CumCJ7.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ7_664.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ7.means <- interactionMeans(model_CumCJ7))
plot(model_CumCJ7.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ7_664.svg", width = 8, height = 6.5)
(model_CumCJ7.means <- interactionMeans(model_CumCJ7))
plot(model_CumCJ7.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ7)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ7_664.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ7)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ7_664.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ7)
dev.off()





#### model_CumCJ4.1 #####
#### log
#### remove zeros
Rawdata_experimentAugust2018_720_cumsum_nozeros<-Rawdata_experimentAugust2018_720_cumsum[!(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_cumsum_nozeros) #664  86

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/hist_log_Cumulative_Count_juv_emerged_percapita_NOZEROS_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log(Rawdata_experimentAugust2018_720_cumsum_nozeros$Cumulative_Count_juv_emerged_percapita))
dev.off()

dim(Rawdata_experimentAugust2018_720_cumsum_nozeros) #664  85



model_CumCJ4.1<-lmer(log_Cumulative_Count_juv_emerged_percapita~
                       Region*Competition_level+ 
                       scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                       #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                       Mortality_06_05_20_percapita+
                       Days*Competition_level+
                       Mean_averageTemp+ #fixed effects
                       Block_factor+
                       #Total_chla_conc_26.7.18_ug.l+
                       #(1|Daysfactor)+
                       
                       #(1|Daysfactor/Tank_factor)+
                       (1+Days|Tank_factor)+
                       (1|Population_factor),
                     data=Rawdata_experimentAugust2018_720_cumsum_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CumCJ4.1)
AIC(model_CumCJ4.1) #   -5420.413
summary(model_CumCJ4.1)


#664
capture.output(anova(model_CumCJ4.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ4.1_664.txt")
write.csv(anova(model_CumCJ4.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ4.1_664.csv")
capture.output(summary(model_CumCJ4.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ4.1_664.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ4.1))
hist(resid(model_CumCJ4.1))
plot(model_CumCJ4.1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ4.1_664.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ4.1)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ4.1_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ4.1))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ4.1_664.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ4.1))
dev.off()



## interaction plots
(model_CumCJ4.1.means <- interactionMeans(model_CumCJ4.1))
plot(model_CumCJ4.1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ4.1_664.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ4.1.means <- interactionMeans(model_CumCJ4.1))
plot(model_CumCJ4.1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ4.1_664.svg", width = 8, height = 6.5)
(model_CumCJ4.1.means <- interactionMeans(model_CumCJ4.1))
plot(model_CumCJ4.1.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ4.1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ4.1_664.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ4.1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ4.1_664.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ4.1)
dev.off()







#### model_CumCJ3 ####
model_CumCJ3<-lmer(Cumulative_Count_juv_emerged~
                     Region*Competition_level+ 
                     #scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     #scaled_Mortality_06_05_20_percapita+
                     Days*Competition_level+
                     scaled_Mean_averageTemp+ #fixed effects
                     Block_factor+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days|Tank_factor)+
                     (1|Population_factor),
                   data=Rawdata_experimentAugust2018_720_cumsum,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

dim(Rawdata_experimentAugust2018_720_cumsum)


anova(model_CumCJ3)
AIC(model_CumCJ3) #   4705.873
summary(model_CumCJ3)


#720
capture.output(anova(model_CumCJ3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ3_720.txt")
write.csv(anova(model_CumCJ3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ3_720.csv")
capture.output(summary(model_CumCJ3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ3_720.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ3))
hist(resid(model_CumCJ3))
plot(model_CumCJ3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ3_720.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ3)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ3_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ3))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ3_720.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ3))
dev.off()



## interaction plots
(model_CumCJ3.means <- interactionMeans(model_CumCJ3))
plot(model_CumCJ3.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ3_720.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ3.means <- interactionMeans(model_CumCJ3))
plot(model_CumCJ3.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ3_720.svg", width = 8, height = 6.5)
(model_CumCJ3.means <- interactionMeans(model_CumCJ3))
plot(model_CumCJ3.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ3_720.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ3)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ3_720.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ3)
dev.off()



#### model_CumCJ4 #####
#### log
#### remove zeros
Rawdata_experimentAugust2018_720_cumsum_nozeros<-Rawdata_experimentAugust2018_720_cumsum[!(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_cumsum_nozeros) #664  86

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/hist_log_Cumulative_Count_juv_emerged_NOZEROS_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log(Rawdata_experimentAugust2018_720_cumsum_nozeros$Cumulative_Count_juv_emerged))
dev.off()

dim(Rawdata_experimentAugust2018_720_cumsum_nozeros) #664  85



model_CumCJ4<-lmer(log_Cumulative_Count_juv_emerged~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     Mortality_06_05_20_percapita+
                     Days*Competition_level+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days|Tank_factor)+
                     (1|Population_factor),
                   data=Rawdata_experimentAugust2018_720_cumsum_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CumCJ4)
AIC(model_CumCJ4) #   705.0412
summary(model_CumCJ4)


#664
capture.output(anova(model_CumCJ4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ4_664.txt")
write.csv(anova(model_CumCJ4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ4_664.csv")
capture.output(summary(model_CumCJ4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ4_664.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ4))
hist(resid(model_CumCJ4))
plot(model_CumCJ4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ4_664.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ4)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ4_664.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ4))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ4_664.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ4))
dev.off()



## interaction plots
(model_CumCJ4.means <- interactionMeans(model_CumCJ4))
plot(model_CumCJ4.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ4_664.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ4.means <- interactionMeans(model_CumCJ4))
plot(model_CumCJ4.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ4_664.svg", width = 8, height = 6.5)
(model_CumCJ4.means <- interactionMeans(model_CumCJ4))
plot(model_CumCJ4.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ4_664.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ4)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ4_664.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ4)
dev.off()


#### model_CumCJ3.1 #####
model_CumCJ3.1<-lmer(Cumulative_Count_juv_emerged_percapita~
                       Region*Competition_level+ 
                       #scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                       #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                       #scaled_Mortality_06_05_20_percapita+
                       Days*Competition_level+
                       scaled_Mean_averageTemp+ #fixed effects
                       Block_factor+
                       #Total_chla_conc_26.7.18_ug.l+
                       #(1|Daysfactor)+
                       
                       #(1|Daysfactor/Tank_factor)+
                       (1+Days|Tank_factor)+
                       (1|Population_factor),
                     data=Rawdata_experimentAugust2018_720_cumsum,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))

dim(Rawdata_experimentAugust2018_720_cumsum)


anova(model_CumCJ3.1)
AIC(model_CumCJ3.1) #   -1961.877
summary(model_CumCJ3.1)


#720
capture.output(anova(model_CumCJ3.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ3.1_720.txt")
write.csv(anova(model_CumCJ3.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ3.1_720.csv")
capture.output(summary(model_CumCJ3.1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ3.1_720.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ3.1))
hist(resid(model_CumCJ3.1))
plot(model_CumCJ3.1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ3.1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ3.1)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ3.1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ3.1))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ3.1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ3.1))
dev.off()



## interaction plots
(model_CumCJ3.1.means <- interactionMeans(model_CumCJ3.1))
plot(model_CumCJ3.1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ3.1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ3.1.means <- interactionMeans(model_CumCJ3.1))
plot(model_CumCJ3.1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ3.1_720.svg", width = 8, height = 6.5)
(model_CumCJ3.1.means <- interactionMeans(model_CumCJ3.1))
plot(model_CumCJ3.1.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ3.1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ3.1_720.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ3.1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ3.1_720.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ3.1)
dev.off()








#### model_CumCJ5 #####
#### arcsine

Rawdata_experimentAugust2018_720_cumsum$arcsin_Cumulative_Count_juv_emerged_percapita<-transf.arcsin(Rawdata_experimentAugust2018_720_cumsum$Cumulative_Count_juv_emerged_percapita)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/hist_arsine_Cumulative_Count_juv_emerged_percapita_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_720_cumsum$arcsin_Cumulative_Count_juv_emerged_percapita)
dev.off()


model_CumCJ5<-lmer(arcsin_Cumulative_Count_juv_emerged_percapita~
                     Region*Competition_level+ 
                     scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                     #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                     Mortality_06_05_20_percapita+
                     Days*Competition_level+
                     Mean_averageTemp+ #fixed effects
                     Block_factor+
                     #Total_chla_conc_26.7.18_ug.l+
                     #(1|Daysfactor)+
                     
                     #(1|Daysfactor/Tank_factor)+
                     (1+Days|Tank_factor)+
                     (1|Population_factor),
                   data=Rawdata_experimentAugust2018_720_cumsum,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CumCJ5)
AIC(model_CumCJ5) #   -1643.406
summary(model_CumCJ5)


#720
capture.output(anova(model_CumCJ5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ5_720.txt")
write.csv(anova(model_CumCJ5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/anova_cumulativesumjuveniles_perday_pertank_model_CumCJ5_720.csv")
capture.output(summary(model_CumCJ5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/summary_cumulativesumjuveniles_perday_pertank_model_CumCJ5_720.txt")


### test residuals - mostly ok
qqnorm(resid(model_CumCJ5))
hist(resid(model_CumCJ5))
plot(model_CumCJ5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualsplot_model_CumCJ5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CumCJ5)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/Residualshist_model_CumCJ5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CumCJ5))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/QQnorm_model_CumCJ5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CumCJ5))
dev.off()



## interaction plots
(model_CumCJ5.means <- interactionMeans(model_CumCJ5))
plot(model_CumCJ5.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CumCJ5.means <- interactionMeans(model_CumCJ5))
plot(model_CumCJ5.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/interactionMeans_model_CumCJ5_720.svg", width = 8, height = 6.5)
(model_CumCJ5.means <- interactionMeans(model_CumCJ5))
plot(model_CumCJ5.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ5_720.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ5)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/visreg_model_CumCJ5_720.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CumCJ5)
dev.off()





####################################################################
################### CUSTOM CONTRASTS ################
####################################################################



emm3_Model_cumlative_countjuvemerged_tadsadded_percapita=emmeans(model_CumCJ8,specs=~ Competition_level*Region)

write.csv(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/emm3_Model_cumlative_countjuvemerged_tadsadded_percapita_model_CumCJ8.csv")



#make into dataframe
emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf<-as.data.frame(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita)

#make new column
emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf<-cbind(Model = "Model_cumlative_countjuvemerged_tadsadded_percapita", emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf)


#create custom contrasts
Low_controlHG<-rep(c(1,0), times = c(1,7))
FrogMLHG<-rep(c(0,1,0), times = c(1,1,6))
FrogHGHG<-rep(c(0,1,0), times = c(2,1,5))
High_controlHG<-rep(c(0,1,0), times = c(3,1,4))
Low_controlML<-rep(c(0,1,0), times = c(4,1,3))
FrogMLML<-rep(c(0,1,0), times = c(5,1,2))
FrogHGML<-rep(c(0,1,0), times = c(6,1,1))
High_controlML<-rep(c(0,1), times = c(7,1))

#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_frogregion_mvt_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


#720
write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_frogregion_mvt_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_frogregion_mvt_19_01_22_model_CumCJ8_720.csv")




# adjust = "mvt" adds multiple tests adjustment, could also use "bonferroni" but its too conservative https://cran.r-project.org/web/packages/emmeans/vignettes/confidence-intervals.html



###for MS 01_12_20
(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_values_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))




write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_values_19_01_22_model_CumCJ8_720.csv")



(contrast_cumlative_countjuvemerged_tadsadded_percapita_BONFERRONI_values_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))



write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_BONFERRONI_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_BONFERRONI_values_19_01_22_model_CumCJ8_720.csv")


# 7 tests
### low vs high, low vs low, high vs high
(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_lowvlow_7tests_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#720
write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_lowvlow_7tests_19_01_22_model_CumCJ8_720.csv")



# 7 tests
### low vs high, low vs low, high vs high
(contrast_cumlative_countjuvemerged_tadsadded_percapita_bonf_lowvlow_7tests_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#720
write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_bonf_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_bonf_lowvlow_7tests_19_01_22_model_CumCJ8_720.csv")



###########################
########## PERCENT ################
###################################

#region HG, comp level low control - single out estimate for each level of region/competition to insect into contrast table later to calculate percent
HGLow_controlHG_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[1,4]
HGFrogMLHG_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[2,4]
HGFrogHGHG_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[3,4]
HGHigh_controlHG_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[4,4]
MLLow_controlML_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[5,4] 
MLFrogMLML_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[6,4]
MLFrogHGML_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[7,4]
MLHigh_controlML_cumlative_countjuvemerged_tadsadded_percapita<-emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[8,4]
HGFrog_overallHG_cumlative_countjuvemerged_tadsadded_percapita<-(emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[2,4]+emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[3,4])/2
MLFrog_overallML_cumlative_countjuvemerged_tadsadded_percapita<-(emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[6,4]+emm3_Model_cumlative_countjuvemerged_tadsadded_percapitadf[7,4])/2
ML_lowC_minus_highC_cumlative_countjuvemerged_tadsadded_percapita<-MLLow_controlML_cumlative_countjuvemerged_tadsadded_percapita-MLHigh_controlML_cumlative_countjuvemerged_tadsadded_percapita
HG_lowC_minus_highC_cumlative_countjuvemerged_tadsadded_percapita<-HGLow_controlHG_cumlative_countjuvemerged_tadsadded_percapita-HGHigh_controlHG_cumlative_countjuvemerged_tadsadded_percapita
ML_lowC_minus_inter_cumlative_countjuvemerged_tadsadded_percapita<-MLLow_controlML_cumlative_countjuvemerged_tadsadded_percapita-MLFrog_overallML_cumlative_countjuvemerged_tadsadded_percapita
HG_lowC_minus_inter_cumlative_countjuvemerged_tadsadded_percapita<-HGLow_controlHG_cumlative_countjuvemerged_tadsadded_percapita-HGFrog_overallHG_cumlative_countjuvemerged_tadsadded_percapita
ML_lowC_minus_highC_cumlative_countjuvemerged_tadsadded_percapita_MINUS_ML_lowC_minus_inter_cumlative_countjuvemerged_tadsadded_percapita<-ML_lowC_minus_highC_cumlative_countjuvemerged_tadsadded_percapita-ML_lowC_minus_inter_cumlative_countjuvemerged_tadsadded_percapita



(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_PERCENT_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_cumlative_countjuvemerged_tadsadded_percapita)*100,
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_cumlative_countjuvemerged_tadsadded_percapita))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_cumlative_countjuvemerged_tadsadded_percapita))*100,
  
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_cumlative_countjuvemerged_tadsadded_percapita)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_cumlative_countjuvemerged_tadsadded_percapita)*100
  
  
)))



write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_PERCENT_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_PERCENT_19_01_22_model_CumCJ8_720.csv")



### bonferroni

(contrast_cumlative_countjuvemerged_tadsadded_percapita_PERCENT_bonferroni_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_cumlative_countjuvemerged_tadsadded_percapita)*100,
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_cumlative_countjuvemerged_tadsadded_percapita))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_cumlative_countjuvemerged_tadsadded_percapita))*100,
  
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_cumlative_countjuvemerged_tadsadded_percapita)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_cumlative_countjuvemerged_tadsadded_percapita)*100
  
  
  
)))


write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_PERCENT_bonferroni_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_PERCENT_bonferroni_19_01_22_model_CumCJ8_720.csv")



#############
#### CONFIDENCE INTERVALS ####
##############


(contrast_cumlative_countjuvemerged_tadsadded_percapita_CI_19_01_22_mvt<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "mvt")%>%
   confint())




write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_CI_19_01_22_mvt,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_mvt_CI_19_01_22_model_CumCJ8_720.csv")




(contrast_cumlative_countjuvemerged_tadsadded_percapita_CI_19_01_22<-contrast(emm3_Model_cumlative_countjuvemerged_tadsadded_percapita,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "bonferroni")%>%
    confint())




write.csv(contrast_cumlative_countjuvemerged_tadsadded_percapita_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/contrast_cumlative_countjuvemerged_tadsadded_percapita_bonf_CI_19_01_22_model_CumCJ8_720.csv")






################## 
#####  PLOT #####
####################



################## 
#####  model_CumCJ5 #####
####################


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/boxplotplotCumulative_Count_juv_emerged_percapita_arcsine_model_CumCJ5_720_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine_19_01_22 <-Rawdata_experimentAugust2018_720_cumsum %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/boxplotplot_Cumulative_Count_juv_emerged_percapita_arcsine_model_CumCJ5_720_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine_19_01_22 <-Rawdata_experimentAugust2018_720_cumsum %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()

## three treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_arcsine_model_CumCJ5_720_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    ##scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_arcsine_model_CumCJ5_720_600res.svg", width = 120, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_arcsine_model_3compxregion_CumCJ5_720_600res.png", width = 240, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_arcsine_model_3compxregion_CumCJ5_720_600res.svg", width = 240, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()











## foiur treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4treatments_model_CumCJ5_720_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~.)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_arcsine_model_CumCJ5_720_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


## foiur treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ5_720_600res.png", width = 180, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ5_720_600res.svg", width = 180, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_arcsine<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=arcsin_Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ5) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="arcsine(Number toad metamorphosed per capita)")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






















################## 
#####  model_CumCJ3.1 #####
####################


## three treatments



## three treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ3.1_720_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    ##scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ3.1_720_600res.svg", width = 120, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_3compxregion_CumCJ3.1_720_600res.png", width = 240, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_3compxregion_CumCJ3.1_720_600res.svg", width = 240, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()











## foiur treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4treatments_model_CumCJ3.1_720_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ3.1_720_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


## foiur treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ3.1_720_600res.png", width = 180, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ3.1_720_600res.svg", width = 180, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()





################## 
#####  model_CumCJ3 #####
####################




## three treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_CumCJ3_720_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    ##scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_CumCJ3_720_600res.svg", width = 120, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_3compxregion_CumCJ3_720_600res.png", width = 240, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_3compxregion_CumCJ3_720_600res.svg", width = 240, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()











## foiur treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_4treatments_model_CumCJ3_720_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_CumCJ3_720_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


## foiur treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_4compxregion_model_CumCJ3_720_600res.png", width = 180, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_4compxregion_model_CumCJ3_720_600res.svg", width = 180, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ3) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    #scale_y_continuous(trans = 'log10')+
    #annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()













################## 
#####  model_CumCJ4 #####
####################




## three treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_CumCJ4_logscale_664_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_CumCJ4_logscale_664_600res.svg", width = 120, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_3compxregion_CumCJ4_logscale_664_600res.png", width = 240, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_3compxregion_CumCJ4_logscale_664_600res.svg", width = 240, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()











## foiur treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_4treatments_model_CumCJ4_logscale_664_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_model_CumCJ4_logscale_664_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


## foiur treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_4compxregion_model_CumCJ4_logscale_664_600res.png", width = 180, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_4compxregion_model_CumCJ4_logscale_664_600res.svg", width = 180, height = 150)
(boxplot_Cumulative_Count_juv_emerged_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()








################## 
#####  model_CumCJ4.1 #####
####################

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/boxplotplot_Cumulative_Count_juv_emerged_percapita_model_CumCJ4.1_logscale_664_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale_19_01_22 <-Rawdata_experimentAugust2018_720_cumsum_nozeros %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/boxplotplot_Cumulative_Count_juv_emerged_percapita_model_CumCJ4.1_logscale_664_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale_19_01_22 <-Rawdata_experimentAugust2018_720_cumsum_nozeros %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()




## three treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ4.1_logscale_664_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ4.1_logscale_664_600res.svg", width = 120, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_3compxregion_CumCJ4.1_logscale_664_600res.png", width = 240, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_3compxregion_CumCJ4.1_logscale_664_600res.svg", width = 240, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()











## foiur treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4treatments_model_CumCJ4.1_logscale_664_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ4.1_logscale_664_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


## foiur treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ4.1_logscale_664_600res.png", width = 180, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ4.1_logscale_664_600res.svg", width = 180, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ4.1) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()




################## 
#####  model_CumCJ6 #####
####################

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/boxplotplot_Cumulative_Count_juv_emerged_percapita_model_CumCJ6_logscale_664_600res.png", width = 200, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale_19_01_22 <-Rawdata_experimentAugust2018_720_cumsum_nozeros %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/boxplotplot_Cumulative_Count_juv_emerged_percapita_model_CumCJ6_logscale_664_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale_19_01_22 <-Rawdata_experimentAugust2018_720_cumsum_nozeros %>%
    mutate(Competition_level = fct_relevel(Treatment_three, 
                                           "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Competition_level, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_boxplot(lwd=0.6)+
    scale_fill_manual("grey")+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_wrap(~Region,labeller = labeller(Region = labels))+
    labs(x="Competition Treatment")+
    labs(y="Number juveniles emerged per capita")+
    scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                     labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank()))
dev.off()




## three treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ6_logscale_664_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ6_logscale_664_600res.svg", width = 120, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_3compxregion_CumCJ6_logscale_664_600res.png", width = 240, height = 240, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Number toads metamorphosed per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_3compxregion_CumCJ6_logscale_664_600res.svg", width = 240, height = 240)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Number toads metamorphosed per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()











## foiur treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4treatments_model_CumCJ6_logscale_664_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_model_CumCJ6_logscale_664_600res.svg", width = 200, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


## foiur treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ6_logscale_664_600res.png", width = 180, height = 150, units = 'mm', res = 600)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/CumulativeJuvCount/plot_Cumulative_Count_juv_emerged_percapita_4compxregion_model_CumCJ6_logscale_664_600res.svg", width = 180, height = 150)
(boxplot_Cumulative_Count_juv_emerged_percapita_logscale<- Rawdata_experimentAugust2018_720_cumsum_nozeros%>%
    ggplot(aes(x=Days, y=Cumulative_Count_juv_emerged_percapita)) +
    geom_point() +
    stat_summary(fun.data= model_CumCJ6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Competition_level~Region_factor)+
    labs(x="Days")+
    labs(y="Cumulative # juveniles emerged per capita")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()






###########################################
#### 7. COUNT PER DAY #############
#############################################################


#########################
############### SCALING ##########
######################

#starting weight
Xtemp <- Rawdata_experimentAugust2018_720$X25.5.18_experiment_start_tapole_av_individual_weight 
Xtemp

Xscaled <- (Xtemp - mean(Xtemp))/sd(Xtemp)
Rawdata_experimentAugust2018_720$scaled_X25.5.18_experiment_start_tapole_av_individual_weight  <- Xscaled

### tadpole top up
Xtemp2 <-Rawdata_experimentAugust2018_720$toadTadpoles_added_as_top.up_june7thand8th_percapita 

Xscaled2 <- (Xtemp2 - mean(Xtemp2))/sd(Xtemp2)
Rawdata_experimentAugust2018_720$scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita  <- Xscaled2

### mortality
Xtemp3 <-Rawdata_experimentAugust2018_720$Mortality_tadsadded_26_06_21_percapita 

Xscaled3 <- (Xtemp3 - mean(Xtemp3))/sd(Xtemp3)
Rawdata_experimentAugust2018_720$scaled_Mortality_tadsadded_26_06_21_percapita  <- Xscaled3



### scaled Density_tadsadded_minus_mortality_percapita
Xtemp4 <-Rawdata_experimentAugust2018_720$Density_tadsadded_minus_mortality_percapita 

Xscaled4 <- (Xtemp4 - mean(Xtemp4))/sd(Xtemp4)
Rawdata_experimentAugust2018_720$scaled_Density_tadsadded_minus_mortality_percapita  <- Xscaled4


### scaled Count_toads_left_b4weigh
Xtemp5 <-Rawdata_experimentAugust2018_720$Count_toads_left_b4weigh 

Xscaled5 <- (Xtemp5 - mean(Xtemp5))/sd(Xtemp5)
Rawdata_experimentAugust2018_720$scaled_Count_toads_left_b4weigh  <- Xscaled5



##  Mortality_06_05_20_percapita



Xtemp6 <-Rawdata_experimentAugust2018_720$Mortality_06_05_20_percapita 

Xscaled6 <- (Xtemp6 - mean(Xtemp6))/sd(Xtemp6)
Rawdata_experimentAugust2018_720$scaled_Mortality_06_05_20_percapita  <- Xscaled6



### Total_chla_conc_26.7.18_ug.l

Xtemp7 <-Rawdata_experimentAugust2018_720$Total_chla_conc_26.7.18_ug.l

Xscaled7 <- (Xtemp7 - mean(Xtemp7))/sd(Xtemp7)
Rawdata_experimentAugust2018_720$scaled_Total_chla_conc_26.7.18_ug.l  <- Xscaled7

######### Mean_averageTemp
Xtemp8 <-Rawdata_experimentAugust2018_720$Mean_averageTemp

Xscaled8 <- (Xtemp8 - mean(Xtemp8))/sd(Xtemp8)
Rawdata_experimentAugust2018_720$scaled_Mean_averageTemp  <- Xscaled8




#log - looks good
Rawdata_experimentAugust2018_720$log_Av_juv_biomass<-log(Rawdata_experimentAugust2018_720$Av_juv_biomass)


Rawdata_experimentAugust2018_720$log_Av_juv_biomass_mg<-log(Rawdata_experimentAugust2018_720$Av_juv_biomass_mg)




## natural log
Rawdata_experimentAugust2018_720$log_Count_juv_emerged<-(log(Rawdata_experimentAugust2018_720$Count_juv_emerged))

## log 10
Rawdata_experimentAugust2018_720$log10_Count_juv_emerged<-(log10(Rawdata_experimentAugust2018_720$Count_juv_emerged))




Rawdata_experimentAugust2018_720$log10_Count_juv_emerged_percapita<-log10(Rawdata_experimentAugust2018_720$Count_juv_emerged_percapita)



#######################
#### LMMR ###############
#############################



###########################################################
########### Jen suggestion, remove low treatments ########
##########################################################

Rawdata_experimentAugust2018_720_nolow<-Rawdata_experimentAugust2018_720
Rawdata_experimentAugust2018_720_nolow<-Rawdata_experimentAugust2018_720_nolow[!(Rawdata_experimentAugust2018_720_nolow$Competition_level=="Low_control"),]
dim(Rawdata_experimentAugust2018_720_nolow) #539  87



Rawdata_experimentAugust2018_720_nolow$Treatment_three<-as.factor(Rawdata_experimentAugust2018_720_nolow$Treatment_three)



Rawdata_experimentAugust2018_720_nolow_nozeros<-Rawdata_experimentAugust2018_720_nolow[!(Rawdata_experimentAugust2018_720_nolow$Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_nolow_nozeros) # 385  88




model_CJ_perday8<-lmer(log10_Count_juv_emerged_percapita~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         Mortality_06_05_20_percapita+
                         # Days*Competition_level+
                         Mean_averageTemp+ #fixed effects
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720_nolow_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday8)
AIC(model_CJ_perday8) #  258.2795
summary(model_CJ_perday8)


#385
capture.output(anova(model_CJ_perday8),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday8_385.txt")
write.csv(anova(model_CJ_perday8),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday8_385.csv")
capture.output(summary(model_CJ_perday8),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday8_385.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday8))
hist(resid(model_CJ_perday8))
plot(model_CJ_perday8)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday8_385.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday8)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday8_385.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday8))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday8_385.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday8))
dev.off()



## interaction plots
(model_CJ_perday8.means <- interactionMeans(model_CJ_perday8))
plot(model_CJ_perday8.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday8_385.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday8.means <- interactionMeans(model_CJ_perday8))
plot(model_CJ_perday8.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday8_385.svg", width = 8, height = 6.5)
(model_CJ_perday8.means <- interactionMeans(model_CJ_perday8))
plot(model_CJ_perday8.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday8)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday8_385.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday8)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday8_385.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday8)
dev.off()












png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/hist_Count_juv_emerged_percapita_perday_NOZEROS_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist((Rawdata_experimentAugust2018_720_nozeros$Count_juv_emerged_percapita))
dev.off()




## NB  Days*Competition_level*Region is not sig and increases AIC score = bad
### best model 26.01.22 ###
### per capita!!! 
### model_CJ_perday4 #####
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/hist_log10_Count_juv_emerged_percapita_perday_NOZEROS_model_CJ_perday4_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log10(Rawdata_experimentAugust2018_720_nozeros$Count_juv_emerged_percapita))
dev.off()

Rawdata_experimentAugust2018_720_nozeros<-Rawdata_experimentAugust2018_720[!(Rawdata_experimentAugust2018_720$Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_nozeros)


model_CJ_perday4<-lmer(log10_Count_juv_emerged_percapita~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         Mortality_06_05_20_percapita+
                         Days*Competition_level+
                         Mean_averageTemp+ #fixed effects
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday4)
AIC(model_CJ_perday4) #  299.3554
summary(model_CJ_perday4)


#510
capture.output(anova(model_CJ_perday4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday4_510.txt")
write.csv(anova(model_CJ_perday4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday4_510.csv")
capture.output(summary(model_CJ_perday4),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday4_510.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday4))
hist(resid(model_CJ_perday4))
plot(model_CJ_perday4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday4_510.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday4)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday4_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday4))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday4_510.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday4))
dev.off()



## interaction plots
(model_CJ_perday4.means <- interactionMeans(model_CJ_perday4))
plot(model_CJ_perday4.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday4_510.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday4.means <- interactionMeans(model_CJ_perday4))
plot(model_CJ_perday4.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday4_510.svg", width = 8, height = 6.5)
(model_CJ_perday4.means <- interactionMeans(model_CJ_perday4))
plot(model_CJ_perday4.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday4)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday4_510.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday4)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday4_510.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday4)
dev.off()





###  Av_juv_biomass_mg ## doesn't decrease AIC much, and not siginificant
##### model_CJ_perday7 #####
Rawdata_experimentAugust2018_720_nozeros<-Rawdata_experimentAugust2018_720[!(Rawdata_experimentAugust2018_720$Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_nozeros)


model_CJ_perday7<-lmer(log10_Count_juv_emerged_percapita~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         Mortality_06_05_20_percapita+
                         Days*Competition_level+
                         Mean_averageTemp+ #fixed effects
                         Av_juv_biomass_mg+
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday7)
AIC(model_CJ_perday7) #  259.0854
summary(model_CJ_perday7)


#510
capture.output(anova(model_CJ_perday7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday7_510.txt")
write.csv(anova(model_CJ_perday7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday7_510.csv")
capture.output(summary(model_CJ_perday7),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday7_510.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday7))
hist(resid(model_CJ_perday7))
plot(model_CJ_perday7)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday7_510.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday7)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday7_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday7))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday7_510.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday7))
dev.off()



## interaction plots
(model_CJ_perday7.means <- interactionMeans(model_CJ_perday7))
plot(model_CJ_perday7.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday7_510.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday7.means <- interactionMeans(model_CJ_perday7))
plot(model_CJ_perday7.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday7_510.svg", width = 8, height = 6.5)
(model_CJ_perday7.means <- interactionMeans(model_CJ_perday7))
plot(model_CJ_perday7.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday7)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday7_510.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday7)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday7_510.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday7)
dev.off()









## model_CJ_perday3 #####
### LOG10 ###


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/hist_log10_Count_juv_emerged_perday_NOZEROS_model_CJ_perday3_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log10(Rawdata_experimentAugust2018_720_nozeros$Count_juv_emerged))
dev.off()


Rawdata_experimentAugust2018_720_nozeros<-Rawdata_experimentAugust2018_720[!(Rawdata_experimentAugust2018_720$Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_nozeros)

model_CJ_perday3<-lmer(log10_Count_juv_emerged~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         Mortality_06_05_20_percapita+
                         Days*Competition_level+
                         Mean_averageTemp+ #fixed effects
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday3)
AIC(model_CJ_perday3) #  299.6255
summary(model_CJ_perday3)


#510
capture.output(anova(model_CJ_perday3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday3_510.txt")
write.csv(anova(model_CJ_perday3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday3_510.csv")
capture.output(summary(model_CJ_perday3),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday3_510.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday3))
hist(resid(model_CJ_perday3))
plot(model_CJ_perday3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday3_510.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday3)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday3_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday3))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday3_510.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday3))
dev.off()



## interaction plots
(model_CJ_perday3.means <- interactionMeans(model_CJ_perday3))
plot(model_CJ_perday3.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday3_510.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday3.means <- interactionMeans(model_CJ_perday3))
plot(model_CJ_perday3.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday3_510.svg", width = 8, height = 6.5)
(model_CJ_perday3.means <- interactionMeans(model_CJ_perday3))
plot(model_CJ_perday3.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday3)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday3_510.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday3)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday3_510.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday3)
dev.off()





#### model_CJ_perday1 #####
##### count hist
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/hist_Count_juv_emerged_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_720$Count_juv_emerged)
dev.off()


model_CJ_perday1<-lmer(Count_juv_emerged~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         scaled_Mortality_06_05_20_percapita+
                         Days*Competition_level+
                         scaled_Mean_averageTemp+ #fixed effects
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday1)
AIC(model_CJ_perday1) #   4021.323
summary(model_CJ_perday1)


#720
capture.output(anova(model_CJ_perday1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday1_720.txt")
write.csv(anova(model_CJ_perday1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday1_720.csv")
capture.output(summary(model_CJ_perday1),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday1_720.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday1))
hist(resid(model_CJ_perday1))
plot(model_CJ_perday1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday1)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday1))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday1))
dev.off()



## interaction plots
(model_CJ_perday1.means <- interactionMeans(model_CJ_perday1))
plot(model_CJ_perday1.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday1_720.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday1.means <- interactionMeans(model_CJ_perday1))
plot(model_CJ_perday1.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday1_720.svg", width = 8, height = 6.5)
(model_CJ_perday1.means <- interactionMeans(model_CJ_perday1))
plot(model_CJ_perday1.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday1)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday1_720.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday1)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday1_720.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday1)
dev.off()





#### model_CJ_perday5 #####
##### count hist
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/hist_Count_juv_emerged_percapita_model_CJ_perday5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(Rawdata_experimentAugust2018_720$Count_juv_emerged_percapita)
dev.off()


model_CJ_perday5<-lmer(Count_juv_emerged_percapita~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         scaled_Mortality_06_05_20_percapita+
                         Days*Competition_level+
                         scaled_Mean_averageTemp+ #fixed effects
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday5)
AIC(model_CJ_perday5) #   -2632.633
summary(model_CJ_perday5)


#720
capture.output(anova(model_CJ_perday5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday5_720.txt")
write.csv(anova(model_CJ_perday5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday5_720.csv")
capture.output(summary(model_CJ_perday5),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday5_720.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday5))
hist(resid(model_CJ_perday5))
plot(model_CJ_perday5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday5)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday5))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday5))
dev.off()



## interaction plots
(model_CJ_perday5.means <- interactionMeans(model_CJ_perday5))
plot(model_CJ_perday5.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday5_720.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday5.means <- interactionMeans(model_CJ_perday5))
plot(model_CJ_perday5.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday5_720.svg", width = 8, height = 6.5)
(model_CJ_perday5.means <- interactionMeans(model_CJ_perday5))
plot(model_CJ_perday5.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday5)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday5_720.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday5)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday5_720.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday5)
dev.off()




#### model_CJ_perday2 #####
#### log
#### remove zeros
Rawdata_experimentAugust2018_720_nozeros<-Rawdata_experimentAugust2018_720[!(Rawdata_experimentAugust2018_720$Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_nozeros)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/hist_log_Count_juv_emerged_perday_NOZEROS_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log(Rawdata_experimentAugust2018_720_nozeros$Count_juv_emerged))
dev.off()



dim(Rawdata_experimentAugust2018_720_nozeros) #720  85

model_CJ_perday2<-lmer(log_Count_juv_emerged~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         Mortality_06_05_20_percapita+
                         Days*Competition_level+
                         Mean_averageTemp+ #fixed effects
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday2)
AIC(model_CJ_perday2) #   1150.339
summary(model_CJ_perday2)


#510
capture.output(anova(model_CJ_perday2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday2_510.txt")
write.csv(anova(model_CJ_perday2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday2_510.csv")
capture.output(summary(model_CJ_perday2),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday2_510.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday2))
hist(resid(model_CJ_perday2))
plot(model_CJ_perday2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday2_510.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday2)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday2_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday2))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday2_510.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday2))
dev.off()



## interaction plots
(model_CJ_perday2.means <- interactionMeans(model_CJ_perday2))
plot(model_CJ_perday2.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday2_510.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday2.means <- interactionMeans(model_CJ_perday2))
plot(model_CJ_perday2.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday2_510.svg", width = 8, height = 6.5)
(model_CJ_perday2.means <- interactionMeans(model_CJ_perday2))
plot(model_CJ_perday2.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday2)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday2_510.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday2)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday2_510.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday2)
dev.off()


## 
#### model_CJ_perday6 #####
#### log10
#### remove zeros
Rawdata_experimentAugust2018_720_nozeros<-Rawdata_experimentAugust2018_720[!(Rawdata_experimentAugust2018_720$Count_juv_emerged==0),]
dim(Rawdata_experimentAugust2018_720_nozeros)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/hist_log10_Count_juv_emerged_perday_NOZEROS_model_CJ_perday6_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(log10(Rawdata_experimentAugust2018_720_nozeros$log10_Count_juv_emerged))
dev.off()



dim(Rawdata_experimentAugust2018_720_nozeros) #720  85

model_CJ_perday6<-lmer(log10_Count_juv_emerged~
                         Region*Competition_level+ 
                         scaled_toadTadpoles_added_as_top.up_june7thand8th_percapita+ 
                         #scaled_X25.5.18_experiment_start_tapole_av_individual_weight+
                         Mortality_06_05_20_percapita+
                         Days*Competition_level+
                         Mean_averageTemp+ #fixed effects
                         Block_factor+
                         #Total_chla_conc_26.7.18_ug.l+
                         #(1|Daysfactor)+
                         
                         #(1|Daysfactor/Tank_factor)+
                         (1+Days|Tank_factor)+
                         (1|Population_factor),
                       data=Rawdata_experimentAugust2018_720_nozeros,na.action=na.exclude,REML=FALSE,control=lmerControl(optimizer="optimx", optCtrl=list(method='nlminb'),check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))




anova(model_CJ_perday6)
AIC(model_CJ_perday6) #   1150.339
summary(model_CJ_perday6)


#510
capture.output(anova(model_CJ_perday6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday6_510.txt")
write.csv(anova(model_CJ_perday6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/anova_countjuv_perday_perday_pertank_model_CJ_perday6_510.csv")
capture.output(summary(model_CJ_perday6),file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/summary_countjuv_perday_perday_pertank_model_CJ_perday6_510.txt")


### test residuals - mostly ok
qqnorm(resid(model_CJ_perday6))
hist(resid(model_CJ_perday6))
plot(model_CJ_perday6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualsplot_model_CJ_perday6_510.png", width = 12, height = 6.5, units = 'in', res = 300)
plot(model_CJ_perday6)
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/Residualshist_model_CJ_perday6_510.png", width = 12, height = 6.5, units = 'in', res = 300)
hist(resid(model_CJ_perday6))
dev.off()

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/QQnorm_model_CJ_perday6_510.png", width = 12, height = 6.5, units = 'in', res = 300)
qqnorm(resid(model_CJ_perday6))
dev.off()



## interaction plots
(model_CJ_perday6.means <- interactionMeans(model_CJ_perday6))
plot(model_CJ_perday6.means)


png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday6_510.png", width = 12, height = 6.5, units = 'in', res = 300)
(model_CJ_perday6.means <- interactionMeans(model_CJ_perday6))
plot(model_CJ_perday6.means)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/interactionMeans_model_CJ_perday6_510.svg", width = 8, height = 6.5)
(model_CJ_perday6.means <- interactionMeans(model_CJ_perday6))
plot(model_CJ_perday6.means)
dev.off()

## visreg
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday6)

png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday6_510.png", width = 8, height = 6.5, units = 'in', res = 300)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday6)
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/visreg_model_CJ_perday6_510.svg", width = 8, height = 6.5)
par(mar = c(5, 5,2, 2))
par(mfrow=c(3,3))
visreg(model_CJ_perday6)
dev.off()



####################################################################
################### CUSTOM CONTRASTS ################
####################################################################



emm3_Model_countjuvemerged_perday=emmeans(model_CJ_perday4,specs=~ Competition_level*Region)

write.csv(emm3_Model_countjuvemerged_perday,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/emm3_Model_countjuvemerged_model_CJ_perday4_510.txt")



#make into dataframe
emm3_Model_countjuvemerged_perdaydf<-as.data.frame(emm3_Model_countjuvemerged_perday)

#make new column
emm3_Model_countjuvemerged_perdaydf<-cbind(Model = "Model_countjuvemerged_perday", emm3_Model_countjuvemerged_perdaydf)


#create custom contrasts
Low_controlHG<-rep(c(1,0), times = c(1,7))
FrogMLHG<-rep(c(0,1,0), times = c(1,1,6))
FrogHGHG<-rep(c(0,1,0), times = c(2,1,5))
High_controlHG<-rep(c(0,1,0), times = c(3,1,4))
Low_controlML<-rep(c(0,1,0), times = c(4,1,3))
FrogMLML<-rep(c(0,1,0), times = c(5,1,2))
FrogHGML<-rep(c(0,1,0), times = c(6,1,1))
High_controlML<-rep(c(0,1), times = c(7,1))

#create joined frog response variable
Frog_overallHG=(FrogMLHG+FrogHGHG)/2
Frog_overallML=(FrogMLML+FrogHGML)/2


### test frog region doesn't have effect for both toad regions
(contrast_countjuvemerged_perday_mvt_frogregion_mvt_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,adjust="mvt",method=list(
  "FrogMLHG - FrogHGHG" = FrogMLHG - FrogHGHG,
  "FrogMLML - FrogHGML" = FrogMLML-FrogHGML
  
)))


#510
write.csv(contrast_countjuvemerged_perday_mvt_frogregion_mvt_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_mvt_frogregion_mvt_19_01_22_model_CJ_perday4_510.csv")




# adjust = "mvt" adds multiple tests adjustment, could also use "bonferroni" but its too conservative https://cran.r-project.org/web/packages/emmeans/vignettes/confidence-intervals.html



###for MS 01_12_20
(contrast_countjuvemerged_perday_mvt_values_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))




write.csv(contrast_countjuvemerged_perday_mvt_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_mvt_values_19_01_22_model_CJ_perday4_510.csv")



(contrast_countjuvemerged_perday_BONFERRONI_values_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML,
  "Low_controlHG - Frog_overallHG " = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML" = Low_controlML - Frog_overallML
)))



write.csv(contrast_countjuvemerged_perday_BONFERRONI_values_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_BONFERRONI_values_19_01_22_model_CJ_perday4_510.csv")


# 7 tests
### low vs high, low vs low, high vs high
(contrast_countjuvemerged_perday_mvt_lowvlow_7tests_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,adjust="mvt",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#510
write.csv(contrast_countjuvemerged_perday_mvt_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_mvt_lowvlow_7tests_19_01_22_model_CJ_perday4_510.csv")



# 7 tests
### low vs high, low vs low, high vs high
(contrast_countjuvemerged_perday_bonf_lowvlow_7tests_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,adjust="bonferroni",method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  
  "Low_controlML - Low_controlHG" =Low_controlML - Low_controlHG,
  "High_controlML - High_controlHG" = High_controlML - High_controlHG,
  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML
)))

#510
write.csv(contrast_countjuvemerged_perday_bonf_lowvlow_7tests_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_bonf_lowvlow_7tests_19_01_22_model_CJ_perday4_510.csv")



###########################
########## PERCENT ################
###################################

#region HG, comp level low control - single out estimate for each level of region/competition to insect into contrast table later to calculate percent
HGLow_controlHG_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[1,4]
HGFrogMLHG_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[2,4]
HGFrogHGHG_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[3,4]
HGHigh_controlHG_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[4,4]
MLLow_controlML_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[5,4] 
MLFrogMLML_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[6,4]
MLFrogHGML_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[7,4]
MLHigh_controlML_countjuvemerged_perday<-emm3_Model_countjuvemerged_perdaydf[8,4]
HGFrog_overallHG_countjuvemerged_perday<-(emm3_Model_countjuvemerged_perdaydf[2,4]+emm3_Model_countjuvemerged_perdaydf[3,4])/2
MLFrog_overallML_countjuvemerged_perday<-(emm3_Model_countjuvemerged_perdaydf[6,4]+emm3_Model_countjuvemerged_perdaydf[7,4])/2
ML_lowC_minus_highC_countjuvemerged_perday<-MLLow_controlML_countjuvemerged_perday-MLHigh_controlML_countjuvemerged_perday
HG_lowC_minus_highC_countjuvemerged_perday<-HGLow_controlHG_countjuvemerged_perday-HGHigh_controlHG_countjuvemerged_perday
ML_lowC_minus_inter_countjuvemerged_perday<-MLLow_controlML_countjuvemerged_perday-MLFrog_overallML_countjuvemerged_perday
HG_lowC_minus_inter_countjuvemerged_perday<-HGLow_controlHG_countjuvemerged_perday-HGFrog_overallHG_countjuvemerged_perday
ML_lowC_minus_highC_countjuvemerged_perday_MINUS_ML_lowC_minus_inter_countjuvemerged_perday<-ML_lowC_minus_highC_countjuvemerged_perday-ML_lowC_minus_inter_countjuvemerged_perday



(contrast_countjuvemerged_perday_mvt_PERCENT_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,adjust="mvt",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_countjuvemerged_perday)*100,
  
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_countjuvemerged_perday))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_countjuvemerged_perday))*100,
  
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_countjuvemerged_perday)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_countjuvemerged_perday)*100
  
  
)))



write.csv(contrast_countjuvemerged_perday_mvt_PERCENT_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_mvt_PERCENT_19_01_22_model_CJ_perday4_510.csv")



### bonferroni

(contrast_countjuvemerged_perday_PERCENT_bonferroni_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,adjust="bonferroni",method=list(
  "Frog_overallHG - Frog_overallML/Frog_overallML" =((Frog_overallHG - Frog_overallML)/MLFrog_overallML_countjuvemerged_perday)*100,
  
  
  
  
  "Frog_overallHG - High_controlHG/Frog_overallHG" = ((Frog_overallHG - High_controlHG)/(HGFrog_overallHG_countjuvemerged_perday))*100,
  
  "Frog_overallML - High_controlML/Frog_overallML"=((Frog_overallML - High_controlML)/(MLFrog_overallML_countjuvemerged_perday))*100,
  
  "Low_controlHG - Frog_overallHG/Low_controlHG" = ((Low_controlHG - Frog_overallHG)/HGLow_controlHG_countjuvemerged_perday)*100,
  
  "Low_controlML - Frog_overallML/Low_controlML"=((Low_controlML - Frog_overallML)/MLLow_controlML_countjuvemerged_perday)*100
  
)))


write.csv(contrast_countjuvemerged_perday_PERCENT_bonferroni_19_01_22,"C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_PERCENT_bonferroni_19_01_22_model_CJ_perday4_510.csv")



#############
#### CONFIDENCE INTERVALS ####
##############

(contrast_countjuvemerged_perday_bonf_CI_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "bonferroni")%>%
   confint())




write.csv(contrast_countjuvemerged_perday_bonf_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_bonf_CI_19_01_22_model_CJ_perday4_510.csv")


(contrast_countjuvemerged_perday_mvt_CI_19_01_22<-contrast(emm3_Model_countjuvemerged_perday,method=list(
  "Low_controlHG - Frog_overallHG" = Low_controlHG - Frog_overallHG,
  "Low_controlML - Frog_overallML"=Low_controlML - Frog_overallML,  
  "Frog_overallHG - Frog_overallML" =Frog_overallHG - Frog_overallML,
  "Frog_overallHG - High_controlHG" = Frog_overallHG - High_controlHG,
  "Frog_overallML - High_controlML" = Frog_overallML - High_controlML),
  adjust = "mvt")%>%
    confint())




write.csv(contrast_countjuvemerged_perday_mvt_CI_19_01_22,file="C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/contrast_countjuvemerged_perday_mvt_CI_19_01_22_model_CJ_perday4_510.csv")





################## 
#####  PLOT #####
####################


## log scale
## three treatments
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_model_CJ_perday6_logscale_510_600res.png", width = 120, height = 150, units = 'mm', res = 600)
(boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CJ_perday6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Count juv emerged per day")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()

svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_model_CJ_perday6_logscale_510_600res.svg", width = 120, height = 150)
(boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CJ_perday6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~.)+
    labs(x="Days")+
    labs(y="Count juv emerged per day")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")



# log scale
## three treatments x region
png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_model_3compxregion_model_CJ_perday6_logscale_510_600res.png", width = 200, height = 180, units = 'mm', res = 600)
(boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CJ_perday6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Count juv emerged per day")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    #scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
    # labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()


svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_model_3compxregion_model_CJ_perday6_logscale_510_600res.svg", width = 200, height = 180)
(boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
    mutate(Treatment_three = fct_relevel(Treatment_three, 
                                         "Low_control", "Frog","High_control")) %>%
    ggplot(aes(x=Days, y=Count_juv_emerged)) +
    geom_point() +
    stat_summary(fun.data= model_CJ_perday6) + 
    geom_smooth(method='lm')+
    scale_fill_manual("grey")+
    #coord_cartesian(ylim = ylim1*1.12)+
    scale_y_continuous(trans = 'log10')+
    annotation_logticks(sides="l")+
    facet_grid(Treatment_three~ Region)+
    labs(x="Days")+
    labs(y="Count juv emerged per day")+
    # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
    #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
    scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                          labels=c("Haida Gwaii", "Mainland"))+
    theme_bw()+
    theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
dev.off()





# New facet label names for dose variable
dose.labs <- c("D0.5", "D1", "D2")
names(dose.labs) <- c("0.5", "1", "2")

# New facet label names for supp variable
supp.labs <- c("Orange Juice", "Vitamin C")
names(supp.labs) <- c("OJ", "VC")


labeller = labeller(Region = labels)

labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")
labeller = labeller(dose = dose.labs, supp = supp.labs
                    
                    
                    ### per capita log sclae
                    ## three treatments x region
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_percapita_perday_model_3compxregion_modelCJ_perday4_logscale_510_600res.png", width = 200, height = 180, units = 'mm', res = 600)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
                        mutate(Treatment_three = fct_relevel(Treatment_three, 
                                                             "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Days, y=Count_juv_emerged_percapita)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday4) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        facet_grid(Treatment_three~ Region)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per capita per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_percapita_perday_model_3compxregion_modelCJ_perday4_logscale_510_600res.svg", width = 200, height = 180)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
                        mutate(Treatment_three = fct_relevel(Treatment_three, 
                                                             "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Days, y=Count_juv_emerged_percapita)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday4) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        facet_grid(Treatment_three~ Region)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per capita per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    ### include zeros
                    ### per capita
                    ## three treatments x region
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_percapita_perday_model_3compxregion_modelCJ_perday5_720_600res.png", width = 200, height = 180, units = 'mm', res = 600)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720%>%
                        mutate(Treatment_three = fct_relevel(Treatment_three, 
                                                             "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Days, y=Count_juv_emerged_percapita)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday5) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        #scale_y_continuous(trans = 'log10')+
                        #annotation_logticks(sides="l")+
                        facet_grid(Treatment_three~ Region)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per capita per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_percapita_perday_model_3compxregion_modelCJ_perday5_720_600res.svg", width = 200, height = 180)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720%>%
                        mutate(Treatment_three = fct_relevel(Treatment_three, 
                                                             "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Days, y=Count_juv_emerged_percapita)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday5) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        #scale_y_continuous(trans = 'log10')+
                        #annotation_logticks(sides="l")+
                        facet_grid(Treatment_three~ Region)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per capita per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ### include zeros
                    ### model_CJ_perday1
                    ## three treatments x region
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_model_3compxregion_model_CJ_perday1_720_600res.png", width = 200, height = 180, units = 'mm', res = 600)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720%>%
                        mutate(Treatment_three = fct_relevel(Treatment_three, 
                                                             "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Days, y=Count_juv_emerged)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday1) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        #scale_y_continuous(trans = 'log10')+
                        #annotation_logticks(sides="l")+
                        facet_grid(Treatment_three~ Region)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_model_3compxregion_model_CJ_perday1_720_600res.svg", width = 200, height = 180)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720%>%
                        mutate(Treatment_three = fct_relevel(Treatment_three, 
                                                             "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Days, y=Count_juv_emerged)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday1) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        #scale_y_continuous(trans = 'log10')+
                        #annotation_logticks(sides="l")+
                        facet_grid(Treatment_three~ Region)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    
                    
                    
                    
                    ## foiur treatments
                    #png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_4treatments_model_CJ_perday2_logscale_510_600res.png", width = 120, height = 150, units = 'mm', res = 600)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
                        ggplot(aes(x=Days, y=Count_juv_emerged)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday2) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        facet_grid(Competition_level~.)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    #svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_model_CJ_perday2_logscale_510_600res.svg", width = 200, height = 150)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
                        mutate(Treatment_three = fct_relevel(Treatment_three, 
                                                             "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Days, y=Count_juv_emerged)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday2) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        facet_grid(Treatment_three~.)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    ## foiur treatments x region
                    #png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_4compxregion_model_CJ_perday2_logscale_510_600res.png", width = 180, height = 150, units = 'mm', res = 600)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
                        ggplot(aes(x=Days, y=Count_juv_emerged)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday2) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        facet_grid(Competition_level~Region_factor)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    #svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/Countperday/plot_Count_juv_emerged_perday_4compxregion_model_CJ_perday2_logscale_510_600res.svg", width = 180, height = 150)
                    (boxplot_Count_juv_emerged_perday_logscale<- Rawdata_experimentAugust2018_720_nozeros%>%
                        ggplot(aes(x=Days, y=Count_juv_emerged)) +
                        geom_point() +
                        stat_summary(fun.data= model_CJ_perday2) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        #coord_cartesian(ylim = ylim1*1.12)+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        facet_grid(Competition_level~Region_factor)+
                        labs(x="Days")+
                        labs(y="Count juv emerged per day")+
                        # scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                        #  labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    ##################
                    ### EXTRA PLOTS #########
                    #################
                    
                    
                    ### order treatments
                    subset_dataRGRdd_renamedsomecolumns_2_10_20$Treatment_nameC<- factor(subset_dataRGRdd_renamedsomecolumns_2_10_20$Treatment_nameC, levels = c("HGT","MLF_HGT","HGF_HGT","HGT_Highcontrol","MLT","MLF_MLT","HGF_MLT","MLT_Highcontrol"))
                    subset_dataRGRdd_renamedsomecolumns_2_10_20<- droplevels(subset_dataRGRdd_renamedsomecolumns_2_10_20)
                    
                    blocklabels <- c("1" = "Block 1","2" = "Block 2","3"= "Block 3")
                    
                    
                    ### tads added as top up X BLOCK
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_4COMPXREGION_BLOCKfacet_72.png", width = 300, height = 500, units = 'mm', res = 600)
                    (boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_BLOCKfacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Treatment_nameC, y=toadTadpoles_added_as_top.up_june7thand8th_percapita, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        facet_wrap(~Block_factor,labeller = labeller(Block_factor = blocklabels),ncol = 1)+
                        labs(x="Competition Treatment")+
                        labs(y="Toad tadpoles added at two weeks per capita")+
                        scale_x_discrete(breaks=c("HGT","MLF_HGT","HGF_HGT","HGT_Highcontrol","MLT","MLF_MLT","HGF_MLT","MLT_Highcontrol"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii", "Toad high\ncontrol","Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii", "Toad high\ncontrol"  ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(legend.position = "bottom",legend.key.size = unit(2, 'cm'),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    dev.off()
                    
                    
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_4COMPXREGION_BLOCKfacet_72.svg", width = 300, height = 500, units = 'mm')
                    (boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_BLOCKfacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Treatment_nameC, y=toadTadpoles_added_as_top.up_june7thand8th_percapita, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        facet_wrap(~Block_factor,labeller = labeller(Block_factor = blocklabels),ncol = 1)+
                        labs(x="Competition Treatment")+
                        labs(y="Toad tadpoles added at two weeks per capita")+
                        scale_x_discrete(breaks=c("HGT","MLF_HGT","HGF_HGT","HGT_Highcontrol","MLT","MLF_MLT","HGF_MLT","MLT_Highcontrol"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii", "Toad high\ncontrol","Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii", "Toad high\ncontrol"  ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(legend.position = "bottom",legend.key.size = unit(2, 'cm'),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    dev.off()
                    
                    
                    
                    
                    
                    
                    
                    labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")
                    
                    #### 4 comp
                    ### Total_chla_conc_8.6.18_ug.l
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_8.6.18_ug.l_4COMPXREGION_nofacet_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_8.6.18_ug.l_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_8.6.18_ug.l, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        ylim(0,100)+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_8.6.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    ### Total_chla_conc_8.6.18_ug.l
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_8.6.18_ug.l_4COMPXREGION_nofacet_72.svg", width = 200, height = 150, units = 'mm')
                    (boxplot_Total_chla_conc_8.6.18_ug.l_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_8.6.18_ug.l, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        ylim(0,100)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_8.6.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    #### 4 comp
                    ### Total_chla_conc_26.7.18_ug.l
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_26.7.18_ug.l_4COMPXREGION_nofacet_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_26.7.18_ug.l_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_26.7.18_ug.l, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        ylim(0,100)+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    ### Total_chla_conc_26.7.18_ug.l
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_26.7.18_ug.l_4COMPXREGION_nofacet_72.svg", width = 200, height = 150, units = 'mm')
                    (boxplot_Total_chla_conc_26.7.18_ug.l_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_26.7.18_ug.l, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        ylim(0,100)+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_27.7.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    
                    
                    
                    
                    ### ggarrange two algal plots ####
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/ggarrane_Total_chla_conc_6.6.20_AND_26.7.18_ug.l_4COMPXREGION_nofacet_72.png", width = 400, height = 150, units = 'mm', res = 600)
                    ggarrange(boxplot_Total_chla_conc_8.6.18_ug.l_nofacet_291120, boxplot_Total_chla_conc_26.7.18_ug.l_nofacet_291120 ,
                              labels = c("a)", "b)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 2,nrow = 1)
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/ggarrane_Total_chla_conc_6.6.20_AND_26.7.18_ug.l_4COMPXREGION_nofacet_72.svg", width = 200, height = 250, units = 'mm')
                    ggarrange(boxplot_Total_chla_conc_8.6.18_ug.l_nofacet_291120, boxplot_Total_chla_conc_26.7.18_ug.l_nofacet_291120 ,
                              labels = c("a)", "b)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 1,nrow = 2)
                    dev.off()
                    
                    
                    
                    ### with facet #### 
                    ##### 
                    # subset to just tanks, and two algal columns##
                    
                    subset_dataRGRdd_renamedsomecolumns_2_10_20_algal<-subset_dataRGRdd_renamedsomecolumns_2_10_20[c(5,100,101)]
                    
                    ### turn data to long and rename total algal conc column as June_8th and July_27th
                    
                    subset_dataRGRdd_renamedsomecolumns_2_10_20_algal$June_8th<-subset_dataRGRdd_renamedsomecolumns_2_10_20_algal$Total_chla_conc_8.6.18_ug.l
                    
                    subset_dataRGRdd_renamedsomecolumns_2_10_20_algal$July_27th<-subset_dataRGRdd_renamedsomecolumns_2_10_20_algal$Total_chla_conc_26.7.18_ug.l
                    
                    subset_dataRGRdd_renamedsomecolumns_2_10_20_algal<-subset_dataRGRdd_renamedsomecolumns_2_10_20_algal[c(1,4,5)]
                    
                    subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long <- gather(subset_dataRGRdd_renamedsomecolumns_2_10_20_algal, Date,Total_chla_conc_ug.l, 2:3, factor_key=TRUE)
                    subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long
                    
                    
                    ### join back with other dataset
                    subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long2<-left_join(subset_dataRGRdd_renamedsomecolumns_2_10_20,subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long)
                    head(subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long2)
                    
                    
                    
                    ### plot with algae conc as predictor, competition as x, facet as region and fill as date
                    
                    
                    ### plot
                    
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_2dates_4COMPXREGION_facet_72.png", width = 400, height = 200, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_ug.l_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long2 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_ug.l, fill=Date)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("lightblue","#166aa6"),name="Date (days since \nexperiment began)",breaks=c("June_8th", "July_27th"),
                                          labels=c("June 8th (day 15)", "July 27th (day 64)"))+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        ylim(0,100)+
                        labs(x="Competition Treatment")+
                        labs(y="Total water chlorophyll a (ug/l)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(legend.key.size = unit(1.5, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 18)))
                    dev.off()
                    
                    
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_2dates_4COMPXREGION_facet_72.png", width = 400, height = 200, units = 'mm')
                    (boxplot_Total_chla_conc_ug.l_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long2 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_ug.l, fill=Date)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("lightblue","#166aa6"),name="Date (days since \nexperiment began)",breaks=c("June_8th", "July_27th"),
                                          labels=c("June 8th (day 15)", "July 27th (day 64)"))+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        ylim(0,100)+
                        labs(x="Competition Treatment")+
                        labs(y="Total water chlorophyll a (ug/l)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(legend.key.size = unit(1.5, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 18)))
                    dev.off()
                    
                    
                    
                    #### try no facet
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_2dates_4COMPXREGION_NOfacet_72.png", width = 400, height = 200, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_ug.l_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long2 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_ug.l, colour=Region, fill=Date)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("lightblue","#166aa6"),name="Date (days since \nexperiment began)",breaks=c("June_8th", "July_27th"),
                                          labels=c("June 8th (day 15)", "July 27th (day 64)"))+
                        # facet_wrap(~Region,labeller = labeller(Region = labels))+
                        ylim(0,100)+
                        labs(x="Competition Treatment")+
                        labs(y="Total water chlorophyll a (ug/l)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        scale_colour_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                            labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(legend.key.size = unit(1.5, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 17)))
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_2dates_4COMPXREGION_NOfacet_72.svg", width = 400, height = 200, units = 'mm')
                    (boxplot_Total_chla_conc_ug.l_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20_algal_long2 %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_ug.l, colour=Region, fill=Date)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("lightblue","#166aa6"),name="Date (days since \nexperiment began)",breaks=c("June_8th", "July_27th"),
                                          labels=c("June 8th (day 15)", "July 27th (day 64)"))+
                        # facet_wrap(~Region,labeller = labeller(Region = labels))+
                        ylim(0,100)+
                        labs(x="Competition Treatment")+
                        labs(y="Total water chlorophyll a (ug/l)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        scale_colour_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                            labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(legend.key.size = unit(1.5, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 17)))
                    dev.off()
                    
                    
                    ##### beautiful
                    
                    ### tads added as top up
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_4COMPXREGION_nofacet_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_nofacet_291120 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Competition_level, y=toadTadpoles_added_as_top.up_june7thand8th_percapita, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toad tadpoles added at two weeks per capita")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_4COMPXREGION_nofacet_72.svg", width = 200, height = 150, units = 'mm')
                    (boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Competition_level, y=toadTadpoles_added_as_top.up_june7thand8th_percapita, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad population",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toad tadpoles added at two weeks per capita")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadtopups_comp4region_facet.svg", width = 400, height = 300, units = 'mm')
                    (boxplot_toadtopups_comp4region_facet<-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        #mutate(Competition_level = fct_relevel(Treatment_three, 
                        #                                          "Low_control", "Frog"#,"High_control")) %>%
                        ggplot(aes(x=Competition_level, y=toadTadpoles_added_as_top.up_june7thand8th_percapita, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toad top up at two weeks (per capita)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    dev.off()
                    
                    
                    
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadtopups_comp4region_facet.png", width = 400, height = 300, units = 'mm', res = 600)
                    (boxplot_toadtopups_comp4region_facet<-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        #mutate(Competition_level = fct_relevel(Treatment_three, 
                        #                                          "Low_control", "Frog"#,"High_control")) %>%
                        ggplot(aes(x=Competition_level, y=toadTadpoles_added_as_top.up_june7thand8th_percapita, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toad top up at two weeks (per capita)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    dev.off()
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    ###############################################
                    #################### plot chlrophyll a
                    ##############################
                    
                    
                    ###### Total_chla_conc_8.6.18_ug.l
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_8.6.18_ug.l_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_8.6.18_ug.l_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        mutate(Competition_level = fct_relevel(Treatment_three, 
                                                               "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_8.6.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_8.6.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                         labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_8.6.18_ug.l_72.svg", width = 200, height = 150)
                    (boxplot_Total_chla_conc_8.6.18_ug.l_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        mutate(Competition_level = fct_relevel(Treatment_three, 
                                                               "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_8.6.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_8.6.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                         labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    ### Total_chla_conc_26.7.18_ug.l
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_26.7.18_ug.l_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_26.7.18_ug.l_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        mutate(Competition_level = fct_relevel(Treatment_three, 
                                                               "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_26.7.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                         labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_26.7.18_ug.l_72.svg", width = 200, height = 150)
                    (boxplot_Total_chla_conc_26.7.18_ug.l_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        mutate(Competition_level = fct_relevel(Treatment_three, 
                                                               "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Competition_level, y=Total_chla_conc_26.7.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                         labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ### Total_chla_conc_26.7.18_ug.l per block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_26.7.18_ug.l_block_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_26.7.18_ug.l_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Total_chla_conc_26.7.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Total_chla_conc_26.7.18_ug.l_block_72.svg", width = 200, height = 150)
                    (boxplot_Total_chla_conc_26.7.18_ug.l_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Total_chla_conc_26.7.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ### Total_chla_conc_8.6.18_ug.l v temp
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Total_chla_conc_8.6.18_ug.l_temp_model_CJ1.4_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (plot_Total_chla_conc_8.6.18_ug.l_temp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Mean_averageTemp, y=Total_chla_conc_8.6.18_ug.l,group=Region)) +
                        geom_point(lwd=0.6)+
                        stat_summary(fun.data= model_CJ1.4) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Mean average temp")+
                        labs(y="Total_chla_conc_8.6.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ### Total_chla_conc_26.7.18_ug.l v temp
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Total_chla_conc_26.7.18_ug.l_temp_model_CJ1.4_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (plot_Total_chla_conc_26.7.18_ug.l_temp_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Mean_averageTemp, y=Total_chla_conc_26.7.18_ug.l,group=Region)) +
                        geom_point(lwd=0.6)+
                        stat_summary(fun.data= model_CJ1.4) + 
                        geom_smooth(method='lm')+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Mean average temp")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    ## temp vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_temp_block_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_temp_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Mean_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mean ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_temp_block_72.svg", width = 200, height = 150)
                    (boxplot_temp_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Mean_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mean ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ## TADPOLE TOP UPS vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_TADPOLETOPUPS_block_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_TADPOLETOPUPS_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Tadpoles_added_as_top.up_june7thand8th)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Tadpole top ups at two weeks")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_TADPOLETOPUPS_block_72.svg", width = 200, height = 150)
                    (boxplot_TADPOLETOPUPS_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Tadpoles_added_as_top.up_june7thand8th)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Tadpole top ups at two weeks")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    ## high temp vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_MAXtemp_block_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_maxtemp_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Max_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Max ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_MAXtemp_block_72.svg", width = 200, height = 150)
                    (boxplot_maxtemp_block_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Max_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Max ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    
                    ### metamorphosed by end
                    ### subset_dataRGRdd_renamedsomecolumns_2_10_20$Percent_metemorphosedbyend
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Percent_metemorphosedbyend_comp_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_8.6.18_ug.l_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        mutate(Competition_level = fct_relevel(Treatment_three, 
                                                               "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Competition_level, y=Percent_metemorphosedbyend)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toads metemorphosed by end of experiment (%)")+
                        scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                         labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Percent_metemorphosedbyend_comp_72.svg", width = 200, height = 150)
                    (boxplot_Total_chla_conc_8.6.18_ug.l_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        mutate(Competition_level = fct_relevel(Treatment_three, 
                                                               "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Competition_level, y=Percent_metemorphosedbyend)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toads metemorphosed by end of experiment (%)")+
                        scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                         labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    ### including tads added
                    #subset_dataRGRdd_renamedsomecolumns_2_10_20$Percent_metemorphosedbyend_tadsadded
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_Percent_metemorphosedbyend_TADSADDED_comp_72.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Total_chla_conc_8.6.18_ug.l_19_01_22 <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        mutate(Competition_level = fct_relevel(Treatment_three, 
                                                               "Low_control", "Frog","High_control")) %>%
                        ggplot(aes(x=Competition_level, y=Percent_metemorphosedbyend_tadsadded)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toads metemorphosed by end of experiment (%)")+
                        scale_x_discrete(breaks=c("Low_control",  "Frog","High_control"),
                                         labels=c("Low intraspecific\n80 toads","Interspecific\n16 frogs\n80 toads", "High intraspecific\n160 toads" ))+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    
                    #############
                    ######### BLOCK EFFECT #########
                    ##################################
                    
                    
                    ############### RESPONSE VARIABLES
                    
                    ############# block no region
                    #GR_final_days_mgDay
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_GR_final_days_mgDay_block_718_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_GR_final_days_mgDay_block_19_01_22_noregion <-Rawdata_experimentAugust2018 %>%
                        ggplot(aes(x=Block_factor, y=GR_final_days_mgDay)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="GR_final_days_mgDay")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_GR_final_days_mgDay_block_718_noregion.svg", width = 200, height = 150)
                    (boxplot_GR_final_days_mgDay_block_19_01_22_noregion <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        ggplot(aes(x=Block_factor, y=GR_final_days_mgDay)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="GR_final_days_mgDay")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    # avjuvweightdevidedbydaysalive
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_avjuvweightdevidedbydaysalive_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_avjuvweightdevidedbydaysalive_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=avjuvweightdevidedbydaysalive)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="avjuvweightdevidedbydaysalive")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_avjuvweightdevidedbydaysalive_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_avjuvweightdevidedbydaysalive_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=avjuvweightdevidedbydaysalive)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="avjuvweightdevidedbydaysalive")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ### weight at metamorph
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Av_juv_biomass_mg_block_718_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Av_juv_biomass_mgy_block_19_01_22_noregion <-Rawdata_experimentAugust2018 %>%
                        ggplot(aes(x=Block_factor, y=Av_juv_biomass_mg)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Av_juv_biomass_mg")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_GR_final_days_mgDay_block_718_noregion.svg", width = 200, height = 150)
                    (boxplot_GR_final_days_mgDay_block_19_01_22_noregion <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        ggplot(aes(x=Block_factor, y=GR_final_days_mgDay)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="GR_final_days_mgDay")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    # Manual_running_total_average_weight_adults
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Manual_running_total_average_weight_adults_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Manual_running_total_average_weight_adults_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Manual_running_total_average_weight_adults)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Manual_running_total_average_weight_adults (g)")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Manual_running_total_average_weight_adults_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_Manual_running_total_average_weight_adults_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Manual_running_total_average_weight_adults)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Manual_running_total_average_weight_adults (g)")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    
                    
                    # log_Cumulative_Count_juv_emerged_percapita
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_logscale_Cumulative_Count_juv_emerged_percapita_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_logscale_Cumulative_Count_juv_emerged_percapita_block_19_01_22_noregion <-Rawdata_experimentAugust2018_720_cumsum_nozeros %>%
                        ggplot(aes(x=Block_factor, y=log_Cumulative_Count_juv_emerged_percapita)) +
                        geom_boxplot(wd=0.6)+
                        scale_fill_manual("grey")+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Number toads metamorphosed per capita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_logscale_Cumulative_Count_juv_emerged_percapita_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_logscale_Cumulative_Count_juv_emerged_percapita_block_19_01_22_noregion <-Rawdata_experimentAugust2018_720_cumsum_nozeros %>%
                        ggplot(aes(x=Block_factor, y=log_Cumulative_Count_juv_emerged_percapita)) +
                        geom_boxplot(wd=0.6)+
                        scale_fill_manual("grey")+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Number toads metamorphosed per capita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    
                    
                    
                    
                    #MedianDays
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_MedianDays_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_MedianDays_percapita_block_19_01_22_noregion <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        ggplot(aes(x=Block_factor, y=MedianDays)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="MedianDays")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_MedianDays_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_MedianDays_block_19_01_22_noregion <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        ggplot(aes(x=Block_factor, y=MedianDays)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="MedianDays")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    #log_MedianDays
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_logscale_MedianDays_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_MedianDays_percapita_block_19_01_22_noregion <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        ggplot(aes(x=Block_factor, y=MedianDays)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="MedianDays")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_logscale_MedianDays_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_MedianDays_block_19_01_22_noregion <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        ggplot(aes(x=Block_factor, y=MedianDays)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="MedianDays")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ## Mortality_06_05_20_percapita
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Mortality_06_05_20_percapita_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Mortality_06_05_20_percapita_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Mortality_06_05_20_percapita)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mortality_06_05_20_percapita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Mortality_06_05_20_percapita_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_Mortality_06_05_20_percapita_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Mortality_06_05_20_percapita)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mortality_06_05_20_percapita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    ## Mortality_06_05_20_percapita
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_arcsine_Mortality_06_05_20_percapita_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Mortality_06_05_20_percapita_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=arcsin_Mortality_06_05_20_percapita)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mortality_06_05_20_percapita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_arcsine_Mortality_06_05_20_percapita_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_Mortality_06_05_20_percapita_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=arcsin_Mortality_06_05_20_percapita)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mortality_06_05_20_percapita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    #Running_total_of_adults_emerged_percapita_TADSADDED
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Running_total_of_adults_emerged_percapita_TADSADDED_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_Running_total_of_adults_emerged_percapita_TADSADDED_percapita_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Running_total_of_adults_emerged_percapita_TADSADDED)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Running_total_of_adults_emerged_percapita_TADSADDED")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Running_total_of_adults_emerged_percapita_TADSADDED_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_Running_total_of_adults_emerged_percapita_TADSADDED_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Running_total_of_adults_emerged_percapita_TADSADDED)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Running_total_of_adults_emerged_percapita_TADSADDED")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    
                    ########### other effects
                    
                    
                    ## temp vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_temp_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_temp_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Mean_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mean ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_temp_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_temp_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Mean_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Mean ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ## TADPOLE TOP UPS vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_TADPOLETOPUPS_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_TADPOLETOPUPS_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Tadpoles_added_as_top.up_june7thand8th)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Tadpole top ups at two weeks")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_TADPOLETOPUPS_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_TADPOLETOPUPS_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Tadpoles_added_as_top.up_june7thand8th)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Tadpole top ups at two weeks")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    ## TADPOLE TOP UPS vs block _percapita_
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_TADPOLETOPUPS_percapita_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_TADPOLETOPUPS_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Tadpoles_added_as_top.up_june7thand8th_percapita)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Tadpole top ups at two weeks per capita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_TADPOLETOPUPS_percapita_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_TADPOLETOPUPS_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Tadpoles_added_as_top.up_june7thand8th_percapita)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Tadpole top ups at two weeks per capita")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ## high temp vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_MAXtemp_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_maxtemp_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Max_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Max ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_MAXtemp_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_maxtemp_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Max_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Max ave temp")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    ## Total_chla_conc_8.6.18_ug.l vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Total_chla_conc_8.6.18_ug.l_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_maxtemp_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Total_chla_conc_8.6.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Total_chla_conc_8.6.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Total_chla_conc_8.6.18_ug.l_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_Total_chla_conc_8.6.18_ug.l_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Max_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Total_chla_conc_8.6.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    
                    ## Total_chla_conc_26.7.18_ug.l vs block
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Total_chla_conc_26.7.18_ug.l_block_72_noregion.png", width = 200, height = 150, units = 'mm', res = 600)
                    (boxplot_maxtemp_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Total_chla_conc_26.7.18_ug.l)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    svg("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/plot_Total_chla_conc_26.7.18_ug.l_block_72_noregion.svg", width = 200, height = 150)
                    (boxplot_Total_chla_conc_26.7.18_ug.l_block_19_01_22_noregion <-subset_dataRGRdd_renamedsomecolumns_2_10_20 %>%
                        ggplot(aes(x=Block_factor, y=Max_averageTemp)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual("grey")+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Block")+
                        labs(y="Total_chla_conc_26.7.18_ug.l")+
                        scale_colour_discrete(name="Toad Region",breaks=c("HG", "ML"),
                                              labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 15)))
                    dev.off()
                    
                    
                    ############
                    ####### ggarrange ####
                    ########################
                    
                    library(ggpubr)
                    
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/test3plots_wide.png", width = 600, height = 150, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale, boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_19_01_22 , boxplot_timing_toad_MedianDays_comp4region_19_01_22, 
                              labels = c("a)", "b)", "c)"),
                              ncol = 3, nrow = 1)
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/test3plots_wide.svg", width = 600, height = 150, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale, boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_19_01_22, boxplot_timing_toad_MedianDays_comp4region_19_01_22, 
                              labels = c("a)", "b)", "c)"),
                              ncol = 3, nrow = 1)
                    dev.off()
                    
                    
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/test3plots_2x2.png", width = 400, height = 300, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale + rremove("x.text"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_19_01_22 , boxplot_timing_toad_MedianDays_comp4region_19_01_22, 
                              labels = c("a)", "b)", "c)"),
                              ncol = 2, nrow = 2)
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/test3plots_2x2.svg", width = 400, height = 300, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale + rremove("x.text"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_19_01_22 , boxplot_timing_toad_MedianDays_comp4region_19_01_22, 
                              labels = c("a)", "b)", "c)"),
                              ncol = 2, nrow = 2)
                    dev.off()
                    
                    
                    
                    ############
                    ####### ggarrange ####
                    ########################
                    
                    library(ggpubr)
                    
                    
                    ############## colours
                    (boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2<- Rawdata_experimentAugust2018%>%
                        ggplot(aes(x=Competition_level, y=GR_final_days_mgDay,fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #coord_cartesian(ylim = ylim1*1.1)+
                        labs(x="Competition Treatment")+
                        labs(y="Toad growth rate (mg/day)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    (boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 <- Rawdata_experimentAugust2018%>%
                        ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg,fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #coord_cartesian(ylim = ylim1*1.1)+
                        labs(x="Competition Treatment")+
                        labs(y="Average toad weight\nat metamorphosis (mg)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0.5), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    (boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2 <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        #mutate(Competition_level = fct_relevel(Treatment_three, 
                        #                                          "Low_control", "Frog"#,"High_control")) %>%
                        ggplot(aes(x=Competition_level, y=MedianDays, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Median time to toad\nmetamorphosis (days)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    
                    
                    (boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2_LEGEND <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        #mutate(Competition_level = fct_relevel(Treatment_three, 
                        #                                          "Low_control", "Frog"#,"High_control")) %>%
                        ggplot(aes(x=Competition_level, y=MedianDays, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        #facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Median time to toad\nmetamorphosis (days)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(legend.key.size = unit(2, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    #png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2.png", width = 400, height = 300, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2 + rremove("x.text"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 , boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2,
                              labels = c("a)", "b)", "c)"),
                              ncol = 2, nrow = 2)
                    dev.off()
                    
                    #ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2.svg", width = 400, height = 300, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2 + rremove("x.text"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 , boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2,
                              labels = c("a)", "b)", "c)"),
                              ncol = 2, nrow = 2)
                    dev.off()
                    
                    
                    
                    #+ rremove("x.text")+ rremove("x.title")
                    
                    
                    #### GET LEGEND ON SECOND PLOT
                    g_legend<-function(a.gplot){
                      tmp <- ggplot_gtable(ggplot_build(a.gplot))
                      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
                      legend <- tmp$grobs[[leg]]
                      return(legend)}
                    
                    mylegend<-g_legend(boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2_LEGEND)
                    
                    
                    ##3 MOVE LABELS
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_onelegend_source.png", width = 400, height = 350, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2  + theme(legend.position="none"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2 + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 2,  mylegend,nrow = 2) 
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_onelegend_source.svg", width = 400, height = 350, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2  + theme(legend.position="none"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2 + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 2,  mylegend,nrow = 2) 
                    dev.off()
                    
                    
                    
                    
                    
                    #png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_onelegend_pop.png", width = 400, height = 350, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2  + theme(legend.position="none"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2 + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =0.5,
                              ncol = 2,  mylegend,nrow = 2) 
                    dev.off()
                    
                    
                    
                    #ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_onelegend_pop.svg", width = 400, height = 350, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2  + theme(legend.position="none"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2 + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"),
                              ncol = 2,  mylegend,nrow = 2)
                    dev.off()
                    
                    
                    ############
                    ####### FACET TOADS ggarrange ####
                    ########################
                    
                    library(ggpubr)
                    
                    
                    ############## colours
                    labels <- c(ML = "Mainland Toads", HG = "Haida Gwaii Toads")
                    
                    
                    (boxplot_GR_final_days_mgDay_4comp_logscale_facet<- Rawdata_experimentAugust2018%>%
                        ggplot(aes(x=Competition_level, y=GR_final_days_mgDay,fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #coord_cartesian(ylim = ylim1*1.1)+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Toad growth rate\n(mg/day)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(axis.title.y = element_text(margin=margin(r=10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    (boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_facet <- Rawdata_experimentAugust2018%>%
                        ggplot(aes(x=Competition_level, y=Av_juv_biomass_mg,fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        scale_y_continuous(trans = 'log10')+
                        annotation_logticks(sides="l")+
                        #coord_cartesian(ylim = ylim1*1.1)+
                        labs(x="Competition Treatment")+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        
                        labs(y="Average toad weight\nat metamorphosis (mg)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    (boxplot_timing_toad_MedianDays_comp4region_facet<-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        #mutate(Competition_level = fct_relevel(Treatment_three, 
                        #                                          "Low_control", "Frog"#,"High_control")) %>%
                        ggplot(aes(x=Competition_level, y=MedianDays, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Median time to toad\nmetamorphosis (days)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(plot.margin = unit(c(0.5,1,0.5,0), "cm"),axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    
                    
                    (boxplot_timing_toad_MedianDays_comp4region_facet_LEGEND <-Rawdata_experimentAugust2018_indivrows2_median2_large %>%
                        #mutate(Competition_level = fct_relevel(Treatment_three, 
                        #                                          "Low_control", "Frog"#,"High_control")) %>%
                        ggplot(aes(x=Competition_level, y=MedianDays, fill=Region)) +
                        geom_boxplot(lwd=0.6)+
                        scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad source",breaks=c("HG", "ML"),
                                          labels=c("Haida Gwaii", "Mainland"))+
                        facet_wrap(~Region,labeller = labeller(Region = labels))+
                        labs(x="Competition Treatment")+
                        labs(y="Median time to toad\nmetamorphosis (days)")+
                        scale_x_discrete(breaks=c("Low_control",  "FrogML","FrogHG","High_control"),
                                         labels=c("Toad low\ncontrol","Frogs\nMainland","Frogs\nHaida Gwaii" ,"Toad high\ncontrol" ))+
                        #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                        #     labels=c("Haida Gwaii", "Mainland"))+
                        theme_bw()+
                        theme(axis.title.x = element_text(margin = margin(t = 10)))+
                        theme(legend.key.size = unit(2, 'cm'),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                    #png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2.png", width = 400, height = 300, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_facet + rremove("x.text"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_facet , boxplot_timing_toad_MedianDays_comp4region_facet,
                              labels = c("a)", "b)", "c)"),
                              ncol = 2, nrow = 2)
                    dev.off()
                    
                    #ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2.svg", width = 400, height = 300, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_nofacet_2 + rremove("x.text"), boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_nofacet_2_19_01_22 , boxplot_timing_toad_MedianDays_comp4region_19_01_22_nofacet_2,
                              labels = c("a)", "b)", "c)"),
                              ncol = 2, nrow = 2)
                    dev.off()
                    
                    
                    
                    #+ rremove("x.text")+ rremove("x.title")
                    
                    
                    #### GET LEGEND ON SECOND PLOT
                    g_legend<-function(a.gplot){
                      tmp <- ggplot_gtable(ggplot_build(a.gplot))
                      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
                      legend <- tmp$grobs[[leg]]
                      return(legend)}
                    
                    mylegend<-g_legend(boxplot_timing_toad_MedianDays_comp4region_facet_LEGEND)
                    
                    
                    ##3 MOVE LABELS
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_facet_region.png", width = 300, height = 550, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_facet  + theme(legend.position="none") , boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_facet + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_facet + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 1,  nrow = 3) 
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_facet_region.svg", width = 300, height = 550, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_facet  + theme(legend.position="none") , boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_facet + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_facet + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 1,  nrow = 3) 
                    dev.off()
                    
                    
                    ### wide
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_facet_region_wide.png", width = 600, height = 500, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_facet  + theme(legend.position="none") , boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_facet + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_facet + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 2,  nrow = 2) 
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR3_AW24_MD6_2x2_facet_region_wide.svg", width = 600, height = 500, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_4comp_logscale_facet  + theme(legend.position="none") , boxplot_Competition_level_4_JUVWEIGHT_mg_logscale_facet + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp4region_facet + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 2,  nrow = 2) 
                    dev.off()
                    
                    
                    
                    ######## tad top ups and per block
                    
                    boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_BLOCKfacet_291120
                    
                    boxplot_toadtopups_comp4region_facet
                    
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadtopups_comp4region_facet_toadTadpoles_added_as_top.up_june7thand8th_percapita_BLOCKfacet_291120.png", width = 400, height = 500, units = 'mm', res = 600)
                    ggarrange(boxplot_toadtopups_comp4region_facet + theme(legend.position="none"),boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_BLOCKfacet_291120  + theme(legend.position="none"),  
                              labels = c("a)", "b)"), font.label = list(size = 17),hjust =-0.25,heights=c(1,2),
                              ncol = 1,  nrow = 2) 
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/boxplot_toadtopups_comp4region_facet_toadTadpoles_added_as_top.up_june7thand8th_percapita_BLOCKfacet_291120.svg", width = 400, height = 500, units = 'mm')
                    ggarrange(boxplot_toadtopups_comp4region_facet + theme(legend.position="none"),boxplot_toadTadpoles_added_as_top.up_june7thand8th_percapita_BLOCKfacet_291120  + theme(legend.position="none"),  
                              labels = c("a)", "b)"), font.label = list(size = 17),hjust =-0.25,heights=c(1,2),
                              ncol = 1,  nrow = 2) 
                    dev.off()
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    ####### _NOLOW
                    ### LEGEND
 (boxplot_timing_toad_MedianDays_comp3region_nolow_19_01_22_nofacet_LEGEND <-Rawdata_experimentAugust2018_indivrows2_median2_large_nolow %>%
                         #mutate(Competition_level = fct_relevel(Treatment_three, 
                         #                                          "Low_control", "Frog"#,"High_control")) %>%
                         ggplot(aes(x=Competition_level, y=MedianDays, fill=Region)) +
                         geom_boxplot(lwd=0.6)+
                         scale_fill_manual(values=c("#a2ccb6ff","#979080ff"),name="Toad Co-occurrence History\nwith the NRLF",breaks=c("HG", "ML"),
                                           labels=c("Short (Haida Gwaii)", "Long (Mainland)"))+
                         #facet_wrap(~Region,labeller = labeller(Region = labels))+
                         labs(x="Competition Treatment")+
                         labs(y="Median time to toad metamorphosis (days)")+
 scale_x_discrete(breaks=c("Toad_control","NRLF_ML","NRLF_HG"),
                         labels=c("High density\nToad control","NRLFs\nMainland","NRLFs\nHaida Gwaii"))+
                         #scale_fill_discrete(name="Toad Region",breaks=c("HG", "ML"),
                         #     labels=c("Haida Gwaii", "Mainland"))+
                         theme_bw()+
         theme(legend.key.size = unit(4, 'cm'),axis.title.x = element_text(margin = margin(t = 10)))+
   theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),text = element_text(size = 20)))
                    
                    
                   
                    
                    
                    #### GET LEGEND ON SECOND PLOT
                    g_legend<-function(a.gplot){
                      tmp <- ggplot_gtable(ggplot_build(a.gplot))
                      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
                      legend <- tmp$grobs[[leg]]
                      return(legend)}
                    
                    mylegend_NOLOW<-g_legend(boxplot_timing_toad_MedianDays_comp3region_nolow_19_01_22_nofacet_LEGEND)
                    
                    
                    ##3 MOVE LABELS
                    png("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR_AW_MT_nolow_n54_onelegend_cooccurrencehistory.png", width = 400, height = 350, units = 'mm', res = 600)
                    ggarrange(boxplot_GR_final_days_mgDay_3comp_nolow_logscale_nofacet  + theme(legend.position="none"), boxplot_Av_juv_biomass_mg_3comp_nolow_logscale_nofacet + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp3region_nolow_19_01_22_nofacet + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 2,  mylegend_NOLOW,nrow = 2) 
                    dev.off()
                    
                    ggsave("C:/Users/Roseanna/Documents/Haida_Gwaii_RAAU_ANBO/Experiment_2018/Results_19_01_22/GR_AW_MT_nolow_n54_onelegend_cooccurrencehistory.svg", width = 400, height = 350, units = 'mm')
                    ggarrange(boxplot_GR_final_days_mgDay_3comp_nolow_logscale_nofacet  + theme(legend.position="none"), boxplot_Av_juv_biomass_mg_3comp_nolow_logscale_nofacet + theme(legend.position="none"), boxplot_timing_toad_MedianDays_comp3region_nolow_19_01_22_nofacet + theme(legend.position="none"),
                              labels = c("a)", "b)", "c)"), font.label = list(size = 17),hjust =-0.25,
                              ncol = 2,  mylegend_NOLOW,nrow = 2) 
                    dev.off()
                    
                    
                    
                    